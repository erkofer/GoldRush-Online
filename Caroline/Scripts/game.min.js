var Utils;
<<<<<<< HEAD
(function(b){b.addEvent=function(b,n,h){null!=b&&"undefined"!=typeof b&&(b.addEventListener?b.addEventListener(n,h,!1):b.attachEvent?b.attachEvent("on"+n,h):b["on"+n]=h)};b.cssSwap=function(b,n,h){b.classList.contains(n)&&b.classList.remove(n);b.classList.add(h)};b.cssifyName=function(b){return b.split(" ").join("_")};b.ifNotDefault=function(b,n){-100!=b&&n()};b.createButton=function(b,n){var h,q;h=document.createElement("div");q=document.createElement("div");q.textContent=b;n&&(q.id=n);h.classList.add("button");
h.appendChild(q);return h};b.isNumber=function(b){return!isNaN(parseFloat(b))};b.formatNumber=function(b,n){"undefined"===typeof n&&(n=!1);return b?n?b.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<b?(b/1E15).toFixed(3)+"Qa":999999999999<b?(b/1E12).toFixed(3)+"T":999999999<b?(b/1E9).toFixed(3)+"B":999999<b?(b/1E6).toFixed(3)+"M":b.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};b.getRandomInt=function(b,n){return Math.floor(Math.random()*(n-b+1))+b};b.formatTime=function(b){var n=
Math.floor(b/3600),h=Math.floor(b%3600/60);b=Math.floor(b%60);return(10>n?1>n?"":"0"+n+":":n+":")+(10>h?"0"+h+":":h+":")+(10>b?"0"+b:b+"")};b.convertServerTimeToLocal=function(b){var n=new Date,h=n.toISOString().split("-")[0],q=n.toISOString().split("-")[1],p=n.toISOString().split("-")[2].split("T")[0],n=+b.split(":")[0],g=+b.split(":")[1].split(" ")[0];b=b.split(":")[1].split(" ")[1];q=q+"/"+p+"/"+h+" "+((10>n?"0":"")+n)+":"+((10>g?"0":"")+g)+":00 "+b+" UTC";h=new Date(q);console.log(q);console.log(h);
n=h.getHours();g=h.getMinutes();return(10>n?"0":"")+n+":"+(10>g?"0":"")+g}})(Utils||(Utils={}));var tooltip;
(function(b){function r(b,e){var c=a.getBoundingClientRect(),d=c.right-c.left,c=c.bottom-c.top;a.style.left=d+(b+15)>window.innerWidth?b-d-15+"px":b+15+"px";a.style.top=0<e-c?e-c+"px":e+5+"px"}function n(){a&&a.parentElement.removeChild(a);k=a=null}function h(a,b,e){var c=new t;q(a);e&&(c.header=e);c.content=b;g.push(c);a.dataset?a.dataset.tooltip=p:a.setAttribute("data-tooltip",p.toString());p++}function q(b){b.onmouseenter=function(b){var m=+b.target.getAttribute("data-tooltip");f!==b.target&&(d=
setInterval(function(){e+=.01;if(.25<=e){var b=l,f=c,h=g[m];k!==m&&n();k=m;a=h.html;document.body.appendChild(a);r(b,f);e=0;clearInterval(d);d=null}},10));f=b.target};b.onmousemove=function(a){a=a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:a.clientX||a.clientY?{x:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;d||r(a.x,a.y);l=a.x;c=a.y};b.onmouseleave=function(a){f=null;clearInterval(d);e=0;n()}}var p=
0,g=[],k,a,d,e=0,l,c,f,t=function(){function a(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(a.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(a){a.classList.add("tooltip-header");this.html.appendChild(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(a){a.classList.add("tooltip-content");
this.html.appendChild(a)},enumerable:!0,configurable:!0});return a}();b.complexModify=function(a,b,e){a=g[a];e&&(a.header.parentElement.removeChild(a.header),a.header=e);a.content.parentElement.removeChild(a.content);a.content=b};b.modify=function(a,b,e){a=g[a];e&&(a.header.textContent=e);a.content.textContent=b};b.retrieveContent=function(a){return g[a].content};b.complexCreate=h;b.create=function(a,b,e){var c=document.createElement("div");c.textContent=b;e?(b=document.createElement("div"),b.textContent=
e,h(a,c,b)):h(a,c)}})(tooltip||(tooltip={}));var Chat;
(function(b){function r(){if(!h){h=document.createElement("DIV");h.classList.add("chat-window");h.classList.add("social");h.id="chatWindow";h.style.backgroundColor="#ebebeb";h.style.border="1px solid #adadad";var b=document.createElement("DIV");b.classList.add("chat-header");b.style.backgroundColor="rgb(160, 160, 160)";h.appendChild(b);var k=document.createElement("DIV");k.textContent="_";k.style.position="absolute";k.style.top="0";k.style.right="0";k.addEventListener("click",function(){h.classList.contains("closed")?
(h.classList.remove("closed"),k.textContent="_"):(h.classList.add("closed"),k.textContent="+")});b.appendChild(k);var a=document.createElement("DIV");a.classList.add("chat-room-tab");a.textContent="General";a.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});b.appendChild(a);a=document.createElement("DIV");a.classList.add("chat-room-tab");a.textContent=">Dev";a.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});a.style.display="none";b.appendChild(a);p=document.createElement("DIV");p.id="debugpane";p.classList.add("chat-room");p.style.display="none";h.appendChild(p);q=document.createElement("DIV");q.id="chatpane";q.classList.add("chat-room");h.appendChild(q);b=document.createElement("DIV");b.id="debuglog";b.classList.add("chat-room-content");p.appendChild(b);b=document.createElement("DIV");b.id="chatlog";b.classList.add("chat-room-content");
q.appendChild(b);b=document.createElement("DIV");a=document.createElement("DIV");a.classList.add("chat-textbox-container");var d=document.createElement("INPUT");d.setAttribute("TYPE","TEXT");d.classList.add("chat-textbox");d.style.borderTop="1px solid #adadad";d.setAttribute("maxlength","220");d.addEventListener("keydown",function(a){13==a.keyCode&&n();68==a.keyCode&&a.altKey&&(document.getElementById("debugtab").style.display="inline-block")});d.id="chattext";a.appendChild(d);b.appendChild(a);a=
document.createElement("DIV");a.classList.add("chat-submit-container");d=document.createElement("INPUT");d.setAttribute("TYPE","BUTTON");d.setAttribute("VALUE","SEND");d.classList.add("chat-submit");d.style.borderTop="1px solid #adadad";d.style.borderLeft="1px solid #adadad";d.addEventListener("click",function(){n()});a.appendChild(d);b.appendChild(a);h.appendChild(b);document.body.appendChild(h)}}function n(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var h,q,p;b.initialize=r;r();b.log=function(b){var k=document.getElementById("debuglog"),a=document.createElement("DIV");a.textContent=b;k.appendChild(a)};b.receiveGlobalMessage=function(b,k,a,d){var e=document.getElementById("chatlog"),l=5>Math.abs(e.scrollTop-(e.scrollHeight-e.offsetHeight)),c=document.createElement("DIV");c.classList.add("chat-msg");d&&""!=d&&c.classList.add("chat-"+d);d=document.createElement("SPAN");d.textContent="["+Utils.convertServerTimeToLocal(a)+"] ";a=document.createElement("SPAN");
a.textContent=b;a.classList.add("chat-sender");b=document.createElement("SPAN");b.textContent=k;b.classList.add("chat-text");k=document.createElement("SPAN");k.textContent=": ";c.appendChild(d);c.appendChild(a);c.appendChild(k);c.appendChild(b);e.appendChild(c);l&&(e.scrollTop=e.scrollHeight)}})(Chat||(Chat={}));var Tabs;
(function(b){function r(){if(p){var a=p.scrollHeight;a>window.innerHeight-b.bottomPadding&&(a=window.innerHeight-b.bottomPadding);h.style.minHeight=a+"px";h.style.maxHeight=a+"px";h.style.overflowY=a>=window.innerHeight-b.bottomPadding?"scroll":"hidden"}}var n=0,h=document.getElementById("paneContainer");b.bottomPadding=200;var q=[],p,g=new (function(){function a(a){this.container=a;this.tabs=[];this.lowestId=0;this.id=n++;q.push(this)}a.prototype.newTab=function(a){var e=new k;e.pane=a;a=document.createElement("DIV");
a.classList.add("tab-button");this.container.appendChild(a);e.button=a;0==this.lowestId?e.activate():e.deactivate();var l=this.lowestId++,c=this.id;a.addEventListener("click",function(){b.activateTab(c,l)});this.tabs.push(e);this.container.appendChild(a);return this.lowestId-1};a.prototype.activate=function(a){for(var b=0;b<this.tabs.length;b++)this.tabs[b].deactivate();this.tabs[a].activate()};a.prototype.css=function(a,b){this.tabs[a].button.classList.add(b)};return a}())(document.getElementById("tabContainer"));
b.registerGameTab=function(a,b){var e=g.newTab(a);b&&g.css(e,b)};b.updateGameTabs=r;Utils.addEvent(window,"resize",b.updateGameTabs);setInterval(r,20);b.activateTab=function(a,b){q[a].activate(b);r()};var k=function(){function a(){}a.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};a.prototype.activate=function(){Utils.cssSwap(this.button,"inactive","active");this.pane.style.display="block";this.pane.style.overflow=
"visible";p=this.pane};return a}()})(Tabs||(Tabs={}));var Objects;
(function(b){var r=[],n=function(){return function(){this.quantity=0}}();b.register=function(b,q){if(!r[b]){var p=new n;p.name=q;r[b]=p}};b.lookupName=function(b){return r[b].name};b.setQuantity=function(b,n){r[b].quantity=n};b.getQuantity=function(b){return(b=r[b])?b.quantity:0};b.setMaxQuantity=function(b,n){r[b].maxQuantity=n};b.getMaxQuantity=function(b){return r[b].maxQuantity};b.setLifeTimeTotal=function(b,n){r[b].lifeTimeTotal=n};b.getLifeTimeTotal=function(b){return r[b].lifeTimeTotal};b.setTooltip=
function(b,n){r[b].tooltip=n};b.getTooltip=function(b){return r[b].tooltip}})(Objects||(Objects={}));var Inventory;
(function(b){function r(a){Connection.sellItem(e.id,a?a:1)}function n(){var a=document.getElementById("selecteditemquantity"),e=+a.value;Utils.isNumber(e)&&e>b.getSelectedItemQuantity()&&(a.value=b.getSelectedItemQuantity().toString())}function h(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);a=document.createElement("DIV");a.classList.add("selected-item");a.style.display="none";var s=document.createElement("SPAN");s.textContent="x";s.style.top="0px";s.style.right=
"3px";s.style.position="absolute";s.addEventListener("click",function(){b.selectItem()});a.appendChild(s);d=document.createElement("DIV");d.classList.add("selected-item-image");s=document.createElement("INPUT");s.id="selecteditemquantity";s.type="text";s.style.height="18px";s.classList.add("selected-item-quantity");s.addEventListener("input",function(){n()});f=Utils.createButton("Drink","");f.classList.add("selected-item-quantity");f.addEventListener("click",function(){Connection.drink(e.id);n()});
var m=Utils.createButton("Sell","");m.classList.add("selected-item-quantity");m.addEventListener("click",function(){var a=+document.getElementById("selecteditemquantity").value;Utils.isNumber(a)&&b.sellSelectedItem(a);n()});var u=Utils.createButton("Sell all","");u.classList.add("selected-item-quantity");u.addEventListener("click",function(){b.sellAllSelectedItem();n()});a.appendChild(d);a.appendChild(u);a.appendChild(m);a.appendChild(f);a.appendChild(s);g.appendChild(a);s=document.createElement("DIV");
s.style.textAlign="center";m=document.createElement("DIV");m.style.display="inline-block";u=Utils.createButton("Sell (...)","");u.addEventListener("click",function(){Connection.sellAllItems()});var h=Utils.createButton("...","");h.addEventListener("click",function(){b.toggleConfig()});m.appendChild(u);m.appendChild(h);s.appendChild(m);g.appendChild(s);c=document.createElement("DIV");c.classList.add("config-container");c.classList.add("closed");s=document.createElement("TABLE");s.classList.add("config-table");
c.appendChild(s);u=s.createTHead();m=u.insertRow(0);u=u.insertRow(0);u.classList.add("table-header");u=u.insertCell(0);u.textContent="Inventory Configuration";u.setAttribute("colspan","10");m.classList.add("table-subheader");for(var p in w)0<=parseInt(p,10)&&"NFS"!=w[p]&&(m.insertCell(m.cells.length).classList.add("config-cell-check"),u=m.insertCell(m.cells.length),u.classList.add("config-cell-name"),u.textContent=w[p]);l=s.createTBody();k=document.createElement("DIV");k.style.position="relative";
k.appendChild(c);g.appendChild(k);Tabs.registerGameTab(g,"Inventory");Equipment.draw()}function q(a){var b=document.createElement("DIV");a.container=b;b.classList.add("header-item");var e=document.createElement("DIV");e.style.width="32px";e.style.height="32px";e.style.display="inline-block";e.style.position="relative";e.style.margin="0 auto";var c=document.createElement("DIV");c.classList.add("Half-"+a.name.replace(" ","_"));e.appendChild(c);b.appendChild(e);e=document.createElement("DIV");a.quantityElm=
e;e.classList.add("item-text");e.textContent=Utils.formatNumber(0);e.style.verticalAlign="top";e.style.marginTop="8px";e.style.display="inline-block";b.appendChild(e);e=document.createElement("DIV");e.style.display="none";a.worthElm=e;b.appendChild(e);return b}function p(a){if(0==a.category||null==a.category)return q(a);var e=document.createElement("DIV");a.container=e;e.classList.add("item");e.addEventListener("click",function(){b.selectItem(a.id)});tooltip.create(e,a.name);var c=document.createElement("DIV");
c.classList.add("item-text");var d=document.createElement("DIV");d.style.verticalAlign="top";d.style.display="inline-block";d.textContent=Utils.formatNumber(a.worth);a.worthElm=d;var f=document.createElement("DIV");f.classList.add("Quarter-Coins");f.style.display="inline-block";c.appendChild(f);c.appendChild(d);e.appendChild(c);d=document.createElement("DIV");d.style.width="64px";d.style.height="64px";d.style.position="relative";d.style.margin="0 auto";c=document.createElement("DIV");c.classList.add(a.name.replace(" ",
"_"));d.appendChild(c);e.appendChild(d);c=document.createElement("DIV");a.quantityElm=c;c.classList.add("item-text");c.textContent=Utils.formatNumber(0);e.appendChild(c);if(null!=a.category){var v,k,d=l.rows.length,c=a.category,c=2*c;c--;for(f=0;f<d;f++){var C=l.rows[f].cells[c];if(C&&0==C.childElementCount){v=l.rows[f].cells[c];k=l.rows[f].cells[c-1];break}}if(!v){k=l.insertRow(l.rows.length);k.classList.add("table-row");for(var g in w)0<=parseInt(g,10)&&"NFS"!=w[g]&&(k.insertCell(k.cells.length).classList.add("config-cell-check"),
k.insertCell(k.cells.length).classList.add("config-cell-name"));v=k.cells[c];k=k.cells[c-1]}g=document.createElement("DIV");g.classList.add("item-text");g.style.height="auto";d=document.createElement("SPAN");d.style.verticalAlign="top";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(a.name));c.style.display="inline-block";m[a.id]=c;d.textContent=a.name;t[a.id]=d;g.appendChild(c);g.appendChild(d);v.appendChild(g);v=document.createElement("INPUT");v.type="CHECKBOX";var h=a.id;
b.configClickers[h]=v;v.addEventListener("change",function(a){Connection.configureItem(h,b.configClickers[h].checked)});k.appendChild(v)}return e}b.items=[];b.configClickers=[];var g,k,a,d,e,l,c,f,t=[],m=[],y=function(){return function(a,b,e,c){this.id=a;this.name=b;this.worth=e;this.category=c}}();b.Item=y;(function(a){a[a.NFS=0]="NFS";a[a.ORE=1]="ORE";a[a.GEM=2]="GEM";a[a.INGREDIENT=3]="INGREDIENT";a[a.CRAFTING=4]="CRAFTING";a[a.POTION=5]="POTION"})(b.Category||(b.Category={}));var w=b.Category;
b.getSelectedItemQuantity=function(){return e?e.quantity:0};b.selectItem=function(c){c?(null!=e&&d.classList.remove(Utils.cssifyName(e.name)),e=b.items[c],d.classList.add(Utils.cssifyName(e.name)),f.style.display=5==e.category?"inline-block":"none",n()):(d.classList.remove(Utils.cssifyName(e.name)),e=null);a.style.display=null==e?"none":"block"};b.sellSelectedItem=r;b.sellAllSelectedItem=function(){r(e.quantity)};b.modifyConfig=function(a,c){b.configClickers[a]||console.log(a);b.configClickers[a].checked=
c};b.toggleConfig=function(){c.classList.contains("closed")?c.classList.remove("closed"):c.classList.add("closed")};b.addItem=function(a,c,e,d){b.items[a]||(a=new y(a,c,e,d),b.items[a.id]=a,Objects.register(a.id,a.name),g||h(),0!=a.category&&null!=a.category?k.appendChild(p(a)):document.getElementById("headerInventory").appendChild(p(a)))};b.changePrice=function(a,c){Utils.ifNotDefault(c,function(){var e=b.items[a];e.worth=c;e.worthElm.textContent=Utils.formatNumber(c)})};b.changeQuantity=function(a,
c){Utils.ifNotDefault(c,function(){Objects.setQuantity(a,c);Crafting.update();b.items[a].quantityElm.textContent=Utils.formatNumber(c);b.items[a].quantity=c;b.items[a].container.style.display=0!=b.items[a].category&&null!=b.items[a].category?0==c?"none":"inline-block":0==Objects.getLifeTimeTotal(a)?"none":"inline-block";n()})};b.update=function(){0>=t.length||b.items.forEach(function(a){var b=Objects.getLifeTimeTotal(a.id);t[a.id]&&(t[a.id].textContent=0<b?a.name:"???");m[a.id]&&(m[a.id].style.display=
0<b?"inline-block":"none")})}})(Inventory||(Inventory={}));var Statistics;
(function(b){function r(){var b=document.createElement("TABLE"),k=b.createTHead(),a=k.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.textContent="Item Statistics";a.setAttribute("colspan","3");k=k.insertRow(1);k.classList.add("table-subheader");a=k.insertCell(0);a.textContent="Lifetime Quantity";a.style.width="40%";a=k.insertCell(0);a.textContent="Prestige Quantity";a.style.width="40%";k=k.insertCell(0);k.textContent="Item";k.style.width="20%";h=b.createTBody();return b}var n,h,
q=[],p=function(){return function(){}}();b.changeStats=function(b,k,a){var d=q[b];Utils.ifNotDefault(k,function(){d.prestigeQuantity=k;d.prestigeRow.textContent=Utils.formatNumber(k)});Utils.ifNotDefault(a,function(){d.lifetimeQuantity=a;Objects.setLifeTimeTotal(b,a);d.alltimeRow.textContent=Utils.formatNumber(a)})};b.addItem=function(b,k){n||(n=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(n),Tabs.registerGameTab(n,"Statistics"),n.appendChild(r()));if(!q[b]){var a=
new p;q[b]=a;var d=h.insertRow(h.rows.length);d.classList.add("table-row");a.alltimeRow=d.insertCell(0);a.alltimeRow.style.width="40%";a.prestigeRow=d.insertCell(0);a.prestigeRow.style.width="40%";a=d.insertCell(0);a.style.width="20%";d=document.createElement("DIV");d.classList.add("Third-"+Utils.cssifyName(k));d.style.display="inline-block";a.appendChild(d)}}})(Statistics||(Statistics={}));var Store;
(function(b){function r(){h=document.createElement("div");document.getElementById("paneContainer").appendChild(h);Tabs.registerGameTab(h,"Store");for(var a in g)if(0<=parseInt(a,10)){var b=g[a];if("CRAFTING"!=b){var e=document.createElement("div");e.classList.add("store-category");p[b]=e;var l=document.createElement("div");l.textContent=b;l.classList.add("store-category-header");e.appendChild(l);h.appendChild(e)}}}function n(a){var b=document.createElement("div");"undefined"!=a.tooltip&&tooltip.create(b,
a.tooltip);b.classList.add("store-item");a.container=b;var e=document.createElement("div");e.classList.add("store-item-header");var l=document.createElement("div");l.classList.add("store-item-header-text");l.textContent=a.name;e.appendChild(l);var c=document.createElement("div");c.classList.add("store-item-header-quantity-container");var f=document.createElement("span");f.classList.add("store-item-header-quantity");var k=document.createElement("span");k.classList.add("store-item-header-quantity");
var m=document.createElement("span");m.classList.add("store-item-header-quantity");m.textContent="/";1<a.maxQuantity&&(c.appendChild(k),c.appendChild(m),c.appendChild(f));e.appendChild(c);a.maxQuantityElm=f;a.quantityElm=k;a.nameElm=l;b.appendChild(e);e=document.createElement("DIV");e.style.width="64px";e.style.height="64px";e.style.position="relative";e.style.margin="0 auto";l=document.createElement("DIV");l.classList.add(Utils.cssifyName(a.name));e.appendChild(l);b.appendChild(e);e=document.createElement("div");
e.classList.add("store-item-footer");l=document.createElement("div");l.classList.add("item-text");c=document.createElement("div");c.textContent=Utils.formatNumber(a.price);c.style.display="inline-block";c.style.verticalAlign="top";a.priceElm=c;f=document.createElement("div");f.classList.add("Quarter-Coins");f.style.display="inline-block";l.appendChild(f);l.appendChild(c);var c=document.createElement("div"),f=Utils.createButton("Buy",""),g=a.id;if(5!=a.category)f.addEventListener("click",function(){Connection.purchaseItem(g)});
else{var h=document.createElement("INPUT");h.type="TEXT";h.style.width="40px";h.style.height="15px";c.appendChild(h);f.addEventListener("click",function(){Utils.isNumber(h.value)&&Connection.purchaseItem(g,+h.value)})}c.appendChild(f);e.appendChild(c);e.appendChild(l);b.appendChild(e);return b}var h,q=[],p=[];(function(a){a[a.MINING=1]="MINING";a[a.MACHINES=2]="MACHINES";a[a.GATHERING=3]="GATHERING";a[a.PROCESSING=4]="PROCESSING";a[a.ITEMS=5]="ITEMS";a[a.CRAFTING=6]="CRAFTING"})(b.Category||(b.Category=
{}));var g=b.Category,k=function(){return function(){}}();b.tempFix=function(){r()};b.addItem=function(a,b,e,l,c,f,t){h||r();if(!q[a]){Objects.register(a,c);var m=new k;m.id=a;m.category=b;m.price=e;m.factor=l;m.name=c;m.tooltip=t;m.maxQuantity=f?f:0;Objects.register(m.id,m.name);Objects.setTooltip(m.id,m.tooltip);2==m.category&&Equipment.registerGatherer(m.id);b=p[g[b]];null==b&&(b=p.MINING);6!=m.category&&b.appendChild(n(m));q[a]=m}};b.changeQuantity=function(a,b,e,l){var c=q[a];Utils.ifNotDefault(e,
function(){if(0!=e)try{Equipment.changeMaxQuantity(a,e),c.maxQuantity=e,c.maxQuantityElm.textContent=e.toString()}catch(b){}});Utils.ifNotDefault(b,function(){Objects.setQuantity(a,b);c.quantity=b;Crafting.update();Equipment.changeQuantity(a,b);0!=e&&6!=c.category&&(c.container.style.display=-1>=c.quantity||c.quantity>=c.maxQuantity&&0<c.maxQuantity?"none":"inline-block",c.maxQuantity&&1<c.maxQuantity&&(c.quantityElm.textContent=b.toString()))});Utils.ifNotDefault(l,function(){c.priceElm&&(c.price=
l,c.priceElm.textContent=Utils.formatNumber(l))})}})(Store||(Store={}));var Rock;
(function(b){function r(){if(c){var a=Date.now(),b=a-u,b=b/1E3;u=a;x=s?x+8*b:x-8*b;if(4<x||-4>x)s=!s;p(f,t,64+x,64+x);w&&setTimeout(r,10)}else setTimeout(r,10)}function n(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}function h(a,c){if(a>f&&a<f+64&&c>t&&c<t+64){if(y){p(f+2,t+2,60,60);if(z)for(var e=Utils.getRandomInt(1,3),d=0;d<e;d++){var l=Utils.getRandomInt(-5,5),k=Utils.getRandomInt(-2,2);b.particles.push(new A(a+l,c+k))}z=!1}else p(f-2,t-2,68,68),z=!0;w=!1;
m=!0}else m&&(p(f,t,64,64),m=!1,z=!0)}function q(a,b){a!=f&&b!=t&&(f=a,t=b,c?p(a,b,64,64):setTimeout(function(){q(a,b)},10))}function p(b,c,d,k){a.clearRect(0,0,250,250);a.drawImage(e,0,0);a.drawImage(l,b,c,d,k)}var g=document.getElementById("rock"),k=document.getElementById("particles"),a=g.getContext("2d"),d=k.getContext("2d"),e=new Image,l=new Image(16,16),c=!1,f=0,t=0,m=!1,y=!1,w=!0,s=!0,x=0,u=Date.now();b.particles=[];var A=function(){function a(b,c){this.height=this.width=5;this.dispose=!1;
this.x=b;this.y=c;this.verticalVelocity=Utils.getRandomInt(-100,-155);this.horizonalVelocity=Utils.getRandomInt(-50,50);this.width=Utils.getRandomInt(3,6);this.height=Utils.getRandomInt(3,6);this.rotation=Utils.getRandomInt(0,180);this.rotationalVelocity=Utils.getRandomInt(-75,75);this.lastTick=Date.now()}a.prototype.update=function(){var a=Date.now()-this.lastTick;this.lastTick=Date.now();a/=1E3;this.rotation+=this.rotationalVelocity*a;this.y+=this.verticalVelocity*a;this.x+=this.horizonalVelocity*
a;this.verticalVelocity+=200*a;270<this.y&&(this.dispose=!0)};return a}();b.Particle=A;r();var z=!0;b.moveRock=q;var v=document.createElement("canvas"),B=v.getContext("2d");setInterval(function(){d.clearRect(0,0,250,250);for(var a=0;a<b.particles.length;a++){var c=b.particles[a];c.update();var e=c;v.width=e.width;v.height=e.height;B.rect(0,0,e.width,e.height);B.fillStyle="gray";B.fill();B.stroke();d.beginPath();var l=d,k=v,f=e.x,m=e.y,g=e.width,h=e.height,e=e.rotation*Math.PI/180;l.translate(f+g/
2,m+h/2);l.rotate(e);l.drawImage(k,g/2*-1,h/2*-1,g,h);l.rotate(-1*e);l.translate(-1*(f+g/2),-1*(m+h/2));c.dispose&&b.particles.splice(a,1)}},10);(function(){e.onload=function(){a.drawImage(e,0,0);console.log("rock loaded")};e.src="/Content/Rock.png";l.onload=function(){c=!0};l.src="/Content/Stone.png";g.addEventListener("mousemove",function(a){a=n(g,a);h(a.x,a.y)},!1);g.addEventListener("mousedown",function(a){a=n(g,a);y=!0;h(a.x,a.y);Connection.mine(a.x,a.y)},!1);g.addEventListener("mouseup",function(a){a=
n(g,a);y=!1;h(a.x,a.y)},!1);g.addEventListener("mouseleave",function(a){a=n(g,a);y=!1;h(a.x,a.y)},!1)})()})(Rock||(Rock={}));var Equipment;
(function(b){function r(){p=document.createElement("div");p.classList.add("store-category");var b=document.createElement("div");b.classList.add("store-category-header");b.textContent="Gatherers";p.appendChild(b);q.appendChild(p)}function n(b){p||r();var a=h[b];a.container=document.createElement("div");a.container.classList.add("equipment-gatherer-container");var d=document.createElement("div");d.classList.add("store-item-header");var e=document.createElement("div");e.classList.add("store-item-header-text");
e.textContent=Objects.lookupName(b);d.appendChild(e);e=Utils.createButton("Disable","");e.addEventListener("click",function(){Connection.toggleGatherer(b,!a.enabled)});var l=document.createElement("div");l.classList.add("store-item-header-quantity-container");a.quantityElm=document.createElement("span");var c=document.createElement("span");c.textContent="/";a.maxQuantityElm=document.createElement("span");l.appendChild(a.quantityElm);l.appendChild(c);l.appendChild(a.maxQuantityElm);d.appendChild(l);
a.container.appendChild(d);a.efficiencyElm=document.createElement("div");a.container.appendChild(a.efficiencyElm);a.fuelConsumptionElm=document.createElement("div");a.container.appendChild(a.fuelConsumptionElm);a.rarityBonusElm=document.createElement("div");a.container.appendChild(a.rarityBonusElm);a.container.appendChild(e);a.toggleElm=e.firstChild;p.appendChild(a.container)}var h=[],q,p,g=function(){return function(){}}();b.draw=function(){q||(q=document.createElement("div"),document.getElementById("paneContainer").appendChild(q),
Tabs.registerGameTab(q,"Equipment"))};b.registerGatherer=function(b){if(!h[b]){var a=new g;h[b]=a;n(b)}};b.toggleGatherer=function(b,a){var d=h[b];d&&(d.enabled=a,d.toggleElm.textContent=a?"Disable":"Enable")};b.changeQuantity=function(b,a){Utils.ifNotDefault(a,function(){var d=h[b];d&&(d.quantity=a,d.container.style.display=-1<a?"inline-block":"none",d.quantityElm.textContent=Utils.formatNumber(a))})};b.changeMaxQuantity=function(b,a){Utils.ifNotDefault(a,function(){var d=h[b];d&&(d.maxQuantity=
a,d.maxQuantityElm.textContent=Utils.formatNumber(a))})};b.changeFuelConsumption=function(b,a){Utils.ifNotDefault(a,function(){var d=h[b];d&&(d.fuelConsumption=a,d.fuelConsumptionElm.textContent="Fuel consumed: "+Utils.formatNumber(a))})};b.changeEfficiency=function(b,a){Utils.ifNotDefault(a,function(){var d=h[b];d&&(d.efficiency=a,d.efficiencyElm.textContent="Resources/s: "+Utils.formatNumber(a))})};b.changeRarityBonus=function(b,a){Utils.ifNotDefault(a,function(){var d=h[b];d&&(d.rarityBonus=a,
d.rarityBonusElm.textContent="Rarity multi: x"+Utils.formatNumber(a))})}})(Equipment||(Equipment={}));var Crafting;
(function(b){function r(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);Tabs.registerGameTab(g,"Crafting");k=document.createElement("DIV");g.appendChild(k);a=document.createElement("DIV");g.appendChild(a);d=document.createElement("TABLE");d.classList.add("block-table");var b=d.createTHead(),f=b.insertRow(0);f.classList.add("table-subheader");b=b.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.colSpan=e.length;b.textContent="Crafting Table";
for(b=0;b<e.length;b++){var m=f.insertCell(0);m.style.width=l[b];m.textContent=e[b];"0"!=c[b]&&(m.style.minWidth=c[b])}f=d.insertRow(2);f.classList.add("table-subheader");f=f.insertCell(0);f.colSpan=e.length;f.textContent="Items";f=d.insertRow(3);f.classList.add("table-subheader");f=f.insertCell(0);f.colSpan=e.length;f.textContent="Upgrades";a.appendChild(d)}function n(a,c){var e=b.processors[a];if(e){var d=e._recipes[c];for(e.selectedRecipe=c;e.recipeList.lastChild;)e.recipeList.removeChild(e.recipeList.lastChild);
for(var l=0;l<d.ingredients.length;l++){var f=document.createElement("DIV");f.classList.add("item-text");f.style.height="30px";var m=document.createElement("DIV");m.style.display="inline-block";var k=document.createElement("DIV");d.ingredients[l].quantityDiv=k;k.style.display="inline-block";k.style.verticalAlign="super";k.style.color=d.ingredients[l].quantity<=Objects.getQuantity(d.ingredients[l].id)?"darkgreen":"darkred";k.textContent=Utils.formatNumber(d.ingredients[l].quantity);m.classList.add("Half-"+
Utils.cssifyName(Objects.lookupName(d.ingredients[l].id)));f.appendChild(m);f.appendChild(k);e.recipeList.appendChild(f)}}}function h(a){var b=document.createElement("TABLE");b.classList.add("block-table");a.container=b;var c=b.createTHead(),d=c.insertRow(0);d.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=e.length;c.textContent=a.name;for(c=0;c<e.length;c++){var g=d.insertCell(0);g.style.width=t[c];g.textContent=f[c];"0"!=t[c]&&(g.style.minWidth=
m[c])}c=b.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=f.length;g=document.createElement("DIV");g.classList.add("progress-bar-container");d=document.createElement("DIV");d.classList.add("progress-bar");var h=document.createElement("DIV");h.classList.add("progress-bar-text-container");var p=document.createElement("DIV");p.classList.add("progress-bar-text");h.appendChild(p);g.appendChild(h);a.progressBar=d;a.progressText=p;g.appendChild(d);c.appendChild(g);d=b.insertRow(3);
d.classList.add("table-row");for(c=0;c<f.length;c++){g=d.insertCell(0);g.style.width=l[c];g.style.height="75px";"0"!=m[c]&&(g.style.minWidth=m[c]);"Image"==f[c]&&(h=document.createElement("DIV"),h.classList.add(Utils.cssifyName(a.name)),h.style.margin="0 auto",g.appendChild(h));"Capacity"==f[c]&&(g.textContent="0",a.capacityElm=g);"Input"==f[c]&&(a.recipeList=g);if("Output"==f[c]){h=Utils.createButton("Max","");g.appendChild(h);h=document.createElement("INPUT");h.type="TEXT";h.style.width="35px";
a.quantityTextbox=h;g.appendChild(h);var s=a.id,r=document.createElement("SELECT");r.addEventListener("change",function(a){n(s,r.selectedIndex)});a.recipeSelector=r;g.appendChild(r)}"Action"==f[c]&&(h=Utils.createButton("Activate",""),h.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),g.appendChild(h))}q(a);k.appendChild(b)}function q(a){x||(x=document.createElement("div"),s.appendChild(x));
var b=document.createElement("div");b.classList.add("processor-sidebar");a.sidebarContainer=b;var c=document.createElement("div");c.classList.add("buff-header");c.textContent=a.name;b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");var e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarProgressBar=e;var d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarProgressText=
d;c.appendChild(d);c.appendChild(e);b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarJobBar=e;d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarJobText=d;c.appendChild(d);c.appendChild(e);b.appendChild(c);b.style.display="none";x.appendChild(b)}function p(a,b){var f=d.rows.length;b&&(f=y,y++);f=d.insertRow(f);
f.classList.add("table-row");a.row=f;for(var m=0;m<e.length;m++){var g=f.insertCell(0);g.style.width=l[m];"0"!=c[m]&&(g.style.minWidth=c[m]);"Name"==e[m]&&(g.textContent=Objects.lookupName(a.id));if("Input"==e[m])for(var k=0;k<a.ingredients.length;k++){var h=document.createElement("DIV");h.classList.add("item-text");h.style.height="auto";var n=document.createElement("DIV");n.style.display="inline-block";var p=document.createElement("DIV");a.ingredients[k].quantityDiv=p;p.style.display="inline-block";
p.style.verticalAlign="super";p.textContent=Utils.formatNumber(a.ingredients[k].quantity);n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.ingredients[k].id)));h.appendChild(n);h.appendChild(p);g.appendChild(h)}"Description"==e[m]&&(g.textContent=Objects.getTooltip(a.resultants[0].id));if("Output"==e[m])for(k=0;k<a.resultants.length;k++)h=document.createElement("DIV"),h.classList.add("item-text"),h.style.height="auto",n=document.createElement("DIV"),n.style.display="inline-block",p=
document.createElement("DIV"),p.style.display="inline-block",p.style.verticalAlign="super",p.textContent=Utils.formatNumber(a.resultants[k].quantity),n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.resultants[k].id))),h.appendChild(n),a.isItem&&h.appendChild(p),g.appendChild(h);if("Action"==e[m]&&(k=Utils.createButton("Craft",""),k.addEventListener("click",function(){Connection.craftRecipe(a.id,1)},!1),g.appendChild(k),a.isItem)){var s=document.createElement("INPUT");s.type="TEXT";
s.style.width="30px";k=Utils.createButton("Craft-x","");k.addEventListener("click",function(){Connection.craftRecipe(a.id,+s.value)},!1);g.appendChild(k);g.appendChild(s)}}}var g,k,a,d,e=["Action","Description","Input","Output","Name"],l=["10%","50%","15%","15%","10%"],c=["170px","0","0","0","0"],f=["Action","Output","Input","Capacity","Image"],t=["10%","30%","20%","20%","20%"],m=["170px","0","0","0","0"],y=3,w=[];b.processors=[];var s=document.getElementById("sidebarInformation"),x,u=function(){function a(){this._recipes=
[]}a.prototype.addRecipe=function(a){this._recipes.push(a);this.selectedRecipe||(this.selectedRecipe=0)};return a}();b.Processor=u;var A=function(){function a(){this.ingredients=[];this.resultants=[]}a.prototype.addIngredient=function(a){this.ingredients.push(a)};a.prototype.addResultant=function(a){this.resultants.push(a)};return a}();b.Recipe=A;var z=function(){return function(a,b){this.id=a;this.quantity=b}}();b.Ingredient=z;b.addRecipe=function(a,b,c,e){g||r();if(!w[a]){var d=new A;d.id=a;d.isItem=
e;w[a]=d;for(a=0;a<b.length;a++)d.addIngredient(new z(b[a].Id,b[a].Quantity));for(a=0;a<c.length;a++)d.addResultant(new z(c[a].Id,c[a].Quantity));p(d,e)}};b.addProcessor=function(a,c,e){g||r();if(!b.processors[a]){var d=new u;d.id=a;d.name=c;d.requiredId=e;b.processors[a]=d;h(d)}};b.addProcessorRecipe=function(a,c,e){if(b.processors[a]){var d=b.processors[a],l;a:if(b.processors[a]){l=b.processors[a];for(var f=0;f<l._recipes.length;f++)if(e[0].Id==l._recipes[f].resultants[0].id){l=!0;break a}l=!1}else l=
void 0;if(!l){l=new A;for(f=0;f<c.length;f++)l.addIngredient(new z(c[f].Id,c[f].Quantity));for(f=0;f<e.length;f++)l.addResultant(new z(e[f].Id,e[f].Quantity));d.addRecipe(l);c=document.createElement("OPTION");c.textContent=Objects.lookupName(e[0].Id);d.recipeSelector.appendChild(c);1==d._recipes.length&&n(a,0)}}};b.updateProcessor=function(a,c,e,d,l,f){var m=b.processors[a];if(m){var g=!1;Utils.ifNotDefault(c,function(){m.selectedRecipe=c});Utils.ifNotDefault(l,function(){m.totalOperations=l;g=!0});
Utils.ifNotDefault(e,function(){m.operationDuration=e});Utils.ifNotDefault(f,function(){m.capacityElm.textContent=f.toString()});Utils.ifNotDefault(d,function(){m.completedOperations=d;g=!0});if(g){if(0>=m.totalOperations||m.completedOperations==m.totalOperations){m.progressBar.style.width="0%";m.progressText.textContent="";m.sidebarProgressText.textContent="";m.sidebarContainer.style.display="none";m.totalOperationCompletionTime=0;return}m.sidebarContainer.style.display="inline-block";m.operationStartTime=
Date.now();m.operationCompletionTime=m.operationStartTime+1E3*m.operationDuration;0==m.totalOperationCompletionTime&&(m.totalOperationCompletionTime=m.operationStartTime+1E3*m.operationDuration*(m.totalOperations-m.completedOperations))}if(-1<m.selectedRecipe)try{m.progressText.textContent=Objects.lookupName(m._recipes[m.selectedRecipe].resultants[0].id)+" ("+m.completedOperations+"/"+m.totalOperations+")",m.sidebarJobText.textContent=Objects.lookupName(m._recipes[m.selectedRecipe].resultants[0].id)+
" ("+m.completedOperations+"/"+m.totalOperations+")"}catch(k){console.log("invalid processor recipe "+m.selectedRecipe)}else m.progressText.textContent="",m.sidebarProgressText.textContent=""}};setInterval(function(){b.processors.forEach(function(a){if(0>=a.operationDuration)a.progressBar.style.width="0%";else if(a.completedOperations!=a.totalOperations&&0<a.totalOperations){var b=a.operationCompletionTime-Date.now(),b=b/1E3,c=a.totalOperationCompletionTime-Date.now(),e=c/(a.operationDuration*a.totalOperations),
b=b/a.operationDuration,b=100-100*b;a.progressBar.style.width=b+"%";a.sidebarJobBar.style.width=b+"%";a.sidebarProgressBar.style.width=100-e/10+"%";a.sidebarProgressText.textContent=Utils.formatTime(c/1E3)}0!=a.requiredId&&(a.container.style.display=0<Objects.getQuantity(a.requiredId)?"block":"none")})},10);b.update=function(){g&&(w.forEach(function(a){var b=Objects.getQuantity(a.id);a.row.style.display=-1==b||!a.isItem&&0<b?"none":"";a.ingredients.forEach(function(a){var b=Objects.getQuantity(a.id);
a.quantityDiv.style.color=b>=a.quantity?"darkgreen":"darkred"})}),b.processors.forEach(function(a){n(a.id,a.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));var Buffs;
(function(b){var r=[],n=document.getElementById("sidebarInformation"),h,q=function(){return function(){}}();b.register=function(b,g,k,a){if(!r[b]){var d=new q;d.name=g;d.description=k;d.duration=a;r[b]=d;b=document.createElement("div");b.classList.add("buff-container");tooltip.create(b,d.description);g=document.createElement("div");g.textContent=d.name;g.classList.add("buff-header");b.appendChild(g);g=document.createElement("div");g.classList.add("buff-image-container");b.appendChild(g);k=document.createElement("div");
k.classList.add(Utils.cssifyName(d.name));g.appendChild(k);g=document.createElement("div");g.classList.add("buff-header");b.appendChild(g);h.appendChild(b);d.container=b;d.durationElm=g}};b.update=function(b,g){var k=r[b];k.timeActive=g;k.durationElm.textContent="("+Utils.formatTime(k.duration-g)+")";k.container.style.display=0==g?"none":"inline-block"};h=document.createElement("div");n.appendChild(h)})(Buffs||(Buffs={}));var Account;
(function(b){function r(){a.classList.contains("closed")||a.classList.add("closed")}function n(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var e=document.createElement("DIV");e.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="TEXT";d.maxLength=16;d.placeholder="Username";e.appendChild(d);var l=document.createElement("DIV");l.style.marginBottom="5px";var f=document.createElement("INPUT");f.type="PASSWORD";f.pattern=".{6,}";f.placeholder="Password";
l.appendChild(f);var g=document.createElement("DIV");g.style.marginBottom="5px";var k=document.createElement("INPUT");k.type="CHECKBOX";k.placeholder="Stay logged in on this computer?";g.appendChild(k);b.appendChild(e);b.appendChild(l);b.appendChild(g);c=document.createElement("div");a.addElement(c);a.title="Log in";a.addElement(b);a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(p(d.value,
f.value,k.checked);c.firstChild;)c.removeChild(c.firstChild)},!1);a.show()}function h(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var c=document.createElement("DIV");c.style.marginBottom="5px";var e=document.createElement("INPUT");e.type="TEXT";e.maxLength=16;e.placeholder="Username";c.appendChild(e);var d=document.createElement("DIV");d.style.marginBottom="5px";var f=document.createElement("INPUT");f.type="EMAIL";f.placeholder="Email";d.appendChild(f);var g=document.createElement("DIV");
g.style.marginBottom="5px";var k=document.createElement("INPUT");k.type="PASSWORD";k.pattern=".{6,}";k.placeholder="Password";g.appendChild(k);var h=document.createElement("DIV");h.style.marginBottom="5px";var n=document.createElement("INPUT");n.type="PASSWORD";n.pattern=".{6,}";n.placeholder="Confirm password";h.appendChild(n);n.onblur=function(){k.value!=n.value&&n.setCustomValidity("Passwords are not the same.")};n.onfocus=function(){n.setCustomValidity("")};b.appendChild(c);b.appendChild(d);b.appendChild(g);
b.appendChild(h);a.addElement(b);l=document.createElement("div");a.addElement(l);a.title="Register";a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(q(f.value,e.value,k.value,n.value);l.firstChild;)l.removeChild(l.firstChild)},!1);a.show()}function q(a,b,c,e){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:a,UserName:b,Password:c,ConfirmPassword:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),k(),modal.close();else{for(;l.firstChild;)l.removeChild(l.firstChild);for(var b=0;b<a.Errors.length;b++){var c=document.createElement("div");c.textContent=a.Errors[b];l.appendChild(c)}}}})}function p(a,b,e){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:a,Password:b,RememberMe:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),
k(),modal.close();else{for(;c.firstChild;)c.removeChild(c.firstChild);for(var b=0;b<a.Errors.length;b++){var e=document.createElement("div");e.textContent=a.Errors[b];c.appendChild(e)}}}})}function g(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){console.log(a);Connection.restart();k();location.reload()}})}function k(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(c){c=JSON.parse(c);var d=c.Anonymous;e.textContent=d?"Guest":c.UserName;b.signedIn=!d;Utils.cssSwap(a,d?"registered":"anonymous",d?"anonymous":"registered")}})}var a,d,e;b.signedIn=!1;var l,c,f,t;(function(a){function c(b,e,d){a.currentlyInspecting=b;var f=new Ajax.LeaderboardAjaxService;f.resultsElement=d;f.sendRequest(b,e)}a.currentlyInspecting=0;a.open=function(){var e=new modal.Window;e.title="Leaderboards";if(!b.signedIn){var d=document.createElement("div");d.style.fontSize=
"18px";d.style.background="darkred";d.style.color="white";d.style.fontWeight="bold";d.style.textAlign="center";d.style.border="1px solid white";d.textContent="Sign in to see where you rank.";e.addElement(d)}var f=document.createElement("DIV");f.style.width="400px";f.appendChild(Ajax.createLoader());e.addElement(f);d=document.createElement("div");d.style.textAlign="center";d.style.marginTop="5px";var l=Utils.createButton("<<",""),g=document.createElement("input");g.type="TEXT";var k=Utils.createButton(">>",
"");l.addEventListener("click",function(){a.currentlyInspecting-=20;0>a.currentlyInspecting&&(a.currentlyInspecting=0);a.currentlyInspecting-=a.currentlyInspecting%20;c(a.currentlyInspecting,a.currentlyInspecting+20,f)});g.addEventListener("keyup",function(b){13==b.keyCode&&(b=b.currentTarget.value,Utils.isNumber(b)&&(a.currentlyInspecting=+b,a.currentlyInspecting-=a.currentlyInspecting%20,c(a.currentlyInspecting,a.currentlyInspecting+20,f)))});k.addEventListener("click",function(){a.currentlyInspecting+=
20;a.currentlyInspecting-=a.currentlyInspecting%20;c(a.currentlyInspecting,a.currentlyInspecting+20,f)});d.appendChild(l);d.appendChild(g);d.appendChild(k);e.addElement(d);e.addOption("Close").addEventListener("click",function(){modal.close()});e.show();c(0,20,f)}})(t||(t={}));(function(){a=document.createElement("DIV");a.classList.add("account-manager");a.classList.add("closed");a.onmouseenter=function(){clearTimeout(f)};a.onmouseleave=function(){f=setTimeout(r,250)};var b=document.createElement("DIV");
b.textContent="Sign in";b.classList.add("account-option");b.classList.add("anonymous-account-option");b.addEventListener("click",function(){n()});a.appendChild(b);b=document.createElement("DIV");b.textContent="Register";b.classList.add("account-option");b.classList.add("anonymous-account-option");b.addEventListener("click",function(){h()});a.appendChild(b);b=document.createElement("DIV");b.textContent="Options";b.classList.add("account-option");b.classList.add("registered-account-option");a.appendChild(b);
b=document.createElement("DIV");b.textContent="Sign out";b.classList.add("account-option");b.classList.add("registered-account-option");b.addEventListener("click",function(){g()});a.appendChild(b);d=document.createElement("DIV");d.classList.add("account-user");e=document.createElement("SPAN");d.appendChild(e);a.appendChild(d);document.body.appendChild(a);d.addEventListener("click",function(){a.classList.contains("closed")?a.classList.remove("closed"):a.classList.add("closed")});b=document.createElement("SPAN");
b.textContent="Leaderboards";b.addEventListener("click",function(){t.open()});b.style.cursor="pointer";document.getElementsByClassName("header-links")[0].appendChild(b);k()})();b.info=k})(Account||(Account={}));var modal;
(function(b){function r(){b.activeWindow&&b.activeWindow.hide();b.activeWindow=null}function n(){if(b.activeWindow){var g=b.activeWindow.container.getBoundingClientRect();b.activeWindow.container.style.left=window.innerWidth/2-(g.right-g.left)/2+"px";b.activeWindow.container.style.top=window.innerHeight/2-(g.bottom-g.top)/2+"px"}else clearInterval(b.intervalIdentifier)}var h=0,q;b.activeWindow;b.intervalIdentifier;b.hide=r;b.close=function(){if(b.activeWindow){var g=b.activeWindow;r();g.container.parentNode.removeChild(g.container)}};
var p=function(){function g(){this.container=document.createElement("div");this.container.addEventListener("click",function(a){a.stopPropagation()},!1);this.container.classList.add("modal-window");if(!q){var g=document.createElement("div");q=g;g.classList.add("modal-wrapper");g.addEventListener("click",function(a){a.stopPropagation();3E3<Date.now()-h&&b.close()},!1);document.body.appendChild(g)}q.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(g.prototype,"title",{get:function(){return this._title},set:function(b){this._title=b;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});g.prototype.addElement=function(b){this.bodyEl.appendChild(b)};g.prototype.addOption=function(b){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var a=document.createElement("span");a.classList.add("modal-option");var d=document.createElement("span");d.textContent=b;a.appendChild(d);this.options.appendChild(a);return a};g.prototype.addAffirmativeOption=function(b){b=this.addOption(b);b.classList.add("affirmative");return b};g.prototype.addNegativeOption=function(b){b=this.addOption(b);b.classList.add("negative");return b};g.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");q.classList.contains("opened")||
q.classList.add("opened");b.activeWindow=this;n();b.intervalIdentifier=setInterval(n,100);h=Date.now()};g.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");q.classList.contains("opened")&&q.classList.remove("opened")};return g}();b.Window=p})(modal||(modal={}));var Ajax;
(function(b){function r(){for(var b=0;b<n.length;b++){var g=n[b];g.dead?n.splice(b,1):g.update()}setTimeout(r,10)}var n=[],h=function(){function b(){}b.prototype.failed=function(b){this.resultsElement.textContent="Loading failed..."};b.prototype.succeeded=function(b){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var k=document.createElement("table"),a=k.createTHead().insertRow(0);a.classList.add("table-subheader");var d=a.insertCell(0);d.textContent=
"Score";d.style.width="65%";d=a.insertCell(0);d.textContent="Name";d.style.width="25%";a=a.insertCell(0);a.textContent="Rank";a.style.width="10%";for(var a=k.createTBody(),e=0;e<b.length;e++){var l=b[e],c=a.insertRow(a.rows.length);c.classList.add("table-row");var f=c.insertCell(0);f.textContent=Utils.formatNumber(l.Score);f.style.width="65%";f.addEventListener("click",function(a){var b=a.target;a=b.dataset?b.dataset.tooltip:b.getAttribute("data-tooltip");0<b.textContent.indexOf(",")?b.textContent=
Utils.formatNumber(a):b.textContent=Utils.formatNumber(a,!0)});f.dataset?f.dataset.tooltip=l.Score:f.setAttribute("data-tooltip",l.Score.toString());c.insertCell(0).textContent=l.UserId;d.style.width="25%";c=c.insertCell(0);c.textContent=Utils.formatNumber(l.Rank);c.style.width="10%"}this.resultsElement.appendChild(k)};b.prototype.sendRequest=function(b,k){var a=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:b,Upper:k}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(b){b=JSON.parse(b);a.succeeded(b)},failure:function(b){a.failed(b)}})};return b}();b.LeaderboardAjaxService=h;var q=function(){function b(){this.notDisplayed=20;this.notches=40;this.space=.02;this.spawned=!1;this.spinPos=0;this.spinSpeed=30;this.squareSize=50;this.timeSinceLastTick=Date.now();this.thickness=3;this.dead=!1;this.container=document.createElement("div");this.container.classList.add("loader");this.canvasElement=document.createElement("canvas");this.canvasElement.width=
this.squareSize;this.canvasElement.height=this.squareSize;this.container.appendChild(this.canvasElement);this.context=this.canvasElement.getContext("2d")}b.prototype.update=function(){var b=Date.now();this.canvasElement.parentElement&&(this.spawned=!0);var k=b-this.timeSinceLastTick;this.spinPos+=k/1E3*this.spinSpeed;this.timeSinceLastTick=b;this.spawned&&!this.canvasElement.parentElement&&(this.dead=!0);this.draw()};b.prototype.draw=function(){var b=this.squareSize/2,k=this.squareSize/2-5,a=(2-this.space*
this.notches)/this.notches,d=this.spinPos%this.notches,e=d-this.notDisplayed;this.context.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);for(var l=0;l<this.notches;l++){var c=0+l*a+this.space*l,f=c+a,h=l-this.notches;l<=d&&l>=e?(this.context.beginPath(),this.context.arc(b,b,k,c*Math.PI,f*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(d-l)/(this.notches-this.notDisplayed))+")",this.context.stroke()):h<=d&&h>=e&&(this.context.beginPath(),
this.context.arc(b,b,k,c*Math.PI,f*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(d-h)/(this.notches-this.notDisplayed))+")",this.context.stroke())}};return b}();b.createLoader=function(){var b=new q;n.push(b);return b.container};r()})(Ajax||(Ajax={}));var Connection;
(function(b){function r(){console.log("Connection opened");var a=d.encode64();n(a);d=new Komodo.ClientActions;q=setInterval(function(){var a=d.encode64();n(a);d=new Komodo.ClientActions},1E3)}function n(a){if(a.encode64){var b=a.encode64();Chat.log("Sent "+h(b)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+h(a)+" bytes to komodo."),Komodo.send(a)}function h(a){var b=[];a=[a];for(var c=
0;a.length;){var d=a.pop();if("boolean"===typeof d)c+=4;else if("string"===typeof d)c+=2*d.length;else if("number"===typeof d)c+=8;else if("object"===typeof d&&-1===b.indexOf(d)){b.push(d);for(var g in d)a.push(d[g])}}return c}var q,p,g,k,a;(function(){var b=document.getElementsByClassName("header-links")[0],d=document.createElement("div");d.style.display="inline-block";d.textContent="Version History";d.addEventListener("click",function(){window.open("/version")});d.style.cursor="pointer";b.appendChild(d);
a=document.createElement("div");a.style.display="inline-block";a.textContent="There are 0 players mining.";b.appendChild(a);p=document.createElement("div");p.classList.add("error-notification-tray");g=document.createElement("div");g.classList.add("network-error");b=document.createElement("div");b.classList.add("network-error-text");b.textContent="No connection";g.appendChild(b);k=document.createElement("div");k.classList.add("rate-limited");b=document.createElement("div");b.classList.add("network-error-text");
k.style.display="none";b.textContent="You have exceeded your allotted requests";k.appendChild(b);b=document.getElementById("game");p.appendChild(g);p.appendChild(k);b.insertBefore(p,b.childNodes[0])})();Komodo.connection.received(function(b){Chat.log("Recieved "+h(b)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(b);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(b)));Chat.log(h(JSON.stringify(Komodo.decode(b)))-h(b)+" bytes saved.");b=Komodo.decode(b);if(null!=b.Messages)for(var d=
b.Messages,c=0;c<d.length;c++){var f=d[c];console.log(f);Chat.receiveGlobalMessage(f.Sender,f.Text,f.Time,f.Permissions)}if(null!=b.GameSchema){d=b.GameSchema;if(d.Items)for(c=0;c<d.Items.length;c++)Inventory.addItem(d.Items[c].Id,d.Items[c].Name,d.Items[c].Worth,d.Items[c].Category),Statistics.addItem(d.Items[c].Id,d.Items[c].Name);if(d.StoreItems)for(c=0;c<d.StoreItems.length;c++)f=d.StoreItems[c],Store.addItem(f.Id,f.Category,f.Price,f.Factor,f.Name,f.MaxQuantity,f.Tooltip);if(d.Processors)for(c=
0;c<d.Processors.length;c++){f=d.Processors[c];Crafting.addProcessor(f.Id,f.Name,f.RequiredId);for(var g=0;g<f.Recipes.length;g++)Crafting.addProcessorRecipe(f.Id,f.Recipes[g].Ingredients,f.Recipes[g].Resultants)}if(d.CraftingItems)for(c=0;c<d.CraftingItems.length;c++)f=d.CraftingItems[c],Crafting.addRecipe(f.Id,f.Ingredients,f.Resultants,f.IsItem);if(d.Buffs)for(c=0;c<d.Buffs.length;c++)f=d.Buffs[c],Buffs.register(f.Id,f.Name,f.Description,f.Duration)}if(null!=b.Items)for(d=b.Items,c=0;c<d.length;c++)Inventory.changeQuantity(d[c].Id,
d[c].Quantity),Inventory.changePrice(d[c].Id,d[c].Worth);if(null!=b.StoreItemsUpdate)for(d=b.StoreItemsUpdate,c=0;c<d.length;c++)Store.changeQuantity(d[c].Id,d[c].Quantity,d[c].MaxQuantity,d[c].Price);if(null!=b.StatItemsUpdate)for(d=b.StatItemsUpdate,c=0;c<d.length;c++)Statistics.changeStats(d[c].Id,d[c].PrestigeQuantity,d[c].LifeTimeQuantity);if(null!=b.ConfigItems)for(d=b.ConfigItems,c=0;c<d.length;c++)Inventory.modifyConfig(d[c].Id,d[c].Enabled);if(null!=b.Processors)for(d=b.Processors,c=0;c<
d.length;c++)f=d[c],Crafting.updateProcessor(f.Id,f.SelectedRecipe,f.OperationDuration,f.CompletedOperations,f.TotalOperations,f.Capacity);null!=b.AntiCheatCoordinates&&(d=b.AntiCheatCoordinates,Rock.moveRock(d.X,d.Y));if(null!=b.Buffs)for(d=b.Buffs,c=0;c<d.length;c++)f=d[c],Buffs.update(f.Id,f.TimeActive);null!=b.IsRateLimited&&(k.style.display=b.IsRateLimited?"block":"none");if(null!=b.Gatherers)for(d=b.Gatherers,c=0;c<d.length;c++)f=d[c],Equipment.toggleGatherer(f.Id,f.Enabled),Equipment.changeEfficiency(f.Id,
f.Efficiency),Equipment.changeFuelConsumption(f.Id,f.FuelConsumed),Equipment.changeRarityBonus(f.Id,f.RarityBonus);b.ConnectedUsers&&(a.textContent="There are "+b.ConnectedUsers+" players mining.")});b.restart=function(){Komodo.restart()};var d=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(r(),g.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(q),g.style.display="block");a.newState===
$.signalR.connectionState.reconnecting&&(g.style.display="block")});b.toggleGatherer=function(a,b){var c=new Komodo.ClientActions.GathererAction;c.Id=a;c.Enabled=b;d.GathererActions.push(c)};b.drink=function(a){var b=new Komodo.ClientActions.PotionAction;b.Id=a;d.PotionActions.push(b)};b.mine=function(a,b){var c=new Komodo.ClientActions.MiningAction;c.X=a;c.Y=b;d.MiningActions.push(c)};b.sellItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.SellAction;
f.Id=a;f.Quantity=b;c.Sell=f;d.InventoryActions.push(c)};b.configureItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.ConfigAction;f.Id=a;f.Enabled=b;c.Config=f;d.InventoryActions.push(c)};b.purchaseItem=function(a,b){var c=new Komodo.ClientActions.StoreAction,f=new Komodo.ClientActions.StoreAction.PurchaseAction;f.Id=a;f.Quantity=b?b:1;c.Purchase=f;d.StoreActions.push(c)};b.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;
a.SellAll=!0;d.InventoryActions.push(a)};b.craftRecipe=function(a,b){var c=new Komodo.ClientActions.CraftingAction;c.Id=a;c.Quantity=b;d.CraftingActions.push(c)};b.processRecipe=function(a,b,c){var f=new Komodo.ClientActions.ProcessingAction;f.Id=a;f.RecipeIndex=b;f.Iterations=c;d.ProcessingActions.push(f)};b.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,c=new Komodo.ClientActions.SocialAction.ChatAction;c.GlobalMessage=a;b.Chat=c;d.SocialActions.push(b)};b.send=n})(Connection||
=======
(function(a){a.addEvent=function(a,k,f){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(k,f,!1):a.attachEvent?a.attachEvent("on"+k,f):a["on"+k]=f)};a.cssSwap=function(a,k,f){a.classList.contains(k)&&a.classList.remove(k);a.classList.add(f)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,k){-100!=a&&k()};a.createButton=function(a,k){var f,q;f=document.createElement("div");q=document.createElement("div");q.textContent=a;k&&(q.id=k);f.classList.add("button");
f.appendChild(q);return f};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a,k){"undefined"===typeof k&&(k=!1);return a?k?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.getRandomInt=function(a,k){return Math.floor(Math.random()*(k-a+1))+a};a.formatTime=function(a){var k=
Math.floor(a/3600),f=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>k?1>k?"":"0"+k+":":k+":")+(10>f?"0"+f+":":f+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=function(a){var k=+a.split(":")[0],f=+a.split(":")[1].split(" ")[0];"PM"==a.split(":")[1].split(" ")[1]&&(k+=12);a=(new Date).getTimezoneOffset();k-=a/60-a%60;f-=a%60;0>k&&(k=24-k);0>f&&(f=60-f,k--);23<k&&(k-=24);59<f&&(f-=60,k++);return(10>k?"0":"")+k+":"+(10>f?"0":"")+f}})(Utils||(Utils={}));var Ajax;
(function(a){function p(){for(var a=0;a<k.length;a++){var f=k[a];f.dead?k.splice(a,1):f.update()}setTimeout(p,10)}var k=[],f=function(){function a(){this.notDisplayed=20;this.notches=40;this.space=.02;this.spawned=!1;this.spinPos=0;this.spinSpeed=30;this.squareSize=50;this.timeSinceLastTick=Date.now();this.thickness=3;this.dead=!1;this.container=document.createElement("div");this.container.classList.add("loader");this.canvasElement=document.createElement("canvas");this.canvasElement.width=this.squareSize;
this.canvasElement.height=this.squareSize;this.container.appendChild(this.canvasElement);this.context=this.canvasElement.getContext("2d")}a.prototype.update=function(){var a=Date.now();this.canvasElement.parentElement&&(this.spawned=!0);var g=a-this.timeSinceLastTick;this.spinPos+=g/1E3*this.spinSpeed;this.timeSinceLastTick=a;this.spawned&&!this.canvasElement.parentElement&&(this.dead=!0);this.draw()};a.prototype.draw=function(){var a=this.squareSize/2,g=this.squareSize/2-5,m=(2-this.space*this.notches)/
this.notches,b=this.spinPos%this.notches,d=b-this.notDisplayed;this.context.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);for(var e=0;e<this.notches;e++){var l=0+e*m+this.space*e,c=l+m,h=e-this.notches;e<=b&&e>=d?(this.context.beginPath(),this.context.arc(a,a,g,l*Math.PI,c*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(b-e)/(this.notches-this.notDisplayed))+")",this.context.stroke()):h<=b&&h>=d&&(this.context.beginPath(),this.context.arc(a,
a,g,l*Math.PI,c*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(b-h)/(this.notches-this.notDisplayed))+")",this.context.stroke())}};return a}();a.createLoader=function(){var a=new f;k.push(a);return a.container};p()})(Ajax||(Ajax={}));var modal;
(function(a){function p(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function k(){if(a.activeWindow){var g=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(g.right-g.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(g.bottom-g.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var f=0,q;a.activeWindow;a.intervalIdentifier;a.hide=p;a.close=function(){if(a.activeWindow){var g=a.activeWindow;p();g.container.parentNode.removeChild(g.container)}};
var n=function(){function g(){this.container=document.createElement("div");this.container.addEventListener("click",function(a){a.stopPropagation()},!1);this.container.classList.add("modal-window");if(!q){var g=document.createElement("div");q=g;g.classList.add("modal-wrapper");g.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-f&&a.close()},!1);document.body.appendChild(g)}q.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(g.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});g.prototype.addElement=function(a){this.bodyEl.appendChild(a)};g.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var d=document.createElement("span");d.textContent=a;b.appendChild(d);this.options.appendChild(b);return b};g.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};g.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};g.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");q.classList.contains("opened")||
q.classList.add("opened");a.activeWindow=this;k();a.intervalIdentifier=setInterval(k,100);f=Date.now()};g.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");q.classList.contains("opened")&&q.classList.remove("opened")};return g}();a.Window=n})(modal||(modal={}));var Objects;
(function(a){var p=[],k=function(){return function(){this.quantity=0}}();a.register=function(a,q){if(!p[a]){var n=new k;n.name=q;p[a]=n}};a.lookupName=function(a){return p[a].name};a.setQuantity=function(a,k){p[a].quantity=k};a.getQuantity=function(a){return(a=p[a])?a.quantity:0};a.setMaxQuantity=function(a,k){p[a].maxQuantity=k};a.getMaxQuantity=function(a){return p[a].maxQuantity};a.setLifeTimeTotal=function(a,k){p[a].lifeTimeTotal=k};a.getLifeTimeTotal=function(a){return p[a].lifeTimeTotal};a.setTooltip=
function(a,k){p[a].tooltip=k};a.getTooltip=function(a){return p[a].tooltip}})(Objects||(Objects={}));var Account;
(function(a){function p(){b.classList.contains("closed")||b.classList.add("closed")}function k(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var e=document.createElement("DIV");e.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="TEXT";d.maxLength=16;d.placeholder="Username";e.appendChild(d);var l=document.createElement("DIV");l.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="PASSWORD";g.pattern=".{6,}";g.placeholder="Password";
l.appendChild(g);var h=document.createElement("DIV");h.style.marginBottom="5px";var m=document.createElement("INPUT");m.type="CHECKBOX";m.placeholder="Stay logged in on this computer?";h.appendChild(m);b.appendChild(e);b.appendChild(l);b.appendChild(h);c=document.createElement("div");a.addElement(c);a.title="Log in";a.addElement(b);a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(n(d.value,
g.value,m.checked);c.firstChild;)c.removeChild(c.firstChild)},!1);a.show()}function f(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var e=document.createElement("DIV");e.style.marginBottom="5px";var c=document.createElement("INPUT");c.type="TEXT";c.maxLength=16;c.placeholder="Username";e.appendChild(c);var d=document.createElement("DIV");d.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="EMAIL";g.placeholder="Email";d.appendChild(g);var h=document.createElement("DIV");
h.style.marginBottom="5px";var m=document.createElement("INPUT");m.type="PASSWORD";m.pattern=".{6,}";m.placeholder="Password";h.appendChild(m);var t=document.createElement("DIV");t.style.marginBottom="5px";var v=document.createElement("INPUT");v.type="PASSWORD";v.pattern=".{6,}";v.placeholder="Confirm password";t.appendChild(v);v.onblur=function(){m.value!=v.value&&v.setCustomValidity("Passwords are not the same.")};v.onfocus=function(){v.setCustomValidity("")};b.appendChild(e);b.appendChild(d);b.appendChild(h);
b.appendChild(t);a.addElement(b);l=document.createElement("div");a.addElement(l);a.title="Register";a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(q(g.value,c.value,m.value,v.value);l.firstChild;)l.removeChild(l.firstChild)},!1);a.show()}function q(a,b,e,c){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:a,UserName:b,Password:e,ConfirmPassword:c}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),m(),modal.close();else{for(;l.firstChild;)l.removeChild(l.firstChild);for(var b=0;b<a.Errors.length;b++){var e=document.createElement("div");e.textContent=a.Errors[b];l.appendChild(e)}}}})}function n(a,b,e){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:a,Password:b,RememberMe:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),
m(),modal.close();else{for(;c.firstChild;)c.removeChild(c.firstChild);for(var b=0;b<a.Errors.length;b++){var e=document.createElement("div");e.textContent=a.Errors[b];c.appendChild(e)}}}})}function g(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){console.log(a);Connection.restart();m();location.reload()}})}function m(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);var c=a.Anonymous;e.textContent=c?"Guest":a.UserName;Utils.cssSwap(b,c?"registered":"anonymous",c?"anonymous":"registered")}})}var b,d,e,l,c,h,u=function(){function a(){}a.prototype.failed=function(a){this.resultsElement.textContent="Loading failed..."};a.prototype.succeeded=function(a){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var b=document.createElement("table"),e=b.createTHead().insertRow(0);e.classList.add("table-subheader");
var c=e.insertCell(0);c.textContent="Score";c.style.width="65%";c=e.insertCell(0);c.textContent="Name";c.style.width="25%";e=e.insertCell(0);e.textContent="Rank";e.style.width="10%";for(var e=b.createTBody(),d=0;d<a.length;d++){var l=a[d];console.log(l);var g=e.insertRow(e.rows.length);g.classList.add("table-row");var t=g.insertCell(0);t.textContent=Utils.formatNumber(l.Score);t.style.width="65%";t.addEventListener("click",function(a){var b=a.target;a=b.dataset?b.dataset.tooltip:b.getAttribute("data-tooltip");
0<b.textContent.indexOf(",")?b.textContent=Utils.formatNumber(a):b.textContent=Utils.formatNumber(a,!0)});t.dataset?t.dataset.tooltip=l.Score:t.setAttribute("data-tooltip",l.Score.toString());g.insertCell(0).textContent=l.UserId;c.style.width="25%";g=g.insertCell(0);g.textContent=Utils.formatNumber(l.Rank);g.style.width="10%"}this.resultsElement.appendChild(b)};a.prototype.sendRequest=function(a,b){var e=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:a,Upper:b}),
headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);e.succeeded(a)},failure:function(a){e.failed(a)}})};return a}();(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(h)};b.onmouseleave=function(){h=setTimeout(p,250)};var a=document.createElement("DIV");a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",
function(){k()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){f()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");
a.addEventListener("click",function(){g()});b.appendChild(a);d=document.createElement("DIV");d.classList.add("account-user");e=document.createElement("SPAN");d.appendChild(e);b.appendChild(d);document.body.appendChild(b);d.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});a=document.createElement("SPAN");a.textContent="Leaderboards";a.addEventListener("click",function(){var a=new modal.Window;a.title="Leaderboards";var b=document.createElement("DIV");
b.style.width="400px";b.appendChild(Ajax.createLoader());a.addElement(b);var e=new u;e.resultsElement=b;e.sendRequest(0,20);a.show()});a.style.cursor="pointer";document.getElementsByClassName("header-links")[0].appendChild(a);m()})();a.info=m})(Account||(Account={}));var Rock;
(function(a){function p(){if(c){var a=Date.now(),b=a-r,b=b/1E3;r=a;x=A?x+8*b:x-8*b;if(4<x||-4>x)A=!A;n(h,u,64+x,64+x);w&&setTimeout(p,10)}else setTimeout(p,10)}function k(a,b){var e=a.getBoundingClientRect();return{x:b.clientX-e.left,y:b.clientY-e.top}}function f(b,e){if(b>h&&b<h+64&&e>u&&e<u+64){if(y){n(h+2,u+2,60,60);if(z)for(var c=Utils.getRandomInt(1,3),d=0;d<c;d++){var l=Utils.getRandomInt(-5,5),g=Utils.getRandomInt(-2,2);a.particles.push(new B(b+l,e+g))}z=!1}else n(h-2,u-2,68,68),z=!0;w=!1;
s=!0}else s&&(n(h,u,64,64),s=!1,z=!0)}function q(a,b){a!=h&&b!=u&&(h=a,u=b,c?n(a,b,64,64):setTimeout(function(){q(a,b)},10))}function n(a,c,d,g){b.clearRect(0,0,250,250);b.drawImage(e,0,0);b.drawImage(l,a,c,d,g)}var g=document.getElementById("rock"),m=document.getElementById("particles"),b=g.getContext("2d"),d=m.getContext("2d"),e=new Image,l=new Image(16,16),c=!1,h=0,u=0,s=!1,y=!1,w=!0,A=!0,x=0,r=Date.now();a.particles=[];var B=function(){function a(b,e){this.height=this.width=5;this.dispose=!1;
this.x=b;this.y=e;this.verticalVelocity=Utils.getRandomInt(-100,-155);this.horizonalVelocity=Utils.getRandomInt(-50,50);this.width=Utils.getRandomInt(3,6);this.height=Utils.getRandomInt(3,6);this.rotation=Utils.getRandomInt(0,180);this.rotationalVelocity=Utils.getRandomInt(-75,75);this.lastTick=Date.now()}a.prototype.update=function(){var a=Date.now()-this.lastTick;this.lastTick=Date.now();a/=1E3;this.rotation+=this.rotationalVelocity*a;this.y+=this.verticalVelocity*a;this.x+=this.horizonalVelocity*
a;this.verticalVelocity+=200*a;270<this.y&&(this.dispose=!0)};return a}();a.Particle=B;p();var z=!0;a.moveRock=q;var t=document.createElement("canvas"),v=t.getContext("2d");setInterval(function(){d.clearRect(0,0,250,250);for(var b=0;b<a.particles.length;b++){var e=a.particles[b];e.update();var c=e;t.width=c.width;t.height=c.height;v.rect(0,0,c.width,c.height);v.fillStyle="gray";v.fill();v.stroke();d.beginPath();var l=d,g=t,h=c.x,A=c.y,m=c.width,f=c.height,c=c.rotation*Math.PI/180;l.translate(h+m/
2,A+f/2);l.rotate(c);l.drawImage(g,m/2*-1,f/2*-1,m,f);l.rotate(-1*c);l.translate(-1*(h+m/2),-1*(A+f/2));e.dispose&&a.particles.splice(b,1)}},10);(function(){e.onload=function(){b.drawImage(e,0,0);console.log("rock loaded")};e.src="/Content/Rock.png";l.onload=function(){c=!0};l.src="/Content/Stone.png";g.addEventListener("mousemove",function(a){a=k(g,a);f(a.x,a.y)},!1);g.addEventListener("mousedown",function(a){a=k(g,a);y=!0;f(a.x,a.y);Connection.mine(a.x,a.y)},!1);g.addEventListener("mouseup",function(a){a=
k(g,a);y=!1;f(a.x,a.y)},!1);g.addEventListener("mouseleave",function(a){a=k(g,a);y=!1;f(a.x,a.y)},!1)})()})(Rock||(Rock={}));var Tabs;
(function(a){function p(){if(n){var b=n.scrollHeight;b>window.innerHeight-a.bottomPadding&&(b=window.innerHeight-a.bottomPadding);f.style.minHeight=b+"px";f.style.maxHeight=b+"px";f.style.overflowY=b>=window.innerHeight-a.bottomPadding?"scroll":"hidden"}}var k=0,f=document.getElementById("paneContainer");a.bottomPadding=200;var q=[],n,g=new (function(){function b(a){this.container=a;this.tabs=[];this.lowestId=0;this.id=k++;q.push(this)}b.prototype.newTab=function(b){var e=new m;e.pane=b;b=document.createElement("DIV");
b.classList.add("tab-button");this.container.appendChild(b);e.button=b;0==this.lowestId?e.activate():e.deactivate();var l=this.lowestId++,c=this.id;b.addEventListener("click",function(){a.activateTab(c,l)});this.tabs.push(e);this.container.appendChild(b);return this.lowestId-1};b.prototype.activate=function(a){for(var b=0;b<this.tabs.length;b++)this.tabs[b].deactivate();this.tabs[a].activate()};b.prototype.css=function(a,b){this.tabs[a].button.classList.add(b)};return b}())(document.getElementById("tabContainer"));
a.registerGameTab=function(a,d){var e=g.newTab(a);d&&g.css(e,d)};a.updateGameTabs=p;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(p,20);a.activateTab=function(a,d){q[a].activate(d);p()};var m=function(){function a(){}a.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};a.prototype.activate=function(){Utils.cssSwap(this.button,"inactive","active");this.pane.style.display="block";this.pane.style.overflow=
"visible";n=this.pane};return a}()})(Tabs||(Tabs={}));var Chat;
(function(a){function p(){if(!f){f=document.createElement("DIV");f.classList.add("chat-window");f.classList.add("social");f.id="chatWindow";f.style.backgroundColor="#ebebeb";f.style.border="1px solid #adadad";var a=document.createElement("DIV");a.classList.add("chat-header");a.style.backgroundColor="rgb(160, 160, 160)";f.appendChild(a);var m=document.createElement("DIV");m.textContent="_";m.style.position="absolute";m.style.top="0";m.style.right="0";m.addEventListener("click",function(){f.classList.contains("closed")?
(f.classList.remove("closed"),m.textContent="_"):(f.classList.add("closed"),m.textContent="+")});a.appendChild(m);var b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent="General";b.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});a.appendChild(b);b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent=">Dev";b.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});b.style.display="none";a.appendChild(b);n=document.createElement("DIV");n.id="debugpane";n.classList.add("chat-room");n.style.display="none";f.appendChild(n);q=document.createElement("DIV");q.id="chatpane";q.classList.add("chat-room");f.appendChild(q);a=document.createElement("DIV");a.id="debuglog";a.classList.add("chat-room-content");n.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.classList.add("chat-room-content");
q.appendChild(a);a=document.createElement("DIV");b=document.createElement("DIV");b.classList.add("chat-textbox-container");var d=document.createElement("INPUT");d.setAttribute("TYPE","TEXT");d.classList.add("chat-textbox");d.style.borderTop="1px solid #adadad";d.setAttribute("maxlength","220");d.addEventListener("keydown",function(a){13==a.keyCode&&k();68==a.keyCode&&a.altKey&&(document.getElementById("debugtab").style.display="inline-block")});d.id="chattext";b.appendChild(d);a.appendChild(b);b=
document.createElement("DIV");b.classList.add("chat-submit-container");d=document.createElement("INPUT");d.setAttribute("TYPE","BUTTON");d.setAttribute("VALUE","SEND");d.classList.add("chat-submit");d.style.borderTop="1px solid #adadad";d.style.borderLeft="1px solid #adadad";d.addEventListener("click",function(){k()});b.appendChild(d);a.appendChild(b);f.appendChild(a);document.body.appendChild(f)}}function k(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var f,q,n;a.initialize=p;p();a.log=function(a){var m=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;m.appendChild(b)};a.receiveGlobalMessage=function(a,m,b,d){var e=document.getElementById("chatlog"),l=5>Math.abs(e.scrollTop-(e.scrollHeight-e.offsetHeight)),c=document.createElement("DIV");c.classList.add("chat-msg");d&&""!=d&&c.classList.add("chat-"+d);d=document.createElement("SPAN");d.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");
b.textContent=a;b.classList.add("chat-sender");a=document.createElement("SPAN");a.textContent=m;a.classList.add("chat-text");m=document.createElement("SPAN");m.textContent=": ";c.appendChild(d);c.appendChild(b);c.appendChild(m);c.appendChild(a);e.appendChild(c);l&&(e.scrollTop=e.scrollHeight)}})(Chat||(Chat={}));var tooltip;
(function(a){function p(a,e){var c=b.getBoundingClientRect(),d=c.right-c.left,c=c.bottom-c.top;b.style.left=d+(a+15)>window.innerWidth?a-d-15+"px":a+15+"px";b.style.top=0<e-c?e-c+"px":e+5+"px"}function k(){b&&b.parentElement.removeChild(b);m=b=null}function f(a,b,e){var c=new u;q(a);e&&(c.header=e);c.content=b;g.push(c);a.dataset?a.dataset.tooltip=n:a.setAttribute("data-tooltip",n.toString());n++}function q(a){a.onmouseenter=function(a){var f=+a.target.getAttribute("data-tooltip");h!==a.target&&(d=
setInterval(function(){e+=.01;if(.25<=e){var a=l,h=c,r=g[f];m!==f&&k();m=f;b=r.html;document.body.appendChild(b);p(a,h);e=0;clearInterval(d);d=null}},10));h=a.target};a.onmousemove=function(a){a=a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:a.clientX||a.clientY?{x:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;d||p(a.x,a.y);l=a.x;c=a.y};a.onmouseleave=function(a){h=null;clearInterval(d);e=0;k()}}var n=
0,g=[],m,b,d,e=0,l,c,h,u=function(){function a(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(a.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(a){a.classList.add("tooltip-header");this.html.appendChild(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(a){a.classList.add("tooltip-content");
this.html.appendChild(a)},enumerable:!0,configurable:!0});return a}();a.complexModify=function(a,b,e){a=g[a];e&&(a.header.parentElement.removeChild(a.header),a.header=e);a.content.parentElement.removeChild(a.content);a.content=b};a.modify=function(a,b,e){a=g[a];e&&(a.header.textContent=e);a.content.textContent=b};a.retrieveContent=function(a){return g[a].content};a.complexCreate=f;a.create=function(a,b,e){var c=document.createElement("div");c.textContent=b;e?(b=document.createElement("div"),b.textContent=
e,f(a,c,b)):f(a,c)}})(tooltip||(tooltip={}));var Inventory;
(function(a){function p(a){Connection.sellItem(e.id,a?a:1)}function k(){var b=document.getElementById("selecteditemquantity"),e=+b.value;Utils.isNumber(e)&&e>a.getSelectedItemQuantity()&&(b.value=a.getSelectedItemQuantity().toString())}function f(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var f=document.createElement("SPAN");f.textContent="x";f.style.top="0px";f.style.right=
"3px";f.style.position="absolute";f.addEventListener("click",function(){a.selectItem()});b.appendChild(f);d=document.createElement("DIV");d.classList.add("selected-item-image");f=document.createElement("INPUT");f.id="selecteditemquantity";f.type="text";f.style.height="18px";f.classList.add("selected-item-quantity");f.addEventListener("input",function(){k()});h=Utils.createButton("Drink","");h.classList.add("selected-item-quantity");h.addEventListener("click",function(){Connection.drink(e.id);k()});
var n=Utils.createButton("Sell","");n.classList.add("selected-item-quantity");n.addEventListener("click",function(){var b=+document.getElementById("selecteditemquantity").value;Utils.isNumber(b)&&a.sellSelectedItem(b);k()});var r=Utils.createButton("Sell all","");r.classList.add("selected-item-quantity");r.addEventListener("click",function(){a.sellAllSelectedItem();k()});b.appendChild(d);b.appendChild(r);b.appendChild(n);b.appendChild(h);b.appendChild(f);g.appendChild(b);f=document.createElement("DIV");
f.style.textAlign="center";n=document.createElement("DIV");n.style.display="inline-block";r=Utils.createButton("Sell (...)","");r.addEventListener("click",function(){Connection.sellAllItems()});var q=Utils.createButton("...","");q.addEventListener("click",function(){a.toggleConfig()});n.appendChild(r);n.appendChild(q);f.appendChild(n);g.appendChild(f);c=document.createElement("DIV");c.classList.add("config-container");c.classList.add("closed");f=document.createElement("TABLE");f.classList.add("config-table");
c.appendChild(f);r=f.createTHead();n=r.insertRow(0);r=r.insertRow(0);r.classList.add("table-header");r=r.insertCell(0);r.textContent="Inventory Configuration";r.setAttribute("colspan","10");n.classList.add("table-subheader");for(var p in w)0<=parseInt(p,10)&&"NFS"!=w[p]&&(n.insertCell(n.cells.length).classList.add("config-cell-check"),r=n.insertCell(n.cells.length),r.classList.add("config-cell-name"),r.textContent=w[p]);l=f.createTBody();m=document.createElement("DIV");m.style.position="relative";
m.appendChild(c);g.appendChild(m);Tabs.registerGameTab(g,"Inventory");Equipment.draw()}function q(a){var b=document.createElement("DIV");a.container=b;b.classList.add("header-item");var e=document.createElement("DIV");e.style.width="32px";e.style.height="32px";e.style.display="inline-block";e.style.position="relative";e.style.margin="0 auto";var c=document.createElement("DIV");c.classList.add("Half-"+a.name.replace(" ","_"));e.appendChild(c);b.appendChild(e);e=document.createElement("DIV");a.quantityElm=
e;e.classList.add("item-text");e.textContent=Utils.formatNumber(0);e.style.verticalAlign="top";e.style.marginTop="8px";e.style.display="inline-block";b.appendChild(e);e=document.createElement("DIV");e.style.display="none";a.worthElm=e;b.appendChild(e);return b}function n(b){if(0==b.category||null==b.category)return q(b);var e=document.createElement("DIV");b.container=e;e.classList.add("item");e.addEventListener("click",function(){a.selectItem(b.id)});tooltip.create(e,b.name);var c=document.createElement("DIV");
c.classList.add("item-text");var d=document.createElement("DIV");d.style.verticalAlign="top";d.style.display="inline-block";d.textContent=Utils.formatNumber(b.worth);b.worthElm=d;var h=document.createElement("DIV");h.classList.add("Quarter-Coins");h.style.display="inline-block";c.appendChild(h);c.appendChild(d);e.appendChild(c);d=document.createElement("DIV");d.style.width="64px";d.style.height="64px";d.style.position="relative";d.style.margin="0 auto";c=document.createElement("DIV");c.classList.add(b.name.replace(" ",
"_"));d.appendChild(c);e.appendChild(d);c=document.createElement("DIV");b.quantityElm=c;c.classList.add("item-text");c.textContent=Utils.formatNumber(0);e.appendChild(c);if(null!=b.category){var t,g,d=l.rows.length,c=b.category,c=2*c;c--;for(h=0;h<d;h++){var f=l.rows[h].cells[c];if(f&&0==f.childElementCount){t=l.rows[h].cells[c];g=l.rows[h].cells[c-1];break}}if(!t){g=l.insertRow(l.rows.length);g.classList.add("table-row");for(var m in w)0<=parseInt(m,10)&&"NFS"!=w[m]&&(g.insertCell(g.cells.length).classList.add("config-cell-check"),
g.insertCell(g.cells.length).classList.add("config-cell-name"));t=g.cells[c];g=g.cells[c-1]}m=document.createElement("DIV");m.classList.add("item-text");m.style.height="auto";d=document.createElement("SPAN");d.style.verticalAlign="top";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(b.name));c.style.display="inline-block";s[b.id]=c;d.textContent=b.name;u[b.id]=d;m.appendChild(c);m.appendChild(d);t.appendChild(m);t=document.createElement("INPUT");t.type="CHECKBOX";var k=b.id;
a.configClickers[k]=t;t.addEventListener("change",function(b){Connection.configureItem(k,a.configClickers[k].checked)});g.appendChild(t)}return e}a.items=[];a.configClickers=[];var g,m,b,d,e,l,c,h,u=[],s=[],y=function(){return function(a,b,e,c){this.id=a;this.name=b;this.worth=e;this.category=c}}();a.Item=y;(function(a){a[a.NFS=0]="NFS";a[a.ORE=1]="ORE";a[a.GEM=2]="GEM";a[a.INGREDIENT=3]="INGREDIENT";a[a.CRAFTING=4]="CRAFTING";a[a.POTION=5]="POTION"})(a.Category||(a.Category={}));var w=a.Category;
a.getSelectedItemQuantity=function(){return e?e.quantity:0};a.selectItem=function(c){c?(null!=e&&d.classList.remove(Utils.cssifyName(e.name)),e=a.items[c],d.classList.add(Utils.cssifyName(e.name)),h.style.display=5==e.category?"inline-block":"none",k()):(d.classList.remove(Utils.cssifyName(e.name)),e=null);b.style.display=null==e?"none":"block"};a.sellSelectedItem=p;a.sellAllSelectedItem=function(){p(e.quantity)};a.modifyConfig=function(b,e){a.configClickers[b]||console.log(b);a.configClickers[b].checked=
e};a.toggleConfig=function(){c.classList.contains("closed")?c.classList.remove("closed"):c.classList.add("closed")};a.addItem=function(b,e,c,d){a.items[b]||(b=new y(b,e,c,d),a.items[b.id]=b,Objects.register(b.id,b.name),g||f(),0!=b.category&&null!=b.category?m.appendChild(n(b)):document.getElementById("headerInventory").appendChild(n(b)))};a.changePrice=function(b,e){Utils.ifNotDefault(e,function(){var c=a.items[b];c.worth=e;c.worthElm.textContent=Utils.formatNumber(e)})};a.changeQuantity=function(b,
e){Utils.ifNotDefault(e,function(){Objects.setQuantity(b,e);Crafting.update();a.items[b].quantityElm.textContent=Utils.formatNumber(e);a.items[b].quantity=e;a.items[b].container.style.display=0!=a.items[b].category&&null!=a.items[b].category?0==e?"none":"inline-block":0==Objects.getLifeTimeTotal(b)?"none":"inline-block";k()})};a.update=function(){0>=u.length||a.items.forEach(function(a){var b=Objects.getLifeTimeTotal(a.id);u[a.id]&&(u[a.id].textContent=0<b?a.name:"???");s[a.id]&&(s[a.id].style.display=
0<b?"inline-block":"none")})}})(Inventory||(Inventory={}));var Statistics;
(function(a){function p(){var a=document.createElement("TABLE"),m=a.createTHead(),b=m.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");m=m.insertRow(1);m.classList.add("table-subheader");b=m.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=m.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";m=m.insertCell(0);m.textContent="Item";m.style.width="20%";f=a.createTBody();return a}var k,f,
q=[],n=function(){return function(){}}();a.changeStats=function(a,f,b){var d=q[a];Utils.ifNotDefault(f,function(){d.prestigeQuantity=f;d.prestigeRow.textContent=Utils.formatNumber(f)});Utils.ifNotDefault(b,function(){d.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);d.alltimeRow.textContent=Utils.formatNumber(b)})};a.addItem=function(a,m){k||(k=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(k),Tabs.registerGameTab(k,"Statistics"),k.appendChild(p()));if(!q[a]){var b=
new n;q[a]=b;var d=f.insertRow(f.rows.length);d.classList.add("table-row");b.alltimeRow=d.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=d.insertCell(0);b.prestigeRow.style.width="40%";b=d.insertCell(0);b.style.width="20%";d=document.createElement("DIV");d.classList.add("Third-"+Utils.cssifyName(m));d.style.display="inline-block";b.appendChild(d)}}})(Statistics||(Statistics={}));var Store;
(function(a){function p(){f=document.createElement("div");document.getElementById("paneContainer").appendChild(f);Tabs.registerGameTab(f,"Store");for(var a in g)if(0<=parseInt(a,10)){var d=g[a];if("CRAFTING"!=d){var e=document.createElement("div");e.classList.add("store-category");n[d]=e;var l=document.createElement("div");l.textContent=d;l.classList.add("store-category-header");e.appendChild(l);f.appendChild(e)}}}function k(a){var d=document.createElement("div");"undefined"!=a.tooltip&&tooltip.create(d,
a.tooltip);d.classList.add("store-item");a.container=d;var e=document.createElement("div");e.classList.add("store-item-header");var l=document.createElement("div");l.classList.add("store-item-header-text");l.textContent=a.name;e.appendChild(l);var c=document.createElement("div");c.classList.add("store-item-header-quantity-container");var h=document.createElement("span");h.classList.add("store-item-header-quantity");var f=document.createElement("span");f.classList.add("store-item-header-quantity");
var g=document.createElement("span");g.classList.add("store-item-header-quantity");g.textContent="/";1<a.maxQuantity&&(c.appendChild(f),c.appendChild(g),c.appendChild(h));e.appendChild(c);a.maxQuantityElm=h;a.quantityElm=f;a.nameElm=l;d.appendChild(e);e=document.createElement("DIV");e.style.width="64px";e.style.height="64px";e.style.position="relative";e.style.margin="0 auto";l=document.createElement("DIV");l.classList.add(Utils.cssifyName(a.name));e.appendChild(l);d.appendChild(e);e=document.createElement("div");
e.classList.add("store-item-footer");l=document.createElement("div");l.classList.add("item-text");c=document.createElement("div");c.textContent=Utils.formatNumber(a.price);c.style.display="inline-block";c.style.verticalAlign="top";a.priceElm=c;h=document.createElement("div");h.classList.add("Quarter-Coins");h.style.display="inline-block";l.appendChild(h);l.appendChild(c);var c=document.createElement("div"),h=Utils.createButton("Buy",""),m=a.id;if(5!=a.category)h.addEventListener("click",function(){Connection.purchaseItem(m)});
else{var k=document.createElement("INPUT");k.type="TEXT";k.style.width="40px";k.style.height="15px";c.appendChild(k);h.addEventListener("click",function(){Utils.isNumber(k.value)&&Connection.purchaseItem(m,+k.value)})}c.appendChild(h);e.appendChild(c);e.appendChild(l);d.appendChild(e);return d}var f,q=[],n=[];(function(a){a[a.MINING=1]="MINING";a[a.MACHINES=2]="MACHINES";a[a.GATHERING=3]="GATHERING";a[a.PROCESSING=4]="PROCESSING";a[a.ITEMS=5]="ITEMS";a[a.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category=
{}));var g=a.Category,m=function(){return function(){}}();a.tempFix=function(){p()};a.addItem=function(a,d,e,l,c,h,u){f||p();if(!q[a]){Objects.register(a,c);var s=new m;s.id=a;s.category=d;s.price=e;s.factor=l;s.name=c;s.tooltip=u;s.maxQuantity=h?h:0;Objects.register(s.id,s.name);Objects.setTooltip(s.id,s.tooltip);2==s.category&&Equipment.registerGatherer(s.id);d=n[g[d]];null==d&&(d=n.MINING);6!=s.category&&d.appendChild(k(s));q[a]=s}};a.changeQuantity=function(a,d,e,l){var c=q[a];Utils.ifNotDefault(e,
function(){if(0!=e)try{Equipment.changeMaxQuantity(a,e),c.maxQuantity=e,c.maxQuantityElm.textContent=e.toString()}catch(d){}});Utils.ifNotDefault(d,function(){Objects.setQuantity(a,d);c.quantity=d;Crafting.update();Equipment.changeQuantity(a,d);0!=e&&6!=c.category&&(c.container.style.display=-1>=c.quantity||c.quantity>=c.maxQuantity&&0<c.maxQuantity?"none":"inline-block",c.maxQuantity&&1<c.maxQuantity&&(c.quantityElm.textContent=d.toString()))});Utils.ifNotDefault(l,function(){c.priceElm&&(c.price=
l,c.priceElm.textContent=Utils.formatNumber(l))})}})(Store||(Store={}));var Equipment;
(function(a){function p(){n=document.createElement("div");n.classList.add("store-category");var a=document.createElement("div");a.classList.add("store-category-header");a.textContent="Gatherers";n.appendChild(a);q.appendChild(n)}function k(a){n||p();var b=f[a];b.container=document.createElement("div");b.container.classList.add("equipment-gatherer-container");var d=document.createElement("div");d.classList.add("store-item-header");var e=document.createElement("div");e.classList.add("store-item-header-text");
e.textContent=Objects.lookupName(a);d.appendChild(e);e=Utils.createButton("Disable","");e.addEventListener("click",function(){Connection.toggleGatherer(a,!b.enabled)});var l=document.createElement("div");l.classList.add("store-item-header-quantity-container");b.quantityElm=document.createElement("span");var c=document.createElement("span");c.textContent="/";b.maxQuantityElm=document.createElement("span");l.appendChild(b.quantityElm);l.appendChild(c);l.appendChild(b.maxQuantityElm);d.appendChild(l);
b.container.appendChild(d);b.efficiencyElm=document.createElement("div");b.container.appendChild(b.efficiencyElm);b.fuelConsumptionElm=document.createElement("div");b.container.appendChild(b.fuelConsumptionElm);b.rarityBonusElm=document.createElement("div");b.container.appendChild(b.rarityBonusElm);b.container.appendChild(e);b.toggleElm=e.firstChild;n.appendChild(b.container)}var f=[],q,n,g=function(){return function(){}}();a.draw=function(){q||(q=document.createElement("div"),document.getElementById("paneContainer").appendChild(q),
Tabs.registerGameTab(q,"Equipment"))};a.registerGatherer=function(a){if(!f[a]){var b=new g;f[a]=b;k(a)}};a.toggleGatherer=function(a,b){var d=f[a];d&&(d.enabled=b,d.toggleElm.textContent=b?"Disable":"Enable")};a.changeQuantity=function(a,b){Utils.ifNotDefault(b,function(){var d=f[a];d&&(d.quantity=b,d.container.style.display=-1<b?"inline-block":"none",d.quantityElm.textContent=Utils.formatNumber(b))})};a.changeMaxQuantity=function(a,b){Utils.ifNotDefault(b,function(){var d=f[a];d&&(d.maxQuantity=
b,d.maxQuantityElm.textContent=Utils.formatNumber(b))})};a.changeFuelConsumption=function(a,b){Utils.ifNotDefault(b,function(){var d=f[a];d&&(d.fuelConsumption=b,d.fuelConsumptionElm.textContent="Fuel consumed: "+Utils.formatNumber(b))})};a.changeEfficiency=function(a,b){Utils.ifNotDefault(b,function(){var d=f[a];d&&(d.efficiency=b,d.efficiencyElm.textContent="Resources/s: "+Utils.formatNumber(b))})};a.changeRarityBonus=function(a,b){Utils.ifNotDefault(b,function(){var d=f[a];d&&(d.rarityBonus=b,
d.rarityBonusElm.textContent="Rarity multi: x"+Utils.formatNumber(b))})}})(Equipment||(Equipment={}));var Crafting;
(function(a){function p(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);Tabs.registerGameTab(g,"Crafting");m=document.createElement("DIV");g.appendChild(m);b=document.createElement("DIV");g.appendChild(b);d=document.createElement("TABLE");d.classList.add("block-table");var a=d.createTHead(),h=a.insertRow(0);h.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=e.length;a.textContent="Crafting Table";
for(a=0;a<e.length;a++){var f=h.insertCell(0);f.style.width=l[a];f.textContent=e[a];"0"!=c[a]&&(f.style.minWidth=c[a])}h=d.insertRow(2);h.classList.add("table-subheader");h=h.insertCell(0);h.colSpan=e.length;h.textContent="Items";h=d.insertRow(3);h.classList.add("table-subheader");h=h.insertCell(0);h.colSpan=e.length;h.textContent="Upgrades";b.appendChild(d)}function k(b,e){var c=a.processors[b];if(c){var d=c._recipes[e];for(c.selectedRecipe=e;c.recipeList.lastChild;)c.recipeList.removeChild(c.recipeList.lastChild);
for(var l=0;l<d.ingredients.length;l++){var h=document.createElement("DIV");h.classList.add("item-text");h.style.height="30px";var f=document.createElement("DIV");f.style.display="inline-block";var g=document.createElement("DIV");d.ingredients[l].quantityDiv=g;g.style.display="inline-block";g.style.verticalAlign="super";g.style.color=d.ingredients[l].quantity<=Objects.getQuantity(d.ingredients[l].id)?"darkgreen":"darkred";g.textContent=Utils.formatNumber(d.ingredients[l].quantity);f.classList.add("Half-"+
Utils.cssifyName(Objects.lookupName(d.ingredients[l].id)));h.appendChild(f);h.appendChild(g);c.recipeList.appendChild(h)}}}function f(a){var b=document.createElement("TABLE");b.classList.add("block-table");a.container=b;var c=b.createTHead(),d=c.insertRow(0);d.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=e.length;c.textContent=a.name;for(c=0;c<e.length;c++){var f=d.insertCell(0);f.style.width=u[c];f.textContent=h[c];"0"!=u[c]&&(f.style.minWidth=
s[c])}c=b.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=h.length;f=document.createElement("DIV");f.classList.add("progress-bar-container");d=document.createElement("DIV");d.classList.add("progress-bar");var g=document.createElement("DIV");g.classList.add("progress-bar-text-container");var n=document.createElement("DIV");n.classList.add("progress-bar-text");g.appendChild(n);f.appendChild(g);a.progressBar=d;a.progressText=n;f.appendChild(d);c.appendChild(f);d=b.insertRow(3);
d.classList.add("table-row");for(c=0;c<h.length;c++){f=d.insertCell(0);f.style.width=l[c];f.style.height="75px";"0"!=s[c]&&(f.style.minWidth=s[c]);"Image"==h[c]&&(g=document.createElement("DIV"),g.classList.add(Utils.cssifyName(a.name)),g.style.margin="0 auto",f.appendChild(g));"Capacity"==h[c]&&(f.textContent="0",a.capacityElm=f);"Input"==h[c]&&(a.recipeList=f);if("Output"==h[c]){g=Utils.createButton("Max","");f.appendChild(g);g=document.createElement("INPUT");g.type="TEXT";g.style.width="35px";
a.quantityTextbox=g;f.appendChild(g);var p=a.id,r=document.createElement("SELECT");r.addEventListener("change",function(a){k(p,r.selectedIndex)});a.recipeSelector=r;f.appendChild(r)}"Action"==h[c]&&(g=Utils.createButton("Activate",""),g.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),f.appendChild(g))}q(a);m.appendChild(b)}function q(a){x||(x=document.createElement("div"),A.appendChild(x));
var b=document.createElement("div");b.classList.add("processor-sidebar");a.sidebarContainer=b;var c=document.createElement("div");c.classList.add("buff-header");c.textContent=a.name;b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");var e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarProgressBar=e;var d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarProgressText=
d;c.appendChild(d);c.appendChild(e);b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarJobBar=e;d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarJobText=d;c.appendChild(d);c.appendChild(e);b.appendChild(c);b.style.display="none";x.appendChild(b)}function n(a,b){var f=d.rows.length;b&&(f=y,y++);f=d.insertRow(f);
f.classList.add("table-row");a.row=f;for(var h=0;h<e.length;h++){var g=f.insertCell(0);g.style.width=l[h];"0"!=c[h]&&(g.style.minWidth=c[h]);"Name"==e[h]&&(g.textContent=Objects.lookupName(a.id));if("Input"==e[h])for(var k=0;k<a.ingredients.length;k++){var m=document.createElement("DIV");m.classList.add("item-text");m.style.height="auto";var n=document.createElement("DIV");n.style.display="inline-block";var p=document.createElement("DIV");a.ingredients[k].quantityDiv=p;p.style.display="inline-block";
p.style.verticalAlign="super";p.textContent=Utils.formatNumber(a.ingredients[k].quantity);n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.ingredients[k].id)));m.appendChild(n);m.appendChild(p);g.appendChild(m)}"Description"==e[h]&&(g.textContent=Objects.getTooltip(a.resultants[0].id));if("Output"==e[h])for(k=0;k<a.resultants.length;k++)m=document.createElement("DIV"),m.classList.add("item-text"),m.style.height="auto",n=document.createElement("DIV"),n.style.display="inline-block",p=
document.createElement("DIV"),p.style.display="inline-block",p.style.verticalAlign="super",p.textContent=Utils.formatNumber(a.resultants[k].quantity),n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.resultants[k].id))),m.appendChild(n),a.isItem&&m.appendChild(p),g.appendChild(m);if("Action"==e[h]&&(k=Utils.createButton("Craft",""),k.addEventListener("click",function(){Connection.craftRecipe(a.id,1)},!1),g.appendChild(k),a.isItem)){var q=document.createElement("INPUT");q.type="TEXT";
q.style.width="30px";k=Utils.createButton("Craft-x","");k.addEventListener("click",function(){Connection.craftRecipe(a.id,+q.value)},!1);g.appendChild(k);g.appendChild(q)}}}var g,m,b,d,e=["Action","Description","Input","Output","Name"],l=["10%","50%","15%","15%","10%"],c=["170px","0","0","0","0"],h=["Action","Output","Input","Capacity","Image"],u=["10%","30%","20%","20%","20%"],s=["170px","0","0","0","0"],y=3,w=[];a.processors=[];var A=document.getElementById("sidebarInformation"),x,r=function(){function a(){this._recipes=
[]}a.prototype.addRecipe=function(a){this._recipes.push(a);this.selectedRecipe||(this.selectedRecipe=0)};return a}();a.Processor=r;var B=function(){function a(){this.ingredients=[];this.resultants=[]}a.prototype.addIngredient=function(a){this.ingredients.push(a)};a.prototype.addResultant=function(a){this.resultants.push(a)};return a}();a.Recipe=B;var z=function(){return function(a,b){this.id=a;this.quantity=b}}();a.Ingredient=z;a.addRecipe=function(a,b,c,e){g||p();if(!w[a]){var d=new B;d.id=a;d.isItem=
e;w[a]=d;for(a=0;a<b.length;a++)d.addIngredient(new z(b[a].Id,b[a].Quantity));for(a=0;a<c.length;a++)d.addResultant(new z(c[a].Id,c[a].Quantity));n(d,e)}};a.addProcessor=function(b,c,e){g||p();if(!a.processors[b]){var d=new r;d.id=b;d.name=c;d.requiredId=e;a.processors[b]=d;f(d)}};a.addProcessorRecipe=function(b,c,e){if(a.processors[b]){var d=a.processors[b],l;a:if(a.processors[b]){l=a.processors[b];for(var h=0;h<l._recipes.length;h++)if(e[0].Id==l._recipes[h].resultants[0].id){l=!0;break a}l=!1}else l=
void 0;if(!l){l=new B;for(h=0;h<c.length;h++)l.addIngredient(new z(c[h].Id,c[h].Quantity));for(h=0;h<e.length;h++)l.addResultant(new z(e[h].Id,e[h].Quantity));d.addRecipe(l);c=document.createElement("OPTION");c.textContent=Objects.lookupName(e[0].Id);d.recipeSelector.appendChild(c);1==d._recipes.length&&k(b,0)}}};a.updateProcessor=function(b,c,e,d,l,h){var f=a.processors[b];if(f){var g=!1;Utils.ifNotDefault(c,function(){f.selectedRecipe=c});Utils.ifNotDefault(l,function(){f.totalOperations=l;g=!0});
Utils.ifNotDefault(e,function(){f.operationDuration=e});Utils.ifNotDefault(h,function(){f.capacityElm.textContent=h.toString()});Utils.ifNotDefault(d,function(){f.completedOperations=d;g=!0});if(g){if(0>=f.totalOperations||f.completedOperations==f.totalOperations){f.progressBar.style.width="0%";f.progressText.textContent="";f.sidebarProgressText.textContent="";f.sidebarContainer.style.display="none";f.totalOperationCompletionTime=0;return}f.sidebarContainer.style.display="inline-block";f.operationStartTime=
Date.now();f.operationCompletionTime=f.operationStartTime+1E3*f.operationDuration;0==f.totalOperationCompletionTime&&(f.totalOperationCompletionTime=f.operationStartTime+1E3*f.operationDuration*(f.totalOperations-f.completedOperations))}if(-1<f.selectedRecipe)try{f.progressText.textContent=Objects.lookupName(f._recipes[f.selectedRecipe].resultants[0].id)+" ("+f.completedOperations+"/"+f.totalOperations+")",f.sidebarJobText.textContent=Objects.lookupName(f._recipes[f.selectedRecipe].resultants[0].id)+
" ("+f.completedOperations+"/"+f.totalOperations+")"}catch(k){console.log("invalid processor recipe "+f.selectedRecipe)}else f.progressText.textContent="",f.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(a){if(0>=a.operationDuration)a.progressBar.style.width="0%";else if(a.completedOperations!=a.totalOperations&&0<a.totalOperations){var b=a.operationCompletionTime-Date.now(),b=b/1E3,c=a.totalOperationCompletionTime-Date.now(),e=c/(a.operationDuration*a.totalOperations),
b=b/a.operationDuration,b=100-100*b;a.progressBar.style.width=b+"%";a.sidebarJobBar.style.width=b+"%";a.sidebarProgressBar.style.width=100-e/10+"%";a.sidebarProgressText.textContent=Utils.formatTime(c/1E3)}0!=a.requiredId&&(a.container.style.display=0<Objects.getQuantity(a.requiredId)?"block":"none")})},10);a.update=function(){g&&(w.forEach(function(a){var b=Objects.getQuantity(a.id);a.row.style.display=-1==b||!a.isItem&&0<b?"none":"";a.ingredients.forEach(function(a){var b=Objects.getQuantity(a.id);
a.quantityDiv.style.color=b>=a.quantity?"darkgreen":"darkred"})}),a.processors.forEach(function(a){k(a.id,a.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));var Buffs;
(function(a){var p=[],k=document.getElementById("sidebarInformation"),f,q=function(){return function(){}}();a.register=function(a,g,k,b){if(!p[a]){var d=new q;d.name=g;d.description=k;d.duration=b;p[a]=d;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,d.description);g=document.createElement("div");g.textContent=d.name;g.classList.add("buff-header");a.appendChild(g);g=document.createElement("div");g.classList.add("buff-image-container");a.appendChild(g);k=document.createElement("div");
k.classList.add(Utils.cssifyName(d.name));g.appendChild(k);g=document.createElement("div");g.classList.add("buff-header");a.appendChild(g);f.appendChild(a);d.container=a;d.durationElm=g}};a.update=function(a,f){var k=p[a];k.timeActive=f;k.durationElm.textContent="("+Utils.formatTime(k.duration-f)+")";k.container.style.display=0==f?"none":"inline-block"};f=document.createElement("div");k.appendChild(f)})(Buffs||(Buffs={}));var Connection;
(function(a){function p(){console.log("Connection opened");var a=d.encode64();k(a);d=new Komodo.ClientActions;q=setInterval(function(){var a=d.encode64();k(a);d=new Komodo.ClientActions},1E3)}function k(a){if(a.encode64){var b=a.encode64();Chat.log("Sent "+f(b)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+f(a)+" bytes to komodo."),Komodo.send(a)}function f(a){var b=[];a=[a];for(var c=
0;a.length;){var d=a.pop();if("boolean"===typeof d)c+=4;else if("string"===typeof d)c+=2*d.length;else if("number"===typeof d)c+=8;else if("object"===typeof d&&-1===b.indexOf(d)){b.push(d);for(var f in d)a.push(d[f])}}return c}var q,n,g,m,b;(function(){var a=document.getElementsByClassName("header-links")[0],d=document.createElement("div");d.style.display="inline-block";d.textContent="Version History";d.addEventListener("click",function(){window.open("/version")});d.style.cursor="pointer";a.appendChild(d);
b=document.createElement("div");b.style.display="inline-block";b.textContent="There are 0 players mining.";a.appendChild(b);n=document.createElement("div");n.classList.add("error-notification-tray");g=document.createElement("div");g.classList.add("network-error");a=document.createElement("div");a.classList.add("network-error-text");a.textContent="No connection";g.appendChild(a);m=document.createElement("div");m.classList.add("rate-limited");a=document.createElement("div");a.classList.add("network-error-text");
m.style.display="none";a.textContent="You have exceeded your allotted requests";m.appendChild(a);a=document.getElementById("game");n.appendChild(g);n.appendChild(m);a.insertBefore(n,a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+f(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));Chat.log(f(JSON.stringify(Komodo.decode(a)))-f(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var d=
a.Messages,c=0;c<d.length;c++){var h=d[c];Chat.receiveGlobalMessage(h.Sender,h.Text,h.Time,h.Permissions)}if(null!=a.GameSchema){d=a.GameSchema;if(d.Items)for(c=0;c<d.Items.length;c++)Inventory.addItem(d.Items[c].Id,d.Items[c].Name,d.Items[c].Worth,d.Items[c].Category),Statistics.addItem(d.Items[c].Id,d.Items[c].Name);if(d.StoreItems)for(c=0;c<d.StoreItems.length;c++)h=d.StoreItems[c],Store.addItem(h.Id,h.Category,h.Price,h.Factor,h.Name,h.MaxQuantity,h.Tooltip);if(d.Processors)for(c=0;c<d.Processors.length;c++){h=
d.Processors[c];Crafting.addProcessor(h.Id,h.Name,h.RequiredId);for(var g=0;g<h.Recipes.length;g++)Crafting.addProcessorRecipe(h.Id,h.Recipes[g].Ingredients,h.Recipes[g].Resultants)}if(d.CraftingItems)for(c=0;c<d.CraftingItems.length;c++)h=d.CraftingItems[c],Crafting.addRecipe(h.Id,h.Ingredients,h.Resultants,h.IsItem);if(d.Buffs)for(c=0;c<d.Buffs.length;c++)h=d.Buffs[c],Buffs.register(h.Id,h.Name,h.Description,h.Duration)}if(null!=a.Items)for(d=a.Items,c=0;c<d.length;c++)Inventory.changeQuantity(d[c].Id,
d[c].Quantity),Inventory.changePrice(d[c].Id,d[c].Worth);if(null!=a.StoreItemsUpdate)for(d=a.StoreItemsUpdate,c=0;c<d.length;c++)Store.changeQuantity(d[c].Id,d[c].Quantity,d[c].MaxQuantity,d[c].Price);if(null!=a.StatItemsUpdate)for(d=a.StatItemsUpdate,c=0;c<d.length;c++)Statistics.changeStats(d[c].Id,d[c].PrestigeQuantity,d[c].LifeTimeQuantity);if(null!=a.ConfigItems)for(d=a.ConfigItems,c=0;c<d.length;c++)Inventory.modifyConfig(d[c].Id,d[c].Enabled);if(null!=a.Processors)for(d=a.Processors,c=0;c<
d.length;c++)h=d[c],Crafting.updateProcessor(h.Id,h.SelectedRecipe,h.OperationDuration,h.CompletedOperations,h.TotalOperations,h.Capacity);null!=a.AntiCheatCoordinates&&(d=a.AntiCheatCoordinates,Rock.moveRock(d.X,d.Y));if(null!=a.Buffs)for(d=a.Buffs,c=0;c<d.length;c++)h=d[c],Buffs.update(h.Id,h.TimeActive);null!=a.IsRateLimited&&(m.style.display=a.IsRateLimited?"block":"none");if(null!=a.Gatherers)for(d=a.Gatherers,c=0;c<d.length;c++)h=d[c],Equipment.toggleGatherer(h.Id,h.Enabled),Equipment.changeEfficiency(h.Id,
h.Efficiency),Equipment.changeFuelConsumption(h.Id,h.FuelConsumed),Equipment.changeRarityBonus(h.Id,h.RarityBonus);a.ConnectedUsers&&(b.textContent="There are "+a.ConnectedUsers+" players mining.")});a.restart=function(){Komodo.restart()};var d=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(p(),g.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(q),g.style.display="block");a.newState===
$.signalR.connectionState.reconnecting&&(g.style.display="block")});a.toggleGatherer=function(a,b){var c=new Komodo.ClientActions.GathererAction;c.Id=a;c.Enabled=b;d.GathererActions.push(c)};a.drink=function(a){var b=new Komodo.ClientActions.PotionAction;b.Id=a;d.PotionActions.push(b)};a.mine=function(a,b){var c=new Komodo.ClientActions.MiningAction;c.X=a;c.Y=b;d.MiningActions.push(c)};a.sellItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.SellAction;
f.Id=a;f.Quantity=b;c.Sell=f;d.InventoryActions.push(c)};a.configureItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.ConfigAction;f.Id=a;f.Enabled=b;c.Config=f;d.InventoryActions.push(c)};a.purchaseItem=function(a,b){var c=new Komodo.ClientActions.StoreAction,f=new Komodo.ClientActions.StoreAction.PurchaseAction;f.Id=a;f.Quantity=b?b:1;c.Purchase=f;d.StoreActions.push(c)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;
a.SellAll=!0;d.InventoryActions.push(a)};a.craftRecipe=function(a,b){var c=new Komodo.ClientActions.CraftingAction;c.Id=a;c.Quantity=b;d.CraftingActions.push(c)};a.processRecipe=function(a,b,c){var f=new Komodo.ClientActions.ProcessingAction;f.Id=a;f.RecipeIndex=b;f.Iterations=c;d.ProcessingActions.push(f)};a.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,c=new Komodo.ClientActions.SocialAction.ChatAction;c.GlobalMessage=a;b.Chat=c;d.SocialActions.push(b)};a.send=k})(Connection||
>>>>>>> 48573a74dbde3044acffad41d7f4206ab30b244e
(Connection={}));
