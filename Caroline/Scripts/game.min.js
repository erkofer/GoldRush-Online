var Utils;
(function(a){a.addEvent=function(a,h,e){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(h,e,!1):a.attachEvent?a.attachEvent("on"+h,e):a["on"+h]=e)};a.cssSwap=function(a,h,e){a.classList.contains(h)&&a.classList.remove(h);a.classList.add(e)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,h){-100!=a&&h()};a.createButton=function(a,h){var e,l;e=document.createElement("div");l=document.createElement("div");l.textContent=a;h&&(l.id=h);e.classList.add("button");
e.appendChild(l);return e};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a){return a?999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.formatTime=function(a){var h=Math.floor(a/3600),e=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>h?1>h?"":"0"+h+":":h+":")+(10>e?"0"+e+":":e+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=
function(a){var h=+a.split(":")[0],e=+a.split(":")[1].split(" ")[0];"PM"==a.split(":")[1].split(" ")[1]&&(h+=12);a=(new Date).getTimezoneOffset();h-=a/60-a%60;e-=a%60;0>h&&(h=24-h);0>e&&(e=60-e,h--);23<h&&(h-=24);59<e&&(e-=60,h++);return(10>h?"0":"")+h+":"+(10>e?"0":"")+e}})(Utils||(Utils={}));var modal;
(function(a){function m(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function h(){if(a.activeWindow){var f=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(f.right-f.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(f.bottom-f.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var e=0,l;a.activeWindow;a.intervalIdentifier;a.hide=m;a.close=function(){if(a.activeWindow){var f=a.activeWindow;m();f.container.parentNode.removeChild(f.container)}};
var k=function(){function f(){this.container=document.createElement("div");this.container.addEventListener("click",function(b){b.stopPropagation()},!1);this.container.classList.add("modal-window");if(!l){var d=document.createElement("div");l=d;d.classList.add("modal-wrapper");d.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-e&&a.close()},!1);document.body.appendChild(d)}l.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(f.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});f.prototype.addElement=function(a){this.bodyEl.appendChild(a)};f.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var c=document.createElement("span");c.textContent=a;b.appendChild(c);this.options.appendChild(b);return b};f.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};f.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};f.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");l.classList.contains("opened")||
l.classList.add("opened");a.activeWindow=this;h();a.intervalIdentifier=setInterval(h,100);e=Date.now()};f.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");l.classList.contains("opened")&&l.classList.remove("opened")};return f}();a.Window=k})(modal||(modal={}));var Objects;
(function(a){var m=[],h=function(){return function(){this.quantity=0}}();a.register=function(a,l){if(!m[a]){var k=new h;k.name=l;m[a]=k}};a.lookupName=function(a){return m[a].name};a.setQuantity=function(a,h){m[a].quantity=h};a.getQuantity=function(a){return m[a].quantity};a.setLifeTimeTotal=function(a,h){m[a].lifeTimeTotal=h};a.getLifeTimeTotal=function(a){return m[a].lifeTimeTotal}})(Objects||(Objects={}));var Account;
(function(a){function m(){b.classList.contains("closed")||b.classList.add("closed")}function h(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var c=document.createElement("DIV");c.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="TEXT";d.maxLength=16;d.placeholder="Username";c.appendChild(d);var g=document.createElement("DIV");g.style.marginBottom="5px";var f=document.createElement("INPUT");f.type="PASSWORD";f.pattern=".{6,}";f.placeholder="Password";
g.appendChild(f);var n=document.createElement("DIV");n.style.marginBottom="5px";var e=document.createElement("INPUT");e.type="CHECKBOX";e.placeholder="Stay logged in on this computer?";n.appendChild(e);a.appendChild(c);a.appendChild(g);a.appendChild(n);p=document.createElement("div");b.addElement(p);b.title="Log in";b.addElement(a);b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(k(d.value,
f.value,e.checked);p.firstChild;)p.removeChild(p.firstChild)},!1);b.show()}function e(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var c=document.createElement("DIV");c.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="TEXT";d.maxLength=16;d.placeholder="Username";c.appendChild(d);var g=document.createElement("DIV");g.style.marginBottom="5px";var f=document.createElement("INPUT");f.type="EMAIL";f.placeholder="Email";g.appendChild(f);var e=document.createElement("DIV");
e.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="PASSWORD";h.pattern=".{6,}";h.placeholder="Password";e.appendChild(h);var k=document.createElement("DIV");k.style.marginBottom="5px";var t=document.createElement("INPUT");t.type="PASSWORD";t.pattern=".{6,}";t.placeholder="Confirm password";k.appendChild(t);t.onblur=function(){h.value!=t.value&&t.setCustomValidity("Passwords are not the same.")};t.onfocus=function(){t.setCustomValidity("")};a.appendChild(c);a.appendChild(g);a.appendChild(e);
a.appendChild(k);b.addElement(a);q=document.createElement("div");b.addElement(q);b.title="Register";b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(l(f.value,d.value,h.value,t.value);q.firstChild;)q.removeChild(q.firstChild)},!1);b.show()}function l(b,a,c,f){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:b,UserName:a,Password:c,ConfirmPassword:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),d(),modal.close();else{for(;q.firstChild;)q.removeChild(q.firstChild);for(var a=0;a<b.Errors.length;a++){var c=document.createElement("div");c.textContent=b.Errors[a];q.appendChild(c)}}}})}function k(b,a,c){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:b,Password:a,RememberMe:c}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),
d(),modal.close();else{for(;p.firstChild;)p.removeChild(p.firstChild);for(var a=0;a<b.Errors.length;a++){var c=document.createElement("div");c.textContent=b.Errors[a];p.appendChild(c)}}}})}function f(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){console.log(b);Connection.restart();d();location.reload()}})}function d(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){console.log(a);a=JSON.parse(a);var c=a.Anonymous;g.textContent=c?"Guest":a.UserName;Utils.cssSwap(b,c?"registered":"anonymous",c?"anonymous":"registered")}})}var b,c,g,q,p,r;(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(r)};b.onmouseleave=function(){r=setTimeout(m,250)};var a=document.createElement("DIV");a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");
a.addEventListener("click",function(){h()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){e()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");
a.addEventListener("click",function(){f()});b.appendChild(a);c=document.createElement("DIV");c.classList.add("account-user");g=document.createElement("SPAN");c.appendChild(g);b.appendChild(c);document.body.appendChild(b);c.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});d()})();a.info=d})(Account||(Account={}));var Rock;
(function(a){function m(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}function h(a,b){a>g&&a<g+64&&b>q&&b<q+64?(r?l(g+2,q+2,60,60):l(g-2,q-2,68,68),p=!0):p&&(l(g,q,64,64),p=!1)}function e(a,b){a!=g&&b!=q&&(g=a,q=b,c?l(a,b,64,64):setTimeout(function(){e(a,b)},10))}function l(a,c,g,e){f.clearRect(0,0,250,250);f.drawImage(d,0,0);f.drawImage(b,a,c,g,e)}var k=document.getElementById("rock"),f=k.getContext("2d"),d=new Image,b=new Image(16,16),c=!1,g=0,q=0,p=!1,r=!1;a.moveRock=
e;(function(){d.onload=function(){f.drawImage(d,0,0);console.log("rock loaded")};d.src="/Content/Rock.png";b.onload=function(){c=!0};b.src="/Content/Stone.png";k.addEventListener("mousemove",function(a){a=m(k,a);h(a.x,a.y)},!1);k.addEventListener("mousedown",function(a){a=m(k,a);r=!0;h(a.x,a.y);Connection.mine(a.x,a.y)},!1);k.addEventListener("mouseup",function(a){a=m(k,a);r=!1;h(a.x,a.y)},!1);k.addEventListener("mouseleave",function(a){a=m(k,a);r=!1;h(a.x,a.y)},!1)})()})(Rock||(Rock={}));var Tabs;
(function(a){function m(){if(k){var b=k.scrollHeight;b>window.innerHeight-a.bottomPadding&&(b=window.innerHeight-a.bottomPadding);e.style.minHeight=b+"px";e.style.maxHeight=b+"px";e.style.overflowY=b>=window.innerHeight-a.bottomPadding?"scroll":"hidden"}}var h=0,e=document.getElementById("paneContainer");a.bottomPadding=200;var l=[],k,f=new (function(){function b(a){this.container=a;this.tabs=[];this.lowestId=0;this.id=h++;l.push(this)}b.prototype.newTab=function(b){var f=new d;f.pane=b;b=document.createElement("DIV");
b.classList.add("tab-button");this.container.appendChild(b);f.button=b;0==this.lowestId?f.activate():f.deactivate();var e=this.lowestId++,h=this.id;b.addEventListener("click",function(){a.activateTab(h,e)});this.tabs.push(f);this.container.appendChild(b);return this.lowestId-1};b.prototype.activate=function(a){for(var b=0;b<this.tabs.length;b++)this.tabs[b].deactivate();this.tabs[a].activate()};b.prototype.css=function(a,b){this.tabs[a].button.classList.add(b)};return b}())(document.getElementById("tabContainer"));
a.registerGameTab=function(a,c){var d=f.newTab(a);c&&f.css(d,c)};a.updateGameTabs=m;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(m,20);a.activateTab=function(a,c){l[a].activate(c);m()};var d=function(){function a(){}a.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};a.prototype.activate=function(){Utils.cssSwap(this.button,"inactive","active");this.pane.style.display="block";this.pane.style.overflow=
"visible";k=this.pane};return a}()})(Tabs||(Tabs={}));var Chat;
(function(a){function m(){if(!e){e=document.createElement("DIV");e.style.transition="all 0.2s";e.id="chatWindow";e.style.position="fixed";e.style.bottom="0px";e.style.left="0px";e.style.minWidth="400px";e.style.width="40%";e.style.backgroundColor="#ebebeb";e.style.border="1px solid #adadad";e.style.height="280px";e.style.boxShadow="1px -1px 2px rgb(200,200,200)";var a=document.createElement("DIV");a.style.position="relative";a.style.height="30px";a.style.backgroundColor="rgb(160, 160, 160)";e.appendChild(a);
var d=document.createElement("DIV");d.textContent="Collapse";d.style.position="absolute";d.style.top="0";d.style.right="0";d.addEventListener("click",function(){var a=document.getElementById("chatWindow");a.style.bottom="0px"==a.style.bottom?"-251px":"0px"});a.appendChild(d);d=document.createElement("DIV");d.style.color="white";d.style.fontSize="18px";d.style.height="30px";d.style.display="inline-block";d.textContent="General";d.style.padding="3px 10px";d.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"none";document.getElementById("chatpane").style.display="block"});a.appendChild(d);d=document.createElement("DIV");d.style.color="white";d.id="debugtab";d.style.fontSize="18px";d.style.height="30px";d.style.display="inline-block";d.textContent=">Dev";d.style.padding="3px 10px";d.addEventListener("click",function(){document.getElementById("debugpane").style.display="block";document.getElementById("chatpane").style.display="none"});d.style.display="none";a.appendChild(d);k=document.createElement("DIV");
k.id="debugpane";k.style.width="100%";k.style.height="230px";k.style.display="none";k.style.position="relative";e.appendChild(k);l=document.createElement("DIV");l.id="chatpane";l.style.width="100%";l.style.height="230px";l.style.position="relative";e.appendChild(l);a=document.createElement("DIV");a.id="debuglog";a.style.position="absolute";a.style.bottom="0px";a.style.maxHeight="230px";a.style.width="100%";a.style.overflow="auto";k.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.style.position=
"absolute";a.style.bottom="0px";a.style.maxHeight="230px";a.style.width="100%";a.style.overflow="auto";l.appendChild(a);a=document.createElement("INPUT");a.setAttribute("TYPE","TEXT");a.style.width="100%";a.style.maxWidth="none";a.style.height="20px";a.style.border="none";a.style.borderTop="1px solid #adadad";a.style.width="85%";a.setAttribute("maxlength","220");a.addEventListener("keydown",function(a){13==a.keyCode&&h();68==a.keyCode&&a.altKey&&(document.getElementById("debugtab").style.display=
"inline-block")});a.id="chattext";e.appendChild(a);a=document.createElement("INPUT");a.setAttribute("TYPE","BUTTON");a.setAttribute("VALUE","SEND");a.style.height="20px";a.style.width="15%";a.style.fontSize="13px";a.style.border="none";a.style.borderTop="1px solid #adadad";a.style.borderLeft="1px solid #adadad";a.addEventListener("click",function(){h()});e.appendChild(a);document.body.appendChild(e)}}function h(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var e,l,k;a.initialize=m;m();a.log=function(a){var d=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;d.appendChild(b)};a.receiveGlobalMessage=function(a,d,b,c){var g=document.getElementById("chatlog"),e=document.createElement("DIV");e.classList.add("chat-msg");c&&""!=c&&e.classList.add("chat-"+c);c=document.createElement("SPAN");c.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");b.textContent=a;b.classList.add("chat-sender");
a=document.createElement("SPAN");a.textContent=d;a.classList.add("chat-text");d=document.createElement("SPAN");d.textContent=": ";e.appendChild(c);e.appendChild(b);e.appendChild(d);e.appendChild(a);g.appendChild(e)}})(Chat||(Chat={}));var tooltip;
(function(a){function m(a,c){var d=b.getBoundingClientRect(),g=d.right-d.left,d=d.bottom-d.top;b.style.left=g+(a+15)>window.innerWidth?a-g-15+"px":a+15+"px";b.style.top=0<c-d?c-d+"px":c+5+"px"}function h(){b&&b.parentElement.removeChild(b);d=b=null}function e(a,b,c){var d=new s;l(a);c&&(d.header=c);d.content=b;f.push(d);a.dataset?a.dataset.tooltip=k:a.setAttribute("data-tooltip",k.toString());k++}function l(a){a.onmouseenter=function(a){var e=+a.target.getAttribute("data-tooltip");r!==a.target&&(c=
setInterval(function(){g+=.01;if(.25<=g){var a=q,k=p,n=f[e];d!==e&&h();d=e;b=n.html;document.body.appendChild(b);m(a,k);g=0;clearInterval(c);c=null}},10));r=a.target};a.onmousemove=function(a){a=a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:a.clientX||a.clientY?{x:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;c||m(a.x,a.y);q=a.x;p=a.y};a.onmouseleave=function(a){r=null;clearInterval(c);g=0;h()}}var k=
0,f=[],d,b,c,g=0,q,p,r,s=function(){function a(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(a.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(a){a.classList.add("tooltip-header");this.html.appendChild(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(a){a.classList.add("tooltip-content");
this.html.appendChild(a)},enumerable:!0,configurable:!0});return a}();a.complexModify=function(a,b,c){a=f[a];c&&(a.header.parentElement.removeChild(a.header),a.header=c);a.content.parentElement.removeChild(a.content);a.content=b};a.modify=function(a,b,c){a=f[a];c&&(a.header.textContent=c);a.content.textContent=b};a.retrieveContent=function(a){return f[a].content};a.complexCreate=e;a.create=function(a,b,c){var d=document.createElement("div");d.textContent=b;c?(b=document.createElement("div"),b.textContent=
c,e(a,d,b)):e(a,d)}})(tooltip||(tooltip={}));var Inventory;
(function(a){function m(a){Connection.sellItem(g.id,a?a:1)}function h(){var b=document.getElementById("selecteditemquantity"),c=+b.value;Utils.isNumber(c)&&c>a.getSelectedItemQuantity()&&(b.value=a.getSelectedItemQuantity().toString())}function e(){f=document.createElement("DIV");document.getElementById("paneContainer").appendChild(f);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var e=document.createElement("SPAN");e.textContent="x";e.style.top="0px";e.style.right=
"3px";e.style.position="absolute";e.addEventListener("click",function(){a.selectItem()});b.appendChild(e);c=document.createElement("DIV");c.classList.add("selected-item-image");e=document.createElement("INPUT");e.id="selecteditemquantity";e.type="text";e.style.height="18px";e.classList.add("selected-item-quantity");e.addEventListener("input",function(){h()});r=Utils.createButton("Drink","");r.classList.add("selected-item-quantity");r.addEventListener("click",function(){Connection.drink(g.id);h()});
var k=Utils.createButton("Sell","");k.classList.add("selected-item-quantity");k.addEventListener("click",function(){var b=+document.getElementById("selecteditemquantity").value;Utils.isNumber(b)&&a.sellSelectedItem(b);h()});var n=Utils.createButton("Sell all","");n.classList.add("selected-item-quantity");n.addEventListener("click",function(){a.sellAllSelectedItem();h()});b.appendChild(c);b.appendChild(n);b.appendChild(k);b.appendChild(r);b.appendChild(e);f.appendChild(b);e=document.createElement("DIV");
e.style.textAlign="center";k=document.createElement("DIV");k.style.display="inline-block";n=Utils.createButton("Sell (...)","");n.addEventListener("click",function(){Connection.sellAllItems()});var l=Utils.createButton("...","");l.addEventListener("click",function(){a.toggleConfig()});k.appendChild(n);k.appendChild(l);e.appendChild(k);f.appendChild(e);p=document.createElement("DIV");p.classList.add("config-container");p.classList.add("closed");e=document.createElement("TABLE");e.classList.add("config-table");
p.appendChild(e);n=e.createTHead();k=n.insertRow(0);n=n.insertRow(0);n.classList.add("table-header");n=n.insertCell(0);n.textContent="Inventory Configuration";n.setAttribute("colspan","10");k.classList.add("table-subheader");for(var m in u)0<=parseInt(m,10)&&"NFS"!=u[m]&&(k.insertCell(k.cells.length).classList.add("config-cell-check"),n=k.insertCell(k.cells.length),n.classList.add("config-cell-name"),n.textContent=u[m]);q=e.createTBody();d=document.createElement("DIV");d.style.position="relative";
d.appendChild(p);f.appendChild(d);Tabs.registerGameTab(f,"Inventory")}function l(a){var b=document.createElement("DIV");a.container=b;b.classList.add("header-item");var c=document.createElement("DIV");c.style.width="32px";c.style.height="32px";c.style.display="inline-block";c.style.position="relative";c.style.margin="0 auto";var d=document.createElement("DIV");d.classList.add("Half-"+a.name.replace(" ","_"));c.appendChild(d);b.appendChild(c);c=document.createElement("DIV");a.quantityElm=c;c.classList.add("item-text");
c.textContent=Utils.formatNumber(0);c.style.verticalAlign="top";c.style.marginTop="8px";c.style.display="inline-block";b.appendChild(c);c=document.createElement("DIV");c.style.display="none";a.worthElm=c;b.appendChild(c);return b}function k(b){if(0==b.category||null==b.category)return l(b);var c=document.createElement("DIV");b.container=c;c.classList.add("item");c.addEventListener("click",function(){a.selectItem(b.id)});tooltip.create(c,b.name);var d=document.createElement("DIV");d.classList.add("item-text");
var g=document.createElement("DIV");g.style.verticalAlign="top";g.style.display="inline-block";g.textContent=Utils.formatNumber(b.worth);b.worthElm=g;var e=document.createElement("DIV");e.classList.add("Quarter-Coins");e.style.display="inline-block";d.appendChild(e);d.appendChild(g);c.appendChild(d);g=document.createElement("DIV");g.style.width="64px";g.style.height="64px";g.style.position="relative";g.style.margin="0 auto";d=document.createElement("DIV");d.classList.add(b.name.replace(" ","_"));
g.appendChild(d);c.appendChild(g);d=document.createElement("DIV");b.quantityElm=d;d.classList.add("item-text");d.textContent=Utils.formatNumber(0);c.appendChild(d);if(null!=b.category){var t,f,g=q.rows.length,d=b.category,d=2*d;d--;for(e=0;e<g;e++){var A=q.rows[e].cells[d];if(A&&0==A.childElementCount){t=q.rows[e].cells[d];f=q.rows[e].cells[d-1];break}}if(!t){f=q.insertRow(q.rows.length);f.classList.add("table-row");for(var h in u)0<=parseInt(h,10)&&"NFS"!=u[h]&&(f.insertCell(f.cells.length).classList.add("config-cell-check"),
f.insertCell(f.cells.length).classList.add("config-cell-name"));t=f.cells[d];f=f.cells[d-1]}h=document.createElement("DIV");h.classList.add("item-text");g=document.createElement("SPAN");g.style.verticalAlign="top";d=document.createElement("DIV");d.classList.add("Third-"+Utils.cssifyName(b.name));d.style.display="inline-block";v[b.id]=d;g.textContent=b.name;s[b.id]=g;h.appendChild(d);h.appendChild(g);t.appendChild(h);t=document.createElement("INPUT");t.type="CHECKBOX";var k=b.id;a.configClickers[k]=
t;t.addEventListener("change",function(b){Connection.configureItem(k,a.configClickers[k].checked)});f.appendChild(t)}return c}a.items=[];a.configClickers=[];var f,d,b,c,g,q,p,r,s=[],v=[],w=function(){return function(a,b,c,d){this.id=a;this.name=b;this.worth=c;this.category=d}}();a.Item=w;(function(a){a[a.NFS=0]="NFS";a[a.ORE=1]="ORE";a[a.GEM=2]="GEM";a[a.INGREDIENT=3]="INGREDIENT";a[a.CRAFTING=4]="CRAFTING";a[a.POTION=5]="POTION"})(a.Category||(a.Category={}));var u=a.Category;a.getSelectedItemQuantity=
function(){return g?g.quantity:0};a.selectItem=function(d){d?(null!=g&&c.classList.remove(Utils.cssifyName(g.name)),g=a.items[d],c.classList.add(Utils.cssifyName(g.name)),r.style.display=5==g.category?"inline-block":"none",h()):(c.classList.remove(Utils.cssifyName(g.name)),g=null);b.style.display=null==g?"none":"block"};a.sellSelectedItem=m;a.sellAllSelectedItem=function(){m(g.quantity)};a.modifyConfig=function(b,c){a.configClickers[b]||console.log(b);a.configClickers[b].checked=c};a.toggleConfig=
function(){p.classList.contains("closed")?p.classList.remove("closed"):p.classList.add("closed")};a.addItem=function(b,c,g,h){a.items[b]||(b=new w(b,c,g,h),a.items[b.id]=b,Objects.register(b.id,b.name),f||e(),0!=b.category&&null!=b.category?d.appendChild(k(b)):document.getElementById("headerInventory").appendChild(k(b)))};a.changePrice=function(b,c){Utils.ifNotDefault(c,function(){var d=a.items[b];d.worth=c;d.worthElm.textContent=Utils.formatNumber(c)})};a.changeQuantity=function(b,c){Utils.ifNotDefault(c,
function(){Objects.setQuantity(b,c);Crafting.update();a.items[b].quantityElm.textContent=Utils.formatNumber(c);a.items[b].quantity=c;a.items[b].container.style.display=0!=a.items[b].category&&null!=a.items[b].category?0==c?"none":"inline-block":0==Objects.getLifeTimeTotal(b)?"none":"inline-block";h()})};a.update=function(){0>=s.length||a.items.forEach(function(a){var b=Objects.getLifeTimeTotal(a.id);s[a.id]&&(s[a.id].textContent=0<b?a.name:"???");v[a.id]&&(v[a.id].style.display=0<b?"inline-block":
"none")})}})(Inventory||(Inventory={}));var Connection;
(function(a){function m(){k.style.top="-21px";console.log("Connection opened");var a=f.encode64();h(a);f=new Komodo.ClientActions;l=setInterval(function(){var a=f.encode64();h(a);f=new Komodo.ClientActions},1E3)}function h(a){if(a.encode64){var b=a.encode64();Chat.log("Sent "+e(b)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+e(a)+" bytes to komodo."),Komodo.send(a)}function e(a){var b=
[];a=[a];for(var c=0;a.length;){var g=a.pop();if("boolean"===typeof g)c+=4;else if("string"===typeof g)c+=2*g.length;else if("number"===typeof g)c+=8;else if("object"===typeof g&&-1===b.indexOf(g)){b.push(g);for(var e in g)a.push(g[e])}}return c}var l,k;(function(){k=document.createElement("div");k.classList.add("network-error");var a=document.createElement("div");a.classList.add("network-error-text");a.textContent="No connection";k.appendChild(a);a=document.getElementById("game");a.insertBefore(k,
a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+e(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));Chat.log(e(JSON.stringify(Komodo.decode(a)))-e(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var b=a.Messages,c=0;c<b.length;c++){var g=b[c];Chat.receiveGlobalMessage(g.Sender,g.Text,g.Time,g.Permissions)}if(null!=a.GameSchema){b=a.GameSchema;if(b.Items)for(c=0;c<b.Items.length;c++)Inventory.addItem(b.Items[c].Id,
b.Items[c].Name,b.Items[c].Worth,b.Items[c].Category),Statistics.addItem(b.Items[c].Id,b.Items[c].Name);if(b.StoreItems)for(c=0;c<b.StoreItems.length;c++)g=b.StoreItems[c],Store.addItem(g.Id,g.Category,g.Price,g.Factor,g.Name,g.MaxQuantity);if(b.Processors)for(c=0;c<b.Processors.length;c++){g=b.Processors[c];Crafting.addProcessor(g.Id,g.Name);for(var f=0;f<g.Recipes.length;f++)Crafting.addProcessorRecipe(g.Id,g.Recipes[f].Ingredients,g.Recipes[f].Resultants)}if(b.CraftingItems)for(c=0;c<b.CraftingItems.length;c++)g=
b.CraftingItems[c],Crafting.addRecipe(g.Id,g.Ingredients,g.Resultants,g.IsItem);if(b.Buffs)for(c=0;c<b.Buffs.length;c++)g=b.Buffs[c],Buffs.register(g.Id,g.Name,g.Description,g.Duration)}if(null!=a.Items)for(b=a.Items,c=0;c<b.length;c++)Inventory.changeQuantity(b[c].Id,b[c].Quantity),Inventory.changePrice(b[c].Id,b[c].Worth);if(null!=a.StoreItemsUpdate)for(b=a.StoreItemsUpdate,c=0;c<b.length;c++)Store.changeQuantity(b[c].Id,b[c].Quantity,b[c].MaxQuantity,b[c].Price);if(null!=a.StatItemsUpdate)for(b=
a.StatItemsUpdate,c=0;c<b.length;c++)Statistics.changeStats(b[c].Id,b[c].PrestigeQuantity,b[c].LifeTimeQuantity);if(null!=a.ConfigItems)for(b=a.ConfigItems,c=0;c<b.length;c++)Inventory.modifyConfig(b[c].Id,b[c].Enabled);if(null!=a.Processors)for(b=a.Processors,c=0;c<b.length;c++)g=b[c],Crafting.updateProcessor(g.Id,g.SelectedRecipe,g.OperationDuration,g.CompletedOperations,g.TotalOperations,g.Capacity);null!=a.AntiCheatCoordinates&&(b=a.AntiCheatCoordinates,Rock.moveRock(b.X,b.Y));if(null!=a.Buffs)for(a=
a.Buffs,b=0;b<a.length;b++)c=a[b],Buffs.update(c.Id,c.TimeActive)});a.restart=function(){Komodo.restart()};var f=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(m(),k.style.marginTop="-21px");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(l),k.style.marginTop="0px");a.newState===$.signalR.connectionState.reconnecting&&(k.style.marginTop="0px")});a.drink=function(a){var b=new Komodo.ClientActions.PotionAction;
b.Id=a;f.PotionActions.push(b)};a.mine=function(a,b){var c=new Komodo.ClientActions.MiningAction;c.X=a;c.Y=b;f.MiningActions.push(c)};a.sellItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,g=new Komodo.ClientActions.InventoryAction.SellAction;g.Id=a;g.Quantity=b;c.Sell=g;f.InventoryActions.push(c)};a.configureItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,g=new Komodo.ClientActions.InventoryAction.ConfigAction;g.Id=a;g.Enabled=b;c.Config=g;f.InventoryActions.push(c)};
a.purchaseItem=function(a,b){var c=new Komodo.ClientActions.StoreAction,g=new Komodo.ClientActions.StoreAction.PurchaseAction;g.Id=a;g.Quantity=b?b:1;c.Purchase=g;f.StoreActions.push(c)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;a.SellAll=!0;f.InventoryActions.push(a)};a.craftRecipe=function(a,b){var c=new Komodo.ClientActions.CraftingAction;c.Id=a;c.Quantity=b;f.CraftingActions.push(c)};a.processRecipe=function(a,b,c){var g=new Komodo.ClientActions.ProcessingAction;
g.Id=a;g.RecipeIndex=b;g.Iterations=c;f.ProcessingActions.push(g)};a.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,c=new Komodo.ClientActions.SocialAction.ChatAction;c.GlobalMessage=a;b.Chat=c;f.SocialActions.push(b)};a.send=h})(Connection||(Connection={}));var Buffs;
(function(a){var m=[],h=document.getElementById("sidebarInformation"),e,l=function(){return function(){}}();a.register=function(a,f,d,b){if(!m[a]){var c=new l;c.name=f;c.description=d;c.duration=b;m[a]=c;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,c.description);f=document.createElement("div");f.textContent=c.name;f.classList.add("buff-header");a.appendChild(f);f=document.createElement("div");f.classList.add("buff-image-container");a.appendChild(f);d=document.createElement("div");
d.classList.add(Utils.cssifyName(c.name));f.appendChild(d);f=document.createElement("div");f.classList.add("buff-header");a.appendChild(f);e.appendChild(a);c.container=a;c.durationElm=f}};a.update=function(a,e){var d=m[a];d.timeActive=e;d.durationElm.textContent="("+Utils.formatTime(d.duration-e)+")";d.container.style.display=0==e?"none":"inline-block"};e=document.createElement("div");h.appendChild(e)})(Buffs||(Buffs={}));var Store;
(function(a){function m(){e=document.createElement("div");document.getElementById("paneContainer").appendChild(e);Tabs.registerGameTab(e,"Store");for(var a in f)if(0<=parseInt(a,10)){var c=f[a];if("CRAFTING"!=c){var g=document.createElement("div");g.classList.add("store-category");k[c]=g;var d=document.createElement("div");d.textContent=c;d.classList.add("store-category-header");g.appendChild(d);e.appendChild(g)}}}function h(a){var c=document.createElement("div");c.classList.add("store-item");a.container=
c;var g=document.createElement("div");g.classList.add("store-item-header");var d=document.createElement("div");d.classList.add("store-item-header-text");d.textContent=a.name;g.appendChild(d);var e=document.createElement("div");e.classList.add("store-item-header-quantity-container");var f=document.createElement("span");f.classList.add("store-item-header-quantity");var h=document.createElement("span");h.classList.add("store-item-header-quantity");var k=document.createElement("span");k.classList.add("store-item-header-quantity");
k.textContent="/";1<a.maxQuantity&&(e.appendChild(h),e.appendChild(k),e.appendChild(f));g.appendChild(e);a.maxQuantityElm=f;a.quantityElm=h;a.nameElm=d;c.appendChild(g);g=document.createElement("DIV");g.style.width="64px";g.style.height="64px";g.style.position="relative";g.style.margin="0 auto";d=document.createElement("DIV");d.classList.add(Utils.cssifyName(a.name));g.appendChild(d);c.appendChild(g);g=document.createElement("div");g.classList.add("store-item-footer");d=document.createElement("div");
d.classList.add("item-text");e=document.createElement("div");e.textContent=Utils.formatNumber(a.price);e.style.display="inline-block";e.style.verticalAlign="top";a.priceElm=e;f=document.createElement("div");f.classList.add("Quarter-Coins");f.style.display="inline-block";d.appendChild(f);d.appendChild(e);var e=document.createElement("div"),f=Utils.createButton("Buy",""),l=a.id;if(5!=a.category)f.addEventListener("click",function(){Connection.purchaseItem(l)});else{var m=document.createElement("INPUT");
m.type="TEXT";m.style.width="40px";m.style.height="15px";e.appendChild(m);f.addEventListener("click",function(){Utils.isNumber(m.value)&&Connection.purchaseItem(l,+m.value)})}e.appendChild(f);g.appendChild(e);g.appendChild(d);c.appendChild(g);return c}var e,l=[],k=[];(function(a){a[a.MINING=1]="MINING";a[a.MACHINES=2]="MACHINES";a[a.GATHERING=3]="GATHERING";a[a.PROCESSING=4]="PROCESSING";a[a.ITEMS=5]="ITEMS";a[a.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category={}));var f=a.Category,d=function(){return function(){}}();
a.tempFix=function(){m()};a.addItem=function(a,c,g,q,p,r){e||m();if(!l[a]){var s=new d;s.id=a;s.category=c;s.price=g;s.factor=q;s.name=p;s.maxQuantity=r?r:0;Objects.register(s.id,s.name);c=k[f[c]];null==c&&(c=k.MINING);6!=s.category&&c.appendChild(h(s));l[a]=s}};a.changeQuantity=function(a,c,d,e){var f=l[a];Utils.ifNotDefault(d,function(){if(0!=d)try{f.maxQuantity=d,f.maxQuantityElm.textContent=d.toString()}catch(a){}});Utils.ifNotDefault(c,function(){Objects.setQuantity(a,c);f.quantity=c;Crafting.update();
0!=d&&6!=f.category&&(f.container.style.display=-1>=f.quantity||f.quantity>=f.maxQuantity&&0<f.maxQuantity?"none":"inline-block",f.maxQuantity&&1<f.maxQuantity&&(f.quantityElm.textContent=c.toString()))});Utils.ifNotDefault(e,function(){f.priceElm&&(f.price=e,f.priceElm.textContent=Utils.formatNumber(e))})}})(Store||(Store={}));var Statistics;
(function(a){function m(){var a=document.createElement("TABLE"),d=a.createTHead(),b=d.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");d=d.insertRow(1);d.classList.add("table-subheader");b=d.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=d.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";d=d.insertCell(0);d.textContent="Item";d.style.width="20%";e=a.createTBody();return a}var h,e,
l=[],k=function(){return function(){}}();a.changeStats=function(a,d,b){var c=l[a];Utils.ifNotDefault(d,function(){c.prestigeQuantity=d;c.prestigeRow.textContent=Utils.formatNumber(d)});Utils.ifNotDefault(b,function(){c.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);c.alltimeRow.textContent=Utils.formatNumber(b)})};a.addItem=function(a,d){h||(h=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(h),Tabs.registerGameTab(h,"Statistics"),h.appendChild(m()));if(!l[a]){var b=
new k;l[a]=b;var c=e.insertRow(e.rows.length);c.classList.add("table-row");b.alltimeRow=c.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=c.insertCell(0);b.prestigeRow.style.width="40%";b=c.insertCell(0);b.style.width="20%";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(d));c.style.display="inline-block";b.appendChild(c)}}})(Statistics||(Statistics={}));var Crafting;
(function(a){function m(){f=document.createElement("DIV");document.getElementById("paneContainer").appendChild(f);Tabs.registerGameTab(f,"Crafting");d=document.createElement("DIV");f.appendChild(d);b=document.createElement("DIV");f.appendChild(b);c=document.createElement("TABLE");c.classList.add("block-table");var a=c.createTHead(),e=a.insertRow(0);e.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=g.length;a.textContent="Crafting Table";
for(a=0;a<g.length;a++){var h=e.insertCell(0);h.style.width=q[a];h.textContent=g[a];"0"!=p[a]&&(h.style.minWidth=p[a])}e=c.insertRow(2);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=g.length;e.textContent="Items";e=c.insertRow(3);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=g.length;e.textContent="Upgrades";b.appendChild(c)}function h(b,c){var d=a.processors[b];if(d){var e=d._recipes[c];for(d.selectedRecipe=c;d.recipeList.lastChild;)d.recipeList.removeChild(d.recipeList.lastChild);
for(var g=0;g<e.ingredients.length;g++){var f=document.createElement("DIV");f.classList.add("item-text");f.style.height="30px";var h=document.createElement("DIV");h.style.display="inline-block";var k=document.createElement("DIV");e.ingredients[g].quantityDiv=k;k.style.display="inline-block";k.style.verticalAlign="super";k.style.color=e.ingredients[g].quantity<=Objects.getQuantity(e.ingredients[g].id)?"darkgreen":"darkred";k.textContent=Utils.formatNumber(e.ingredients[g].quantity);h.classList.add("Half-"+
Utils.cssifyName(Objects.lookupName(e.ingredients[g].id)));f.appendChild(h);f.appendChild(k);d.recipeList.appendChild(f)}}}function e(a){var b=document.createElement("TABLE");b.classList.add("block-table");var c=b.createTHead(),e=c.insertRow(0);e.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=g.length;c.textContent=a.name;for(c=0;c<g.length;c++){var f=e.insertCell(0);f.style.width=s[c];f.textContent=r[c];"0"!=s[c]&&(f.style.minWidth=v[c])}c=
b.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=r.length;f=document.createElement("DIV");f.classList.add("progress-bar-container");e=document.createElement("DIV");e.classList.add("progress-bar");var k=document.createElement("DIV");k.classList.add("progress-bar-text-container");var m=document.createElement("DIV");m.classList.add("progress-bar-text");k.appendChild(m);f.appendChild(k);a.progressBar=e;a.progressText=m;f.appendChild(e);c.appendChild(f);e=b.insertRow(3);e.classList.add("table-row");
for(c=0;c<r.length;c++){f=e.insertCell(0);f.style.width=q[c];f.style.height="75px";"0"!=v[c]&&(f.style.minWidth=v[c]);"Image"==r[c]&&(k=document.createElement("DIV"),k.classList.add(Utils.cssifyName(a.name)),k.style.margin="0 auto",f.appendChild(k));"Capacity"==r[c]&&(f.textContent="0",a.capacityElm=f);"Input"==r[c]&&(a.recipeList=f);if("Output"==r[c]){k=Utils.createButton("Max","");f.appendChild(k);k=document.createElement("INPUT");k.type="TEXT";k.style.width="35px";a.quantityTextbox=k;f.appendChild(k);
var p=a.id,n=document.createElement("SELECT");n.addEventListener("change",function(a){h(p,n.selectedIndex)});a.recipeSelector=n;f.appendChild(n)}"Action"==r[c]&&(k=Utils.createButton("Activate",""),k.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),f.appendChild(k))}l(a);d.appendChild(b)}function l(a){y||(y=document.createElement("div"),B.appendChild(y));var b=document.createElement("div");
b.classList.add("processor-sidebar");a.sidebarContainer=b;var c=document.createElement("div");c.classList.add("buff-header");c.textContent=a.name;b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");var e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarProgressBar=e;var d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarProgressText=d;c.appendChild(d);c.appendChild(e);
b.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar");a.sidebarJobBar=e;d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");a.sidebarJobText=d;c.appendChild(d);c.appendChild(e);b.appendChild(c);b.style.display="none";y.appendChild(b)}function k(a,b){var e=c.rows.length;b&&(e=w,w++);e=c.insertRow(e);e.classList.add("table-row");a.row=
e;for(var d=0;d<g.length;d++){var f=e.insertCell(0);f.style.width=q[d];"0"!=p[d]&&(f.style.minWidth=p[d]);"Name"==g[d]&&(f.textContent=Objects.lookupName(a.id));if("Input"==g[d])for(var h=0;h<a.ingredients.length;h++){var k=document.createElement("DIV");k.classList.add("item-text");k.style.height="22px";var m=document.createElement("DIV");m.style.display="inline-block";var l=document.createElement("DIV");a.ingredients[h].quantityDiv=l;l.style.display="inline-block";l.style.verticalAlign="super";l.textContent=
Utils.formatNumber(a.ingredients[h].quantity);m.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.ingredients[h].id)));k.appendChild(m);k.appendChild(l);f.appendChild(k)}if("Output"==g[d])for(h=0;h<a.resultants.length;h++)k=document.createElement("DIV"),k.classList.add("item-text"),k.style.height="22px",m=document.createElement("DIV"),m.style.display="inline-block",l=document.createElement("DIV"),l.style.display="inline-block",l.style.verticalAlign="super",l.textContent=Utils.formatNumber(a.resultants[h].quantity),
m.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.resultants[h].id))),k.appendChild(m),a.isItem&&k.appendChild(l),f.appendChild(k);if("Action"==g[d]&&(h=Utils.createButton("Craft",""),h.addEventListener("click",function(){Connection.craftRecipe(a.id,1)},!1),f.appendChild(h),a.isItem)){var n=document.createElement("INPUT");n.type="TEXT";n.style.width="30px";h=Utils.createButton("Craft-x","");h.addEventListener("click",function(){Connection.craftRecipe(a.id,+n.value)},!1);f.appendChild(h);
f.appendChild(n)}}}var f,d,b,c,g=["Action","Description","Input","Output","Name"],q=["10%","50%","15%","15%","10%"],p=["170px","0","0","0","0"],r=["Action","Output","Input","Capacity","Image"],s=["10%","30%","20%","20%","20%"],v=["170px","0","0","0","0"],w=3,u=[];a.processors=[];var B=document.getElementById("sidebarInformation"),y,n=function(){function a(){this._recipes=[]}a.prototype.addRecipe=function(a){this._recipes.push(a);this.selectedRecipe||(this.selectedRecipe=0)};return a}();a.Processor=
n;var z=function(){function a(){this.ingredients=[];this.resultants=[]}a.prototype.addIngredient=function(a){this.ingredients.push(a)};a.prototype.addResultant=function(a){this.resultants.push(a)};return a}();a.Recipe=z;var x=function(){return function(a,b){this.id=a;this.quantity=b}}();a.Ingredient=x;a.addRecipe=function(a,b,c,e){f||m();if(!u[a]){var d=new z;d.id=a;d.isItem=e;u[a]=d;for(a=0;a<b.length;a++)d.addIngredient(new x(b[a].Id,b[a].Quantity));for(a=0;a<c.length;a++)d.addResultant(new x(c[a].Id,
c[a].Quantity));k(d,e)}};a.addProcessor=function(b,c){f||m();if(!a.processors[b]){var d=new n;d.id=b;d.name=c;a.processors[b]=d;e(d)}};a.addProcessorRecipe=function(b,c,d){if(a.processors[b]){var e=a.processors[b],f;a:if(a.processors[b]){f=a.processors[b];for(var g=0;g<f._recipes.length;g++)if(d[0].Id==f._recipes[g].resultants[0].id){f=!0;break a}f=!1}else f=void 0;if(!f){f=new z;for(g=0;g<c.length;g++)f.addIngredient(new x(c[g].Id,c[g].Quantity));for(g=0;g<d.length;g++)f.addResultant(new x(d[g].Id,
d[g].Quantity));e.addRecipe(f);c=document.createElement("OPTION");c.textContent=Objects.lookupName(d[0].Id);e.recipeSelector.appendChild(c);1==e._recipes.length&&h(b,0)}}};a.updateProcessor=function(b,c,d,e,f,g){var h=a.processors[b];if(h){var k=!1;Utils.ifNotDefault(c,function(){h.selectedRecipe=c});Utils.ifNotDefault(f,function(){h.totalOperations=f;k=!0});Utils.ifNotDefault(d,function(){h.operationDuration=d});Utils.ifNotDefault(g,function(){h.capacityElm.textContent=g.toString()});Utils.ifNotDefault(e,
function(){h.completedOperations=e;k=!0});if(k){if(0>=h.totalOperations||h.completedOperations==h.totalOperations){h.progressBar.style.width="0%";h.progressText.textContent="";h.sidebarProgressText.textContent="";h.sidebarContainer.style.display="none";h.totalOperationCompletionTime=0;return}h.sidebarContainer.style.display="inline-block";h.operationStartTime=Date.now();h.operationCompletionTime=h.operationStartTime+1E3*h.operationDuration;0==h.totalOperationCompletionTime&&(h.totalOperationCompletionTime=
h.operationStartTime+1E3*h.operationDuration*(h.totalOperations-h.completedOperations))}if(-1<h.selectedRecipe)try{h.progressText.textContent=Objects.lookupName(h._recipes[h.selectedRecipe].resultants[0].id)+" ("+h.completedOperations+"/"+h.totalOperations+")",h.sidebarJobText.textContent=Objects.lookupName(h._recipes[h.selectedRecipe].resultants[0].id)+" ("+h.completedOperations+"/"+h.totalOperations+")"}catch(l){console.log("invalid processor recipe "+h.selectedRecipe)}else h.progressText.textContent=
"",h.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(a){if(0>=a.operationDuration)a.progressBar.style.width="0%";else if(a.completedOperations!=a.totalOperations&&0<a.totalOperations){var b=a.operationCompletionTime-Date.now(),b=b/1E3,c=a.totalOperationCompletionTime-Date.now(),d=c/(a.operationDuration*a.totalOperations),b=b/a.operationDuration,b=100-100*b;a.progressBar.style.width=b+"%";a.sidebarJobBar.style.width=b+"%";a.sidebarProgressBar.style.width=100-
d/10+"%";a.sidebarProgressText.textContent=Utils.formatTime(c/1E3)}})},10);a.update=function(){f&&(u.forEach(function(a){var b=Objects.getQuantity(a.id);a.row.style.display=-1==b||!a.isItem&&0<b?"none":"";a.ingredients.forEach(function(a){var b=Objects.getQuantity(a.id);a.quantityDiv.style.color=b>=a.quantity?"darkgreen":"darkred"})}),a.processors.forEach(function(a){h(a.id,a.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));
