var Utils;
(function(a){a.addEvent=function(a,g,e){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(g,e,!1):a.attachEvent?a.attachEvent("on"+g,e):a["on"+g]=e)};a.cssSwap=function(a,g,e){a.classList.contains(g)&&a.classList.remove(g);a.classList.add(e)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,g){-100!=a&&g()};a.createButton=function(a,g){var e,l;e=document.createElement("div");l=document.createElement("div");l.textContent=a;g&&(l.id=g);e.classList.add("button");
e.appendChild(l);return e};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a,g){"undefined"===typeof g&&(g=!1);return a?g?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.formatTime=function(a){var g=Math.floor(a/3600),e=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>
g?1>g?"":"0"+g+":":g+":")+(10>e?"0"+e+":":e+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=function(a){var g=+a.split(":")[0],e=+a.split(":")[1].split(" ")[0];"PM"==a.split(":")[1].split(" ")[1]&&(g+=12);a=(new Date).getTimezoneOffset();g-=a/60-a%60;e-=a%60;0>g&&(g=24-g);0>e&&(e=60-e,g--);23<g&&(g-=24);59<e&&(e-=60,g++);return(10>g?"0":"")+g+":"+(10>e?"0":"")+e}})(Utils||(Utils={}));var modal;
(function(a){function n(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function g(){if(a.activeWindow){var h=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(h.right-h.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(h.bottom-h.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var e=0,l;a.activeWindow;a.intervalIdentifier;a.hide=n;a.close=function(){if(a.activeWindow){var h=a.activeWindow;n();h.container.parentNode.removeChild(h.container)}};
var k=function(){function h(){this.container=document.createElement("div");this.container.addEventListener("click",function(a){a.stopPropagation()},!1);this.container.classList.add("modal-window");if(!l){var h=document.createElement("div");l=h;h.classList.add("modal-wrapper");h.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-e&&a.close()},!1);document.body.appendChild(h)}l.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(h.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});h.prototype.addElement=function(a){this.bodyEl.appendChild(a)};h.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var c=document.createElement("span");c.textContent=a;b.appendChild(c);this.options.appendChild(b);return b};h.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};h.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};h.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");l.classList.contains("opened")||
l.classList.add("opened");a.activeWindow=this;g();a.intervalIdentifier=setInterval(g,100);e=Date.now()};h.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");l.classList.contains("opened")&&l.classList.remove("opened")};return h}();a.Window=k})(modal||(modal={}));var Objects;
(function(a){var n=[],g=function(){return function(){this.quantity=0}}();a.register=function(a,l){if(!n[a]){var k=new g;k.name=l;n[a]=k}};a.lookupName=function(a){return n[a].name};a.setQuantity=function(a,g){n[a].quantity=g};a.getQuantity=function(a){return n[a].quantity};a.setLifeTimeTotal=function(a,g){n[a].lifeTimeTotal=g};a.getLifeTimeTotal=function(a){return n[a].lifeTimeTotal}})(Objects||(Objects={}));var Account;
(function(a){function n(){b.classList.contains("closed")||b.classList.add("closed")}function g(){var a=new modal.Window,c=document.createElement("DIV");c.style.width="400px";var d=document.createElement("DIV");d.style.marginBottom="5px";var b=document.createElement("INPUT");b.type="TEXT";b.maxLength=16;b.placeholder="Username";d.appendChild(b);var p=document.createElement("DIV");p.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="PASSWORD";h.pattern=".{6,}";h.placeholder="Password";
p.appendChild(h);var g=document.createElement("DIV");g.style.marginBottom="5px";var e=document.createElement("INPUT");e.type="CHECKBOX";e.placeholder="Stay logged in on this computer?";g.appendChild(e);c.appendChild(d);c.appendChild(p);c.appendChild(g);f=document.createElement("div");a.addElement(f);a.title="Log in";a.addElement(c);a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(k(b.value,
h.value,e.checked);f.firstChild;)f.removeChild(f.firstChild)},!1);a.show()}function e(){var a=new modal.Window,c=document.createElement("DIV");c.style.width="400px";var b=document.createElement("DIV");b.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="TEXT";d.maxLength=16;d.placeholder="Username";b.appendChild(d);var f=document.createElement("DIV");f.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="EMAIL";h.placeholder="Email";f.appendChild(h);var g=document.createElement("DIV");
g.style.marginBottom="5px";var e=document.createElement("INPUT");e.type="PASSWORD";e.pattern=".{6,}";e.placeholder="Password";g.appendChild(e);var t=document.createElement("DIV");t.style.marginBottom="5px";var u=document.createElement("INPUT");u.type="PASSWORD";u.pattern=".{6,}";u.placeholder="Confirm password";t.appendChild(u);u.onblur=function(){e.value!=u.value&&u.setCustomValidity("Passwords are not the same.")};u.onfocus=function(){u.setCustomValidity("")};c.appendChild(b);c.appendChild(f);c.appendChild(g);
c.appendChild(t);a.addElement(c);p=document.createElement("div");a.addElement(p);a.title="Register";a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(l(h.value,d.value,e.value,u.value);p.firstChild;)p.removeChild(p.firstChild)},!1);a.show()}function l(a,c,d,b){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:a,UserName:c,Password:d,ConfirmPassword:b}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),m(),modal.close();else{for(;p.firstChild;)p.removeChild(p.firstChild);for(var c=0;c<a.Errors.length;c++){var d=document.createElement("div");d.textContent=a.Errors[c];p.appendChild(d)}}}})}function k(a,c,d){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:a,Password:c,RememberMe:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),
m(),modal.close();else{for(;f.firstChild;)f.removeChild(f.firstChild);for(var c=0;c<a.Errors.length;c++){var d=document.createElement("div");d.textContent=a.Errors[c];f.appendChild(d)}}}})}function h(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){console.log(a);Connection.restart();m();location.reload()}})}function m(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);var c=a.Anonymous;d.textContent=c?"Guest":a.UserName;Utils.cssSwap(b,c?"registered":"anonymous",c?"anonymous":"registered")}})}var b,c,d,p,f,q,s=function(){function a(){}a.prototype.failed=function(a){this.resultsElement.textContent="Loading failed..."};a.prototype.succeeded=function(a){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var c=document.createElement("table"),d=c.createTHead().insertRow(0);d.classList.add("table-subheader");
var b=d.insertCell(0);b.textContent="Score";b.style.width="65%";b=d.insertCell(0);b.textContent="Name";b.style.width="25%";d=d.insertCell(0);d.textContent="Rank";d.style.width="10%";for(var d=c.createTBody(),p=0;p<a.length;p++){var f=a[p];console.log(f);var h=d.insertRow(d.rows.length);h.classList.add("table-row");var t=h.insertCell(0);t.textContent=Utils.formatNumber(f.Score);t.style.width="65%";t.addEventListener("click",function(a){var c=a.target;a=c.dataset?c.dataset.tooltip:c.getAttribute("data-tooltip");
0<c.textContent.indexOf(",")?c.textContent=Utils.formatNumber(a):c.textContent=Utils.formatNumber(a,!0)});t.dataset?t.dataset.tooltip=f.Score:t.setAttribute("data-tooltip",f.Score.toString());h.insertCell(0).textContent=f.UserId;b.style.width="25%";h=h.insertCell(0);h.textContent=Utils.formatNumber(f.Rank);h.style.width="10%"}this.resultsElement.appendChild(c)};a.prototype.sendRequest=function(a,c){var d=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:a,Upper:c}),
headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);d.succeeded(a)},failure:function(a){d.failed(a)}})};return a}();(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(q)};b.onmouseleave=function(){q=setTimeout(n,250)};var a=document.createElement("DIV");a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",
function(){g()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){e()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");
a.addEventListener("click",function(){h()});b.appendChild(a);c=document.createElement("DIV");c.classList.add("account-user");d=document.createElement("SPAN");c.appendChild(d);b.appendChild(c);document.body.appendChild(b);c.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});a=document.createElement("SPAN");a.textContent="Leaderboards";a.addEventListener("click",function(){var a=new modal.Window;a.title="Leaderboards";var c=document.createElement("DIV");
c.style.width="400px";c.textContent="Loading...";a.addElement(c);var d=new s;d.resultsElement=c;d.sendRequest(0,19);a.show()});document.getElementsByClassName("header-links")[0].appendChild(a);m()})();a.info=m})(Account||(Account={}));var Rock;
(function(a){function n(a,c){var d=a.getBoundingClientRect();return{x:c.clientX-d.left,y:c.clientY-d.top}}function g(a,c){a>d&&a<d+64&&c>p&&c<p+64?(q?l(d+2,p+2,60,60):l(d-2,p-2,68,68),f=!0):f&&(l(d,p,64,64),f=!1)}function e(a,b){a!=d&&b!=p&&(d=a,p=b,c?l(a,b,64,64):setTimeout(function(){e(a,b)},10))}function l(a,c,d,p){h.clearRect(0,0,250,250);h.drawImage(m,0,0);h.drawImage(b,a,c,d,p)}var k=document.getElementById("rock"),h=k.getContext("2d"),m=new Image,b=new Image(16,16),c=!1,d=0,p=0,f=!1,q=!1;a.moveRock=
e;(function(){m.onload=function(){h.drawImage(m,0,0);console.log("rock loaded")};m.src="/Content/Rock.png";b.onload=function(){c=!0};b.src="/Content/Stone.png";k.addEventListener("mousemove",function(a){a=n(k,a);g(a.x,a.y)},!1);k.addEventListener("mousedown",function(a){a=n(k,a);q=!0;g(a.x,a.y);Connection.mine(a.x,a.y)},!1);k.addEventListener("mouseup",function(a){a=n(k,a);q=!1;g(a.x,a.y)},!1);k.addEventListener("mouseleave",function(a){a=n(k,a);q=!1;g(a.x,a.y)},!1)})()})(Rock||(Rock={}));var Tabs;
(function(a){function n(){if(k){var b=k.scrollHeight;b>window.innerHeight-a.bottomPadding&&(b=window.innerHeight-a.bottomPadding);e.style.minHeight=b+"px";e.style.maxHeight=b+"px";e.style.overflowY=b>=window.innerHeight-a.bottomPadding?"scroll":"hidden"}}var g=0,e=document.getElementById("paneContainer");a.bottomPadding=200;var l=[],k,h=new (function(){function b(a){this.container=a;this.tabs=[];this.lowestId=0;this.id=g++;l.push(this)}b.prototype.newTab=function(c){var d=new m;d.pane=c;c=document.createElement("DIV");
c.classList.add("tab-button");this.container.appendChild(c);d.button=c;0==this.lowestId?d.activate():d.deactivate();var b=this.lowestId++,f=this.id;c.addEventListener("click",function(){a.activateTab(f,b)});this.tabs.push(d);this.container.appendChild(c);return this.lowestId-1};b.prototype.activate=function(a){for(var d=0;d<this.tabs.length;d++)this.tabs[d].deactivate();this.tabs[a].activate()};b.prototype.css=function(a,d){this.tabs[a].button.classList.add(d)};return b}())(document.getElementById("tabContainer"));
a.registerGameTab=function(a,c){var d=h.newTab(a);c&&h.css(d,c)};a.updateGameTabs=n;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(n,20);a.activateTab=function(a,c){l[a].activate(c);n()};var m=function(){function a(){}a.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};a.prototype.activate=function(){Utils.cssSwap(this.button,"inactive","active");this.pane.style.display="block";this.pane.style.overflow=
"visible";k=this.pane};return a}()})(Tabs||(Tabs={}));var Chat;
(function(a){function n(){if(!e){e=document.createElement("DIV");e.classList.add("chat-window");e.classList.add("social");e.id="chatWindow";e.style.backgroundColor="#ebebeb";e.style.border="1px solid #adadad";var a=document.createElement("DIV");a.classList.add("chat-header");a.style.backgroundColor="rgb(160, 160, 160)";e.appendChild(a);var m=document.createElement("DIV");m.textContent="_";m.style.position="absolute";m.style.top="0";m.style.right="0";m.addEventListener("click",function(){e.classList.contains("closed")?
(e.classList.remove("closed"),m.textContent="_"):(e.classList.add("closed"),m.textContent="+")});a.appendChild(m);var b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent="General";b.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});a.appendChild(b);b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent=">Dev";b.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});b.style.display="none";a.appendChild(b);k=document.createElement("DIV");k.id="debugpane";k.classList.add("chat-room");k.style.display="none";e.appendChild(k);l=document.createElement("DIV");l.id="chatpane";l.classList.add("chat-room");e.appendChild(l);a=document.createElement("DIV");a.id="debuglog";a.classList.add("chat-room-content");k.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.classList.add("chat-room-content");
l.appendChild(a);a=document.createElement("DIV");b=document.createElement("DIV");b.classList.add("chat-textbox-container");var c=document.createElement("INPUT");c.setAttribute("TYPE","TEXT");c.classList.add("chat-textbox");c.style.borderTop="1px solid #adadad";c.setAttribute("maxlength","220");c.addEventListener("keydown",function(a){13==a.keyCode&&g();68==a.keyCode&&a.altKey&&(document.getElementById("debugtab").style.display="inline-block")});c.id="chattext";b.appendChild(c);a.appendChild(b);b=
document.createElement("DIV");b.classList.add("chat-submit-container");c=document.createElement("INPUT");c.setAttribute("TYPE","BUTTON");c.setAttribute("VALUE","SEND");c.classList.add("chat-submit");c.style.borderTop="1px solid #adadad";c.style.borderLeft="1px solid #adadad";c.addEventListener("click",function(){g()});b.appendChild(c);a.appendChild(b);e.appendChild(a);document.body.appendChild(e)}}function g(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var e,l,k;a.initialize=n;n();a.log=function(a){var e=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;e.appendChild(b)};a.receiveGlobalMessage=function(a,e,b,c){var d=document.getElementById("chatlog"),p=5>Math.abs(d.scrollTop-(d.scrollHeight-d.offsetHeight)),f=document.createElement("DIV");f.classList.add("chat-msg");c&&""!=c&&f.classList.add("chat-"+c);c=document.createElement("SPAN");c.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");
b.textContent=a;b.classList.add("chat-sender");a=document.createElement("SPAN");a.textContent=e;a.classList.add("chat-text");e=document.createElement("SPAN");e.textContent=": ";f.appendChild(c);f.appendChild(b);f.appendChild(e);f.appendChild(a);d.appendChild(f);p&&(d.scrollTop=d.scrollHeight)}})(Chat||(Chat={}));var tooltip;
(function(a){function n(a,c){var d=b.getBoundingClientRect(),p=d.right-d.left,d=d.bottom-d.top;b.style.left=p+(a+15)>window.innerWidth?a-p-15+"px":a+15+"px";b.style.top=0<c-d?c-d+"px":c+5+"px"}function g(){b&&b.parentElement.removeChild(b);m=b=null}function e(a,c,d){var b=new s;l(a);d&&(b.header=d);b.content=c;h.push(b);a.dataset?a.dataset.tooltip=k:a.setAttribute("data-tooltip",k.toString());k++}function l(a){a.onmouseenter=function(a){var e=+a.target.getAttribute("data-tooltip");q!==a.target&&(c=
setInterval(function(){d+=.01;if(.25<=d){var a=p,k=f,r=h[e];m!==e&&g();m=e;b=r.html;document.body.appendChild(b);n(a,k);d=0;clearInterval(c);c=null}},10));q=a.target};a.onmousemove=function(a){a=a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:a.clientX||a.clientY?{x:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;c||n(a.x,a.y);p=a.x;f=a.y};a.onmouseleave=function(a){q=null;clearInterval(c);d=0;g()}}var k=
0,h=[],m,b,c,d=0,p,f,q,s=function(){function a(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(a.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(a){a.classList.add("tooltip-header");this.html.appendChild(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(a){a.classList.add("tooltip-content");
this.html.appendChild(a)},enumerable:!0,configurable:!0});return a}();a.complexModify=function(a,c,d){a=h[a];d&&(a.header.parentElement.removeChild(a.header),a.header=d);a.content.parentElement.removeChild(a.content);a.content=c};a.modify=function(a,c,d){a=h[a];d&&(a.header.textContent=d);a.content.textContent=c};a.retrieveContent=function(a){return h[a].content};a.complexCreate=e;a.create=function(a,c,d){var b=document.createElement("div");b.textContent=c;d?(c=document.createElement("div"),c.textContent=
d,e(a,b,c)):e(a,b)}})(tooltip||(tooltip={}));var Inventory;
(function(a){function n(a){Connection.sellItem(d.id,a?a:1)}function g(){var c=document.getElementById("selecteditemquantity"),d=+c.value;Utils.isNumber(d)&&d>a.getSelectedItemQuantity()&&(c.value=a.getSelectedItemQuantity().toString())}function e(){h=document.createElement("DIV");document.getElementById("paneContainer").appendChild(h);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var e=document.createElement("SPAN");e.textContent="x";e.style.top="0px";e.style.right=
"3px";e.style.position="absolute";e.addEventListener("click",function(){a.selectItem()});b.appendChild(e);c=document.createElement("DIV");c.classList.add("selected-item-image");e=document.createElement("INPUT");e.id="selecteditemquantity";e.type="text";e.style.height="18px";e.classList.add("selected-item-quantity");e.addEventListener("input",function(){g()});q=Utils.createButton("Drink","");q.classList.add("selected-item-quantity");q.addEventListener("click",function(){Connection.drink(d.id);g()});
var k=Utils.createButton("Sell","");k.classList.add("selected-item-quantity");k.addEventListener("click",function(){var c=+document.getElementById("selecteditemquantity").value;Utils.isNumber(c)&&a.sellSelectedItem(c);g()});var r=Utils.createButton("Sell all","");r.classList.add("selected-item-quantity");r.addEventListener("click",function(){a.sellAllSelectedItem();g()});b.appendChild(c);b.appendChild(r);b.appendChild(k);b.appendChild(q);b.appendChild(e);h.appendChild(b);e=document.createElement("DIV");
e.style.textAlign="center";k=document.createElement("DIV");k.style.display="inline-block";r=Utils.createButton("Sell (...)","");r.addEventListener("click",function(){Connection.sellAllItems()});var l=Utils.createButton("...","");l.addEventListener("click",function(){a.toggleConfig()});k.appendChild(r);k.appendChild(l);e.appendChild(k);h.appendChild(e);f=document.createElement("DIV");f.classList.add("config-container");f.classList.add("closed");e=document.createElement("TABLE");e.classList.add("config-table");
f.appendChild(e);r=e.createTHead();k=r.insertRow(0);r=r.insertRow(0);r.classList.add("table-header");r=r.insertCell(0);r.textContent="Inventory Configuration";r.setAttribute("colspan","10");k.classList.add("table-subheader");for(var n in v)0<=parseInt(n,10)&&"NFS"!=v[n]&&(k.insertCell(k.cells.length).classList.add("config-cell-check"),r=k.insertCell(k.cells.length),r.classList.add("config-cell-name"),r.textContent=v[n]);p=e.createTBody();m=document.createElement("DIV");m.style.position="relative";
m.appendChild(f);h.appendChild(m);Tabs.registerGameTab(h,"Inventory")}function l(a){var c=document.createElement("DIV");a.container=c;c.classList.add("header-item");var d=document.createElement("DIV");d.style.width="32px";d.style.height="32px";d.style.display="inline-block";d.style.position="relative";d.style.margin="0 auto";var b=document.createElement("DIV");b.classList.add("Half-"+a.name.replace(" ","_"));d.appendChild(b);c.appendChild(d);d=document.createElement("DIV");a.quantityElm=d;d.classList.add("item-text");
d.textContent=Utils.formatNumber(0);d.style.verticalAlign="top";d.style.marginTop="8px";d.style.display="inline-block";c.appendChild(d);d=document.createElement("DIV");d.style.display="none";a.worthElm=d;c.appendChild(d);return c}function k(c){if(0==c.category||null==c.category)return l(c);var d=document.createElement("DIV");c.container=d;d.classList.add("item");d.addEventListener("click",function(){a.selectItem(c.id)});tooltip.create(d,c.name);var b=document.createElement("DIV");b.classList.add("item-text");
var f=document.createElement("DIV");f.style.verticalAlign="top";f.style.display="inline-block";f.textContent=Utils.formatNumber(c.worth);c.worthElm=f;var e=document.createElement("DIV");e.classList.add("Quarter-Coins");e.style.display="inline-block";b.appendChild(e);b.appendChild(f);d.appendChild(b);f=document.createElement("DIV");f.style.width="64px";f.style.height="64px";f.style.position="relative";f.style.margin="0 auto";b=document.createElement("DIV");b.classList.add(c.name.replace(" ","_"));
f.appendChild(b);d.appendChild(f);b=document.createElement("DIV");c.quantityElm=b;b.classList.add("item-text");b.textContent=Utils.formatNumber(0);d.appendChild(b);if(null!=c.category){var t,h,f=p.rows.length,b=c.category,b=2*b;b--;for(e=0;e<f;e++){var B=p.rows[e].cells[b];if(B&&0==B.childElementCount){t=p.rows[e].cells[b];h=p.rows[e].cells[b-1];break}}if(!t){h=p.insertRow(p.rows.length);h.classList.add("table-row");for(var g in v)0<=parseInt(g,10)&&"NFS"!=v[g]&&(h.insertCell(h.cells.length).classList.add("config-cell-check"),
h.insertCell(h.cells.length).classList.add("config-cell-name"));t=h.cells[b];h=h.cells[b-1]}g=document.createElement("DIV");g.classList.add("item-text");g.style.height="auto";f=document.createElement("SPAN");f.style.verticalAlign="top";b=document.createElement("DIV");b.classList.add("Third-"+Utils.cssifyName(c.name));b.style.display="inline-block";w[c.id]=b;f.textContent=c.name;s[c.id]=f;g.appendChild(b);g.appendChild(f);t.appendChild(g);t=document.createElement("INPUT");t.type="CHECKBOX";var k=c.id;
a.configClickers[k]=t;t.addEventListener("change",function(c){Connection.configureItem(k,a.configClickers[k].checked)});h.appendChild(t)}return d}a.items=[];a.configClickers=[];var h,m,b,c,d,p,f,q,s=[],w=[],x=function(){return function(a,c,d,b){this.id=a;this.name=c;this.worth=d;this.category=b}}();a.Item=x;(function(a){a[a.NFS=0]="NFS";a[a.ORE=1]="ORE";a[a.GEM=2]="GEM";a[a.INGREDIENT=3]="INGREDIENT";a[a.CRAFTING=4]="CRAFTING";a[a.POTION=5]="POTION"})(a.Category||(a.Category={}));var v=a.Category;
a.getSelectedItemQuantity=function(){return d?d.quantity:0};a.selectItem=function(f){f?(null!=d&&c.classList.remove(Utils.cssifyName(d.name)),d=a.items[f],c.classList.add(Utils.cssifyName(d.name)),q.style.display=5==d.category?"inline-block":"none",g()):(c.classList.remove(Utils.cssifyName(d.name)),d=null);b.style.display=null==d?"none":"block"};a.sellSelectedItem=n;a.sellAllSelectedItem=function(){n(d.quantity)};a.modifyConfig=function(c,d){a.configClickers[c]||console.log(c);a.configClickers[c].checked=
d};a.toggleConfig=function(){f.classList.contains("closed")?f.classList.remove("closed"):f.classList.add("closed")};a.addItem=function(c,d,b,f){a.items[c]||(c=new x(c,d,b,f),a.items[c.id]=c,Objects.register(c.id,c.name),h||e(),0!=c.category&&null!=c.category?m.appendChild(k(c)):document.getElementById("headerInventory").appendChild(k(c)))};a.changePrice=function(c,d){Utils.ifNotDefault(d,function(){var b=a.items[c];b.worth=d;b.worthElm.textContent=Utils.formatNumber(d)})};a.changeQuantity=function(c,
d){Utils.ifNotDefault(d,function(){Objects.setQuantity(c,d);Crafting.update();a.items[c].quantityElm.textContent=Utils.formatNumber(d);a.items[c].quantity=d;a.items[c].container.style.display=0!=a.items[c].category&&null!=a.items[c].category?0==d?"none":"inline-block":0==Objects.getLifeTimeTotal(c)?"none":"inline-block";g()})};a.update=function(){0>=s.length||a.items.forEach(function(a){var c=Objects.getLifeTimeTotal(a.id);s[a.id]&&(s[a.id].textContent=0<c?a.name:"???");w[a.id]&&(w[a.id].style.display=
0<c?"inline-block":"none")})}})(Inventory||(Inventory={}));var Connection;
(function(a){function n(){console.log("Connection opened");var a=b.encode64();g(a);b=new Komodo.ClientActions;l=setInterval(function(){var a=b.encode64();g(a);b=new Komodo.ClientActions},1E3)}function g(a){if(a.encode64){var d=a.encode64();Chat.log("Sent "+e(d)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+e(a)+" bytes to komodo."),Komodo.send(a)}function e(a){var d=[];a=[a];for(var b=
0;a.length;){var f=a.pop();if("boolean"===typeof f)b+=4;else if("string"===typeof f)b+=2*f.length;else if("number"===typeof f)b+=8;else if("object"===typeof f&&-1===d.indexOf(f)){d.push(f);for(var e in f)a.push(f[e])}}return b}var l,k,h,m;(function(){k=document.createElement("div");k.classList.add("error-notification-tray");k.style.display="none";h=document.createElement("div");h.classList.add("network-error");var a=document.createElement("div");a.classList.add("network-error-text");a.textContent=
"No connection";h.appendChild(a);m=document.createElement("div");m.classList.add("rate-limited");a=document.createElement("div");a.classList.add("network-error-text");a.textContent="You have exceeded your allotted requests";m.appendChild(a);a=document.getElementById("game");k.appendChild(h);k.appendChild(m);a.insertBefore(k,a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+e(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));
Chat.log(e(JSON.stringify(Komodo.decode(a)))-e(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var d=a.Messages,b=0;b<d.length;b++){var f=d[b];Chat.receiveGlobalMessage(f.Sender,f.Text,f.Time,f.Permissions)}if(null!=a.GameSchema){d=a.GameSchema;if(d.Items)for(b=0;b<d.Items.length;b++)Inventory.addItem(d.Items[b].Id,d.Items[b].Name,d.Items[b].Worth,d.Items[b].Category),Statistics.addItem(d.Items[b].Id,d.Items[b].Name);if(d.StoreItems)for(b=0;b<d.StoreItems.length;b++)f=d.StoreItems[b],
Store.addItem(f.Id,f.Category,f.Price,f.Factor,f.Name,f.MaxQuantity);if(d.Processors)for(b=0;b<d.Processors.length;b++){f=d.Processors[b];Crafting.addProcessor(f.Id,f.Name);for(var h=0;h<f.Recipes.length;h++)Crafting.addProcessorRecipe(f.Id,f.Recipes[h].Ingredients,f.Recipes[h].Resultants)}if(d.CraftingItems)for(b=0;b<d.CraftingItems.length;b++)f=d.CraftingItems[b],Crafting.addRecipe(f.Id,f.Ingredients,f.Resultants,f.IsItem);if(d.Buffs)for(b=0;b<d.Buffs.length;b++)f=d.Buffs[b],Buffs.register(f.Id,
f.Name,f.Description,f.Duration)}if(null!=a.Items)for(d=a.Items,b=0;b<d.length;b++)Inventory.changeQuantity(d[b].Id,d[b].Quantity),Inventory.changePrice(d[b].Id,d[b].Worth);if(null!=a.StoreItemsUpdate)for(d=a.StoreItemsUpdate,b=0;b<d.length;b++)Store.changeQuantity(d[b].Id,d[b].Quantity,d[b].MaxQuantity,d[b].Price);if(null!=a.StatItemsUpdate)for(d=a.StatItemsUpdate,b=0;b<d.length;b++)Statistics.changeStats(d[b].Id,d[b].PrestigeQuantity,d[b].LifeTimeQuantity);if(null!=a.ConfigItems)for(d=a.ConfigItems,
b=0;b<d.length;b++)Inventory.modifyConfig(d[b].Id,d[b].Enabled);if(null!=a.Processors)for(d=a.Processors,b=0;b<d.length;b++)f=d[b],Crafting.updateProcessor(f.Id,f.SelectedRecipe,f.OperationDuration,f.CompletedOperations,f.TotalOperations,f.Capacity);null!=a.AntiCheatCoordinates&&(d=a.AntiCheatCoordinates,Rock.moveRock(d.X,d.Y));if(null!=a.Buffs)for(d=a.Buffs,b=0;b<d.length;b++)f=d[b],Buffs.update(f.Id,f.TimeActive);null!=a.IsRateLimited&&(m.style.display=a.IsRateLimited?"block":"none")});a.restart=
function(){Komodo.restart()};var b=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(n(),h.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(l),h.style.display="block");a.newState===$.signalR.connectionState.reconnecting&&(h.style.display="block")});a.drink=function(a){var d=new Komodo.ClientActions.PotionAction;d.Id=a;b.PotionActions.push(d)};a.mine=function(a,d){var e=new Komodo.ClientActions.MiningAction;
e.X=a;e.Y=d;b.MiningActions.push(e)};a.sellItem=function(a,d){var e=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.SellAction;f.Id=a;f.Quantity=d;e.Sell=f;b.InventoryActions.push(e)};a.configureItem=function(a,d){var e=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.ConfigAction;f.Id=a;f.Enabled=d;e.Config=f;b.InventoryActions.push(e)};a.purchaseItem=function(a,d){var e=new Komodo.ClientActions.StoreAction,f=new Komodo.ClientActions.StoreAction.PurchaseAction;
f.Id=a;f.Quantity=d?d:1;e.Purchase=f;b.StoreActions.push(e)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;a.SellAll=!0;b.InventoryActions.push(a)};a.craftRecipe=function(a,d){var e=new Komodo.ClientActions.CraftingAction;e.Id=a;e.Quantity=d;b.CraftingActions.push(e)};a.processRecipe=function(a,d,e){var f=new Komodo.ClientActions.ProcessingAction;f.Id=a;f.RecipeIndex=d;f.Iterations=e;b.ProcessingActions.push(f)};a.sendGlobalMessage=function(a){var d=new Komodo.ClientActions.SocialAction,
e=new Komodo.ClientActions.SocialAction.ChatAction;e.GlobalMessage=a;d.Chat=e;b.SocialActions.push(d)};a.send=g})(Connection||(Connection={}));var Buffs;
(function(a){var n=[],g=document.getElementById("sidebarInformation"),e,l=function(){return function(){}}();a.register=function(a,h,g,b){if(!n[a]){var c=new l;c.name=h;c.description=g;c.duration=b;n[a]=c;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,c.description);h=document.createElement("div");h.textContent=c.name;h.classList.add("buff-header");a.appendChild(h);h=document.createElement("div");h.classList.add("buff-image-container");a.appendChild(h);g=document.createElement("div");
g.classList.add(Utils.cssifyName(c.name));h.appendChild(g);h=document.createElement("div");h.classList.add("buff-header");a.appendChild(h);e.appendChild(a);c.container=a;c.durationElm=h}};a.update=function(a,e){var g=n[a];g.timeActive=e;g.durationElm.textContent="("+Utils.formatTime(g.duration-e)+")";g.container.style.display=0==e?"none":"inline-block"};e=document.createElement("div");g.appendChild(e)})(Buffs||(Buffs={}));var Store;
(function(a){function n(){e=document.createElement("div");document.getElementById("paneContainer").appendChild(e);Tabs.registerGameTab(e,"Store");for(var a in h)if(0<=parseInt(a,10)){var c=h[a];if("CRAFTING"!=c){var d=document.createElement("div");d.classList.add("store-category");k[c]=d;var g=document.createElement("div");g.textContent=c;g.classList.add("store-category-header");d.appendChild(g);e.appendChild(d)}}}function g(a){var c=document.createElement("div");c.classList.add("store-item");a.container=
c;var d=document.createElement("div");d.classList.add("store-item-header");var e=document.createElement("div");e.classList.add("store-item-header-text");e.textContent=a.name;d.appendChild(e);var f=document.createElement("div");f.classList.add("store-item-header-quantity-container");var h=document.createElement("span");h.classList.add("store-item-header-quantity");var g=document.createElement("span");g.classList.add("store-item-header-quantity");var k=document.createElement("span");k.classList.add("store-item-header-quantity");
k.textContent="/";1<a.maxQuantity&&(f.appendChild(g),f.appendChild(k),f.appendChild(h));d.appendChild(f);a.maxQuantityElm=h;a.quantityElm=g;a.nameElm=e;c.appendChild(d);d=document.createElement("DIV");d.style.width="64px";d.style.height="64px";d.style.position="relative";d.style.margin="0 auto";e=document.createElement("DIV");e.classList.add(Utils.cssifyName(a.name));d.appendChild(e);c.appendChild(d);d=document.createElement("div");d.classList.add("store-item-footer");e=document.createElement("div");
e.classList.add("item-text");f=document.createElement("div");f.textContent=Utils.formatNumber(a.price);f.style.display="inline-block";f.style.verticalAlign="top";a.priceElm=f;h=document.createElement("div");h.classList.add("Quarter-Coins");h.style.display="inline-block";e.appendChild(h);e.appendChild(f);var f=document.createElement("div"),h=Utils.createButton("Buy",""),m=a.id;if(5!=a.category)h.addEventListener("click",function(){Connection.purchaseItem(m)});else{var l=document.createElement("INPUT");
l.type="TEXT";l.style.width="40px";l.style.height="15px";f.appendChild(l);h.addEventListener("click",function(){Utils.isNumber(l.value)&&Connection.purchaseItem(m,+l.value)})}f.appendChild(h);d.appendChild(f);d.appendChild(e);c.appendChild(d);return c}var e,l=[],k=[];(function(a){a[a.MINING=1]="MINING";a[a.MACHINES=2]="MACHINES";a[a.GATHERING=3]="GATHERING";a[a.PROCESSING=4]="PROCESSING";a[a.ITEMS=5]="ITEMS";a[a.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category={}));var h=a.Category,m=function(){return function(){}}();
a.tempFix=function(){n()};a.addItem=function(a,c,d,p,f,q){e||n();if(!l[a]){var s=new m;s.id=a;s.category=c;s.price=d;s.factor=p;s.name=f;s.maxQuantity=q?q:0;Objects.register(s.id,s.name);c=k[h[c]];null==c&&(c=k.MINING);6!=s.category&&c.appendChild(g(s));l[a]=s}};a.changeQuantity=function(a,c,d,e){var f=l[a];Utils.ifNotDefault(d,function(){if(0!=d)try{f.maxQuantity=d,f.maxQuantityElm.textContent=d.toString()}catch(a){}});Utils.ifNotDefault(c,function(){Objects.setQuantity(a,c);f.quantity=c;Crafting.update();
0!=d&&6!=f.category&&(f.container.style.display=-1>=f.quantity||f.quantity>=f.maxQuantity&&0<f.maxQuantity?"none":"inline-block",f.maxQuantity&&1<f.maxQuantity&&(f.quantityElm.textContent=c.toString()))});Utils.ifNotDefault(e,function(){f.priceElm&&(f.price=e,f.priceElm.textContent=Utils.formatNumber(e))})}})(Store||(Store={}));var Statistics;
(function(a){function n(){var a=document.createElement("TABLE"),g=a.createTHead(),b=g.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");g=g.insertRow(1);g.classList.add("table-subheader");b=g.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=g.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";g=g.insertCell(0);g.textContent="Item";g.style.width="20%";e=a.createTBody();return a}var g,e,
l=[],k=function(){return function(){}}();a.changeStats=function(a,e,b){var c=l[a];Utils.ifNotDefault(e,function(){c.prestigeQuantity=e;c.prestigeRow.textContent=Utils.formatNumber(e)});Utils.ifNotDefault(b,function(){c.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);c.alltimeRow.textContent=Utils.formatNumber(b)})};a.addItem=function(a,m){g||(g=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(g),Tabs.registerGameTab(g,"Statistics"),g.appendChild(n()));if(!l[a]){var b=
new k;l[a]=b;var c=e.insertRow(e.rows.length);c.classList.add("table-row");b.alltimeRow=c.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=c.insertCell(0);b.prestigeRow.style.width="40%";b=c.insertCell(0);b.style.width="20%";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(m));c.style.display="inline-block";b.appendChild(c)}}})(Statistics||(Statistics={}));var Crafting;
(function(a){function n(){h=document.createElement("DIV");document.getElementById("paneContainer").appendChild(h);Tabs.registerGameTab(h,"Crafting");m=document.createElement("DIV");h.appendChild(m);b=document.createElement("DIV");h.appendChild(b);c=document.createElement("TABLE");c.classList.add("block-table");var a=c.createTHead(),e=a.insertRow(0);e.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=d.length;a.textContent="Crafting Table";
for(a=0;a<d.length;a++){var g=e.insertCell(0);g.style.width=p[a];g.textContent=d[a];"0"!=f[a]&&(g.style.minWidth=f[a])}e=c.insertRow(2);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=d.length;e.textContent="Items";e=c.insertRow(3);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=d.length;e.textContent="Upgrades";b.appendChild(c)}function g(d,b){var c=a.processors[d];if(c){var e=c._recipes[b];for(c.selectedRecipe=b;c.recipeList.lastChild;)c.recipeList.removeChild(c.recipeList.lastChild);
for(var f=0;f<e.ingredients.length;f++){var g=document.createElement("DIV");g.classList.add("item-text");g.style.height="30px";var h=document.createElement("DIV");h.style.display="inline-block";var k=document.createElement("DIV");e.ingredients[f].quantityDiv=k;k.style.display="inline-block";k.style.verticalAlign="super";k.style.color=e.ingredients[f].quantity<=Objects.getQuantity(e.ingredients[f].id)?"darkgreen":"darkred";k.textContent=Utils.formatNumber(e.ingredients[f].quantity);h.classList.add("Half-"+
Utils.cssifyName(Objects.lookupName(e.ingredients[f].id)));g.appendChild(h);g.appendChild(k);c.recipeList.appendChild(g)}}}function e(a){var b=document.createElement("TABLE");b.classList.add("block-table");var c=b.createTHead(),e=c.insertRow(0);e.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=d.length;c.textContent=a.name;for(c=0;c<d.length;c++){var f=e.insertCell(0);f.style.width=s[c];f.textContent=q[c];"0"!=s[c]&&(f.style.minWidth=w[c])}c=
b.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=q.length;f=document.createElement("DIV");f.classList.add("progress-bar-container");e=document.createElement("DIV");e.classList.add("progress-bar");var h=document.createElement("DIV");h.classList.add("progress-bar-text-container");var k=document.createElement("DIV");k.classList.add("progress-bar-text");h.appendChild(k);f.appendChild(h);a.progressBar=e;a.progressText=k;f.appendChild(e);c.appendChild(f);e=b.insertRow(3);e.classList.add("table-row");
for(c=0;c<q.length;c++){f=e.insertCell(0);f.style.width=p[c];f.style.height="75px";"0"!=w[c]&&(f.style.minWidth=w[c]);"Image"==q[c]&&(h=document.createElement("DIV"),h.classList.add(Utils.cssifyName(a.name)),h.style.margin="0 auto",f.appendChild(h));"Capacity"==q[c]&&(f.textContent="0",a.capacityElm=f);"Input"==q[c]&&(a.recipeList=f);if("Output"==q[c]){h=Utils.createButton("Max","");f.appendChild(h);h=document.createElement("INPUT");h.type="TEXT";h.style.width="35px";a.quantityTextbox=h;f.appendChild(h);
var n=a.id,r=document.createElement("SELECT");r.addEventListener("change",function(a){g(n,r.selectedIndex)});a.recipeSelector=r;f.appendChild(r)}"Action"==q[c]&&(h=Utils.createButton("Activate",""),h.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),f.appendChild(h))}l(a);m.appendChild(b)}function l(a){z||(z=document.createElement("div"),C.appendChild(z));var c=document.createElement("div");
c.classList.add("processor-sidebar");a.sidebarContainer=c;var b=document.createElement("div");b.classList.add("buff-header");b.textContent=a.name;c.appendChild(b);b=document.createElement("div");b.classList.add("processor-sidebar-progress-bar-container");var d=document.createElement("div");d.classList.add("processor-sidebar-progress-bar");a.sidebarProgressBar=d;var e=document.createElement("div");e.classList.add("processor-sidebar-progress-text");a.sidebarProgressText=e;b.appendChild(e);b.appendChild(d);
c.appendChild(b);b=document.createElement("div");b.classList.add("processor-sidebar-progress-bar-container");d=document.createElement("div");d.classList.add("processor-sidebar-progress-bar");a.sidebarJobBar=d;e=document.createElement("div");e.classList.add("processor-sidebar-progress-text");a.sidebarJobText=e;b.appendChild(e);b.appendChild(d);c.appendChild(b);c.style.display="none";z.appendChild(c)}function k(a,b){var e=c.rows.length;b&&(e=x,x++);e=c.insertRow(e);e.classList.add("table-row");a.row=
e;for(var h=0;h<d.length;h++){var g=e.insertCell(0);g.style.width=p[h];"0"!=f[h]&&(g.style.minWidth=f[h]);"Name"==d[h]&&(g.textContent=Objects.lookupName(a.id));if("Input"==d[h])for(var k=0;k<a.ingredients.length;k++){var l=document.createElement("DIV");l.classList.add("item-text");l.style.height="22px";var n=document.createElement("DIV");n.style.display="inline-block";var m=document.createElement("DIV");a.ingredients[k].quantityDiv=m;m.style.display="inline-block";m.style.verticalAlign="super";m.textContent=
Utils.formatNumber(a.ingredients[k].quantity);n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.ingredients[k].id)));l.appendChild(n);l.appendChild(m);g.appendChild(l)}if("Output"==d[h])for(k=0;k<a.resultants.length;k++)l=document.createElement("DIV"),l.classList.add("item-text"),l.style.height="22px",n=document.createElement("DIV"),n.style.display="inline-block",m=document.createElement("DIV"),m.style.display="inline-block",m.style.verticalAlign="super",m.textContent=Utils.formatNumber(a.resultants[k].quantity),
n.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.resultants[k].id))),l.appendChild(n),a.isItem&&l.appendChild(m),g.appendChild(l);if("Action"==d[h]&&(k=Utils.createButton("Craft",""),k.addEventListener("click",function(){Connection.craftRecipe(a.id,1)},!1),g.appendChild(k),a.isItem)){var q=document.createElement("INPUT");q.type="TEXT";q.style.width="30px";k=Utils.createButton("Craft-x","");k.addEventListener("click",function(){Connection.craftRecipe(a.id,+q.value)},!1);g.appendChild(k);
g.appendChild(q)}}}var h,m,b,c,d=["Action","Description","Input","Output","Name"],p=["10%","50%","15%","15%","10%"],f=["170px","0","0","0","0"],q=["Action","Output","Input","Capacity","Image"],s=["10%","30%","20%","20%","20%"],w=["170px","0","0","0","0"],x=3,v=[];a.processors=[];var C=document.getElementById("sidebarInformation"),z,r=function(){function a(){this._recipes=[]}a.prototype.addRecipe=function(a){this._recipes.push(a);this.selectedRecipe||(this.selectedRecipe=0)};return a}();a.Processor=
r;var A=function(){function a(){this.ingredients=[];this.resultants=[]}a.prototype.addIngredient=function(a){this.ingredients.push(a)};a.prototype.addResultant=function(a){this.resultants.push(a)};return a}();a.Recipe=A;var y=function(){return function(a,b){this.id=a;this.quantity=b}}();a.Ingredient=y;a.addRecipe=function(a,b,c,d){h||n();if(!v[a]){var e=new A;e.id=a;e.isItem=d;v[a]=e;for(a=0;a<b.length;a++)e.addIngredient(new y(b[a].Id,b[a].Quantity));for(a=0;a<c.length;a++)e.addResultant(new y(c[a].Id,
c[a].Quantity));k(e,d)}};a.addProcessor=function(b,c){h||n();if(!a.processors[b]){var d=new r;d.id=b;d.name=c;a.processors[b]=d;e(d)}};a.addProcessorRecipe=function(b,c,d){if(a.processors[b]){var e=a.processors[b],f;a:if(a.processors[b]){f=a.processors[b];for(var h=0;h<f._recipes.length;h++)if(d[0].Id==f._recipes[h].resultants[0].id){f=!0;break a}f=!1}else f=void 0;if(!f){f=new A;for(h=0;h<c.length;h++)f.addIngredient(new y(c[h].Id,c[h].Quantity));for(h=0;h<d.length;h++)f.addResultant(new y(d[h].Id,
d[h].Quantity));e.addRecipe(f);c=document.createElement("OPTION");c.textContent=Objects.lookupName(d[0].Id);e.recipeSelector.appendChild(c);1==e._recipes.length&&g(b,0)}}};a.updateProcessor=function(b,c,d,e,f,h){var g=a.processors[b];if(g){var k=!1;Utils.ifNotDefault(c,function(){g.selectedRecipe=c});Utils.ifNotDefault(f,function(){g.totalOperations=f;k=!0});Utils.ifNotDefault(d,function(){g.operationDuration=d});Utils.ifNotDefault(h,function(){g.capacityElm.textContent=h.toString()});Utils.ifNotDefault(e,
function(){g.completedOperations=e;k=!0});if(k){if(0>=g.totalOperations||g.completedOperations==g.totalOperations){g.progressBar.style.width="0%";g.progressText.textContent="";g.sidebarProgressText.textContent="";g.sidebarContainer.style.display="none";g.totalOperationCompletionTime=0;return}g.sidebarContainer.style.display="inline-block";g.operationStartTime=Date.now();g.operationCompletionTime=g.operationStartTime+1E3*g.operationDuration;0==g.totalOperationCompletionTime&&(g.totalOperationCompletionTime=
g.operationStartTime+1E3*g.operationDuration*(g.totalOperations-g.completedOperations))}if(-1<g.selectedRecipe)try{g.progressText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+" ("+g.completedOperations+"/"+g.totalOperations+")",g.sidebarJobText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+" ("+g.completedOperations+"/"+g.totalOperations+")"}catch(l){console.log("invalid processor recipe "+g.selectedRecipe)}else g.progressText.textContent=
"",g.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(a){if(0>=a.operationDuration)a.progressBar.style.width="0%";else if(a.completedOperations!=a.totalOperations&&0<a.totalOperations){var b=a.operationCompletionTime-Date.now(),b=b/1E3,c=a.totalOperationCompletionTime-Date.now(),d=c/(a.operationDuration*a.totalOperations),b=b/a.operationDuration,b=100-100*b;a.progressBar.style.width=b+"%";a.sidebarJobBar.style.width=b+"%";a.sidebarProgressBar.style.width=100-
d/10+"%";a.sidebarProgressText.textContent=Utils.formatTime(c/1E3)}})},10);a.update=function(){h&&(v.forEach(function(a){var b=Objects.getQuantity(a.id);a.row.style.display=-1==b||!a.isItem&&0<b?"none":"";a.ingredients.forEach(function(a){var b=Objects.getQuantity(a.id);a.quantityDiv.style.color=b>=a.quantity?"darkgreen":"darkred"})}),a.processors.forEach(function(a){g(a.id,a.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));
