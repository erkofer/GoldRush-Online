var Utils;
(function(a){a.addEvent=function(a,k,e){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(k,e,!1):a.attachEvent?a.attachEvent("on"+k,e):a["on"+k]=e)};a.cssSwap=function(a,k,e){a.classList.contains(k)&&a.classList.remove(k);a.classList.add(e)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,k){-100!=a&&k()};a.createButton=function(a,k){var e,q;e=document.createElement("div");q=document.createElement("div");q.textContent=a;k&&(q.id=k);e.classList.add("button");
e.appendChild(q);return e};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a,k){"undefined"===typeof k&&(k=!1);return a?k?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.getRandomInt=function(a,k){return Math.floor(Math.random()*(k-a+1))+a};a.formatTime=function(a){var k=
Math.floor(a/3600),e=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>k?1>k?"":"0"+k+":":k+":")+(10>e?"0"+e+":":e+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=function(a){var k=+a.split(":")[0],e=+a.split(":")[1].split(" ")[0];"PM"==a.split(":")[1].split(" ")[1]&&(k+=12);a=(new Date).getTimezoneOffset();k-=a/60-a%60;e-=a%60;0>k&&(k=24-k);0>e&&(e=60-e,k--);23<k&&(k-=24);59<e&&(e-=60,k++);return(10>k?"0":"")+k+":"+(10>e?"0":"")+e}})(Utils||(Utils={}));var tooltip;
(function(a){function p(a,f){var c=b.getBoundingClientRect(),d=c.right-c.left,c=c.bottom-c.top;b.style.left=d+(a+15)>window.innerWidth?a-d-15+"px":a+15+"px";b.style.top=0<f-c?f-c+"px":f+5+"px"}function k(){b&&b.parentElement.removeChild(b);h=b=null}function e(b,a,f){var c=new u;q(b);f&&(c.header=f);c.content=a;l.push(c);b.dataset?b.dataset.tooltip=n:b.setAttribute("data-tooltip",n.toString());n++}function q(a){a.onmouseenter=function(a){var e=+a.target.getAttribute("data-tooltip");g!==a.target&&(d=
setInterval(function(){f+=.01;if(.25<=f){var a=m,g=c,r=l[e];h!==e&&k();h=e;b=r.html;document.body.appendChild(b);p(a,g);f=0;clearInterval(d);d=null}},10));g=a.target};a.onmousemove=function(b){b=b.pageX||b.pageY?{x:b.pageX,y:b.pageY}:b.clientX||b.clientY?{x:b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:b.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;d||p(b.x,b.y);m=b.x;c=b.y};a.onmouseleave=function(b){g=null;clearInterval(d);f=0;k()}}var n=
0,l=[],h,b,d,f=0,m,c,g,u=function(){function b(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(b.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(b){b.classList.add("tooltip-header");this.html.appendChild(b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(b){b.classList.add("tooltip-content");
this.html.appendChild(b)},enumerable:!0,configurable:!0});return b}();a.complexModify=function(b,a,f){b=l[b];f&&(b.header.parentElement.removeChild(b.header),b.header=f);b.content.parentElement.removeChild(b.content);b.content=a};a.modify=function(b,a,f){b=l[b];f&&(b.header.textContent=f);b.content.textContent=a};a.retrieveContent=function(b){return l[b].content};a.complexCreate=e;a.create=function(b,a,f){var c=document.createElement("div");c.textContent=a;f?(a=document.createElement("div"),a.textContent=
f,e(b,c,a)):e(b,c)}})(tooltip||(tooltip={}));var Chat;
(function(a){function p(){if(!e){e=document.createElement("DIV");e.classList.add("chat-window");e.classList.add("social");e.id="chatWindow";e.style.backgroundColor="#ebebeb";e.style.border="1px solid #adadad";var a=document.createElement("DIV");a.classList.add("chat-header");a.style.backgroundColor="rgb(160, 160, 160)";e.appendChild(a);var h=document.createElement("DIV");h.textContent="_";h.style.position="absolute";h.style.top="0";h.style.right="0";h.addEventListener("click",function(){e.classList.contains("closed")?
(e.classList.remove("closed"),h.textContent="_"):(e.classList.add("closed"),h.textContent="+")});a.appendChild(h);var b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent="General";b.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});a.appendChild(b);b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent=">Dev";b.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});b.style.display="none";a.appendChild(b);n=document.createElement("DIV");n.id="debugpane";n.classList.add("chat-room");n.style.display="none";e.appendChild(n);q=document.createElement("DIV");q.id="chatpane";q.classList.add("chat-room");e.appendChild(q);a=document.createElement("DIV");a.id="debuglog";a.classList.add("chat-room-content");n.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.classList.add("chat-room-content");
q.appendChild(a);a=document.createElement("DIV");b=document.createElement("DIV");b.classList.add("chat-textbox-container");var d=document.createElement("INPUT");d.setAttribute("TYPE","TEXT");d.classList.add("chat-textbox");d.style.borderTop="1px solid #adadad";d.setAttribute("maxlength","220");d.addEventListener("keydown",function(b){13==b.keyCode&&k();68==b.keyCode&&b.altKey&&(document.getElementById("debugtab").style.display="inline-block")});d.id="chattext";b.appendChild(d);a.appendChild(b);b=
document.createElement("DIV");b.classList.add("chat-submit-container");d=document.createElement("INPUT");d.setAttribute("TYPE","BUTTON");d.setAttribute("VALUE","SEND");d.classList.add("chat-submit");d.style.borderTop="1px solid #adadad";d.style.borderLeft="1px solid #adadad";d.addEventListener("click",function(){k()});b.appendChild(d);a.appendChild(b);e.appendChild(a);document.body.appendChild(e)}}function k(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var e,q,n;a.initialize=p;p();a.log=function(a){var h=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;h.appendChild(b)};a.receiveGlobalMessage=function(a,h,b,d){var f=document.getElementById("chatlog"),m=5>Math.abs(f.scrollTop-(f.scrollHeight-f.offsetHeight)),c=document.createElement("DIV");c.classList.add("chat-msg");d&&""!=d&&c.classList.add("chat-"+d);d=document.createElement("SPAN");d.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");
b.textContent=a;b.classList.add("chat-sender");a=document.createElement("SPAN");a.textContent=h;a.classList.add("chat-text");h=document.createElement("SPAN");h.textContent=": ";c.appendChild(d);c.appendChild(b);c.appendChild(h);c.appendChild(a);f.appendChild(c);m&&(f.scrollTop=f.scrollHeight)}})(Chat||(Chat={}));var Tabs;
(function(a){function p(){if(n){var b=n.scrollHeight;b>window.innerHeight-a.bottomPadding&&(b=window.innerHeight-a.bottomPadding);e.style.minHeight=b+"px";e.style.maxHeight=b+"px";e.style.overflowY=b>=window.innerHeight-a.bottomPadding?"scroll":"hidden"}}var k=0,e=document.getElementById("paneContainer");a.bottomPadding=200;var q=[],n,l=new (function(){function b(b){this.container=b;this.tabs=[];this.lowestId=0;this.id=k++;q.push(this)}b.prototype.newTab=function(b){var f=new h;f.pane=b;b=document.createElement("DIV");
b.classList.add("tab-button");this.container.appendChild(b);f.button=b;0==this.lowestId?f.activate():f.deactivate();var m=this.lowestId++,c=this.id;b.addEventListener("click",function(){a.activateTab(c,m)});this.tabs.push(f);this.container.appendChild(b);return this.lowestId-1};b.prototype.activate=function(b){for(var a=0;a<this.tabs.length;a++)this.tabs[a].deactivate();this.tabs[b].activate()};b.prototype.css=function(b,a){this.tabs[b].button.classList.add(a)};return b}())(document.getElementById("tabContainer"));
a.registerGameTab=function(b,a){var f=l.newTab(b);a&&l.css(f,a)};a.updateGameTabs=p;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(p,20);a.activateTab=function(b,a){q[b].activate(a);p()};var h=function(){function b(){}b.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};b.prototype.activate=function(){Utils.cssSwap(this.button,"inactive","active");this.pane.style.display="block";this.pane.style.overflow=
"visible";n=this.pane};return b}()})(Tabs||(Tabs={}));var Objects;
(function(a){var p=[],k=function(){return function(){this.quantity=0}}();a.register=function(a,q){if(!p[a]){var n=new k;n.name=q;p[a]=n}};a.lookupName=function(a){return p[a].name};a.setQuantity=function(a,k){p[a].quantity=k};a.getQuantity=function(a){return(a=p[a])?a.quantity:0};a.setMaxQuantity=function(a,k){p[a].maxQuantity=k};a.getMaxQuantity=function(a){return p[a].maxQuantity};a.setLifeTimeTotal=function(a,k){p[a].lifeTimeTotal=k};a.getLifeTimeTotal=function(a){return p[a].lifeTimeTotal};a.setTooltip=
function(a,k){p[a].tooltip=k};a.getTooltip=function(a){return p[a].tooltip}})(Objects||(Objects={}));var Inventory;
(function(a){function p(a){Connection.sellItem(f.id,a?a:1)}function k(){var b=document.getElementById("selecteditemquantity"),f=+b.value;Utils.isNumber(f)&&f>a.getSelectedItemQuantity()&&(b.value=a.getSelectedItemQuantity().toString())}function e(){l=document.createElement("DIV");document.getElementById("paneContainer").appendChild(l);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var s=document.createElement("SPAN");s.textContent="x";s.style.top="0px";s.style.right=
"3px";s.style.position="absolute";s.addEventListener("click",function(){a.selectItem()});b.appendChild(s);d=document.createElement("DIV");d.classList.add("selected-item-image");s=document.createElement("INPUT");s.id="selecteditemquantity";s.type="text";s.style.height="18px";s.classList.add("selected-item-quantity");s.addEventListener("input",function(){k()});g=Utils.createButton("Drink","");g.classList.add("selected-item-quantity");g.addEventListener("click",function(){Connection.drink(f.id);k()});
var e=Utils.createButton("Sell","");e.classList.add("selected-item-quantity");e.addEventListener("click",function(){var b=+document.getElementById("selecteditemquantity").value;Utils.isNumber(b)&&a.sellSelectedItem(b);k()});var t=Utils.createButton("Sell all","");t.classList.add("selected-item-quantity");t.addEventListener("click",function(){a.sellAllSelectedItem();k()});b.appendChild(d);b.appendChild(t);b.appendChild(e);b.appendChild(g);b.appendChild(s);l.appendChild(b);s=document.createElement("DIV");
s.style.textAlign="center";e=document.createElement("DIV");e.style.display="inline-block";t=Utils.createButton("Sell (...)","");t.addEventListener("click",function(){Connection.sellAllItems()});var r=Utils.createButton("...","");r.addEventListener("click",function(){a.toggleConfig()});e.appendChild(t);e.appendChild(r);s.appendChild(e);l.appendChild(s);c=document.createElement("DIV");c.classList.add("config-container");c.classList.add("closed");s=document.createElement("TABLE");s.classList.add("config-table");
c.appendChild(s);t=s.createTHead();e=t.insertRow(0);t=t.insertRow(0);t.classList.add("table-header");t=t.insertCell(0);t.textContent="Inventory Configuration";t.setAttribute("colspan","10");e.classList.add("table-subheader");for(var n in w)0<=parseInt(n,10)&&"NFS"!=w[n]&&(e.insertCell(e.cells.length).classList.add("config-cell-check"),t=e.insertCell(e.cells.length),t.classList.add("config-cell-name"),t.textContent=w[n]);m=s.createTBody();h=document.createElement("DIV");h.style.position="relative";
h.appendChild(c);l.appendChild(h);Tabs.registerGameTab(l,"Inventory");Equipment.draw()}function q(a){var b=document.createElement("DIV");a.container=b;b.classList.add("header-item");var f=document.createElement("DIV");f.style.width="32px";f.style.height="32px";f.style.display="inline-block";f.style.position="relative";f.style.margin="0 auto";var c=document.createElement("DIV");c.classList.add("Half-"+a.name.replace(" ","_"));f.appendChild(c);b.appendChild(f);f=document.createElement("DIV");a.quantityElm=
f;f.classList.add("item-text");f.textContent=Utils.formatNumber(0);f.style.verticalAlign="top";f.style.marginTop="8px";f.style.display="inline-block";b.appendChild(f);f=document.createElement("DIV");f.style.display="none";a.worthElm=f;b.appendChild(f);return b}function n(b){if(0==b.category||null==b.category)return q(b);var f=document.createElement("DIV");b.container=f;f.classList.add("item");f.addEventListener("click",function(){a.selectItem(b.id)});tooltip.create(f,b.name);var c=document.createElement("DIV");
c.classList.add("item-text");var d=document.createElement("DIV");d.style.verticalAlign="top";d.style.display="inline-block";d.textContent=Utils.formatNumber(b.worth);b.worthElm=d;var g=document.createElement("DIV");g.classList.add("Quarter-Coins");g.style.display="inline-block";c.appendChild(g);c.appendChild(d);f.appendChild(c);d=document.createElement("DIV");d.style.width="64px";d.style.height="64px";d.style.position="relative";d.style.margin="0 auto";c=document.createElement("DIV");c.classList.add(b.name.replace(" ",
"_"));d.appendChild(c);f.appendChild(d);c=document.createElement("DIV");b.quantityElm=c;c.classList.add("item-text");c.textContent=Utils.formatNumber(0);f.appendChild(c);if(null!=b.category){var v,h,d=m.rows.length,c=b.category,c=2*c;c--;for(g=0;g<d;g++){var C=m.rows[g].cells[c];if(C&&0==C.childElementCount){v=m.rows[g].cells[c];h=m.rows[g].cells[c-1];break}}if(!v){h=m.insertRow(m.rows.length);h.classList.add("table-row");for(var e in w)0<=parseInt(e,10)&&"NFS"!=w[e]&&(h.insertCell(h.cells.length).classList.add("config-cell-check"),
h.insertCell(h.cells.length).classList.add("config-cell-name"));v=h.cells[c];h=h.cells[c-1]}e=document.createElement("DIV");e.classList.add("item-text");e.style.height="auto";d=document.createElement("SPAN");d.style.verticalAlign="top";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(b.name));c.style.display="inline-block";r[b.id]=c;d.textContent=b.name;u[b.id]=d;e.appendChild(c);e.appendChild(d);v.appendChild(e);v=document.createElement("INPUT");v.type="CHECKBOX";var l=b.id;
a.configClickers[l]=v;v.addEventListener("change",function(b){Connection.configureItem(l,a.configClickers[l].checked)});h.appendChild(v)}return f}a.items=[];a.configClickers=[];var l,h,b,d,f,m,c,g,u=[],r=[],y=function(){return function(b,a,f,c){this.id=b;this.name=a;this.worth=f;this.category=c}}();a.Item=y;(function(b){b[b.NFS=0]="NFS";b[b.ORE=1]="ORE";b[b.GEM=2]="GEM";b[b.INGREDIENT=3]="INGREDIENT";b[b.CRAFTING=4]="CRAFTING";b[b.POTION=5]="POTION"})(a.Category||(a.Category={}));var w=a.Category;
a.getSelectedItemQuantity=function(){return f?f.quantity:0};a.selectItem=function(c){c?(null!=f&&d.classList.remove(Utils.cssifyName(f.name)),f=a.items[c],d.classList.add(Utils.cssifyName(f.name)),g.style.display=5==f.category?"inline-block":"none",k()):(d.classList.remove(Utils.cssifyName(f.name)),f=null);b.style.display=null==f?"none":"block"};a.sellSelectedItem=p;a.sellAllSelectedItem=function(){p(f.quantity)};a.modifyConfig=function(b,f){a.configClickers[b]||console.log(b);a.configClickers[b].checked=
f};a.toggleConfig=function(){c.classList.contains("closed")?c.classList.remove("closed"):c.classList.add("closed")};a.addItem=function(b,f,c,d){a.items[b]||(b=new y(b,f,c,d),a.items[b.id]=b,Objects.register(b.id,b.name),l||e(),0!=b.category&&null!=b.category?h.appendChild(n(b)):document.getElementById("headerInventory").appendChild(n(b)))};a.changePrice=function(b,f){Utils.ifNotDefault(f,function(){var c=a.items[b];c.worth=f;c.worthElm.textContent=Utils.formatNumber(f)})};a.changeQuantity=function(b,
f){Utils.ifNotDefault(f,function(){Objects.setQuantity(b,f);Crafting.update();a.items[b].quantityElm.textContent=Utils.formatNumber(f);a.items[b].quantity=f;a.items[b].container.style.display=0!=a.items[b].category&&null!=a.items[b].category?0==f?"none":"inline-block":0==Objects.getLifeTimeTotal(b)?"none":"inline-block";k()})};a.update=function(){0>=u.length||a.items.forEach(function(b){var a=Objects.getLifeTimeTotal(b.id);u[b.id]&&(u[b.id].textContent=0<a?b.name:"???");r[b.id]&&(r[b.id].style.display=
0<a?"inline-block":"none")})}})(Inventory||(Inventory={}));var Statistics;
(function(a){function p(){var a=document.createElement("TABLE"),h=a.createTHead(),b=h.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");h=h.insertRow(1);h.classList.add("table-subheader");b=h.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=h.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";h=h.insertCell(0);h.textContent="Item";h.style.width="20%";e=a.createTBody();return a}var k,e,
q=[],n=function(){return function(){}}();a.changeStats=function(a,h,b){var d=q[a];Utils.ifNotDefault(h,function(){d.prestigeQuantity=h;d.prestigeRow.textContent=Utils.formatNumber(h)});Utils.ifNotDefault(b,function(){d.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);d.alltimeRow.textContent=Utils.formatNumber(b)})};a.addItem=function(a,h){k||(k=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(k),Tabs.registerGameTab(k,"Statistics"),k.appendChild(p()));if(!q[a]){var b=
new n;q[a]=b;var d=e.insertRow(e.rows.length);d.classList.add("table-row");b.alltimeRow=d.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=d.insertCell(0);b.prestigeRow.style.width="40%";b=d.insertCell(0);b.style.width="20%";d=document.createElement("DIV");d.classList.add("Third-"+Utils.cssifyName(h));d.style.display="inline-block";b.appendChild(d)}}})(Statistics||(Statistics={}));var Store;
(function(a){function p(){e=document.createElement("div");document.getElementById("paneContainer").appendChild(e);Tabs.registerGameTab(e,"Store");for(var b in l)if(0<=parseInt(b,10)){var a=l[b];if("CRAFTING"!=a){var f=document.createElement("div");f.classList.add("store-category");n[a]=f;var m=document.createElement("div");m.textContent=a;m.classList.add("store-category-header");f.appendChild(m);e.appendChild(f)}}}function k(b){var a=document.createElement("div");"undefined"!=b.tooltip&&tooltip.create(a,
b.tooltip);a.classList.add("store-item");b.container=a;var f=document.createElement("div");f.classList.add("store-item-header");var m=document.createElement("div");m.classList.add("store-item-header-text");m.textContent=b.name;f.appendChild(m);var c=document.createElement("div");c.classList.add("store-item-header-quantity-container");var g=document.createElement("span");g.classList.add("store-item-header-quantity");var h=document.createElement("span");h.classList.add("store-item-header-quantity");
var e=document.createElement("span");e.classList.add("store-item-header-quantity");e.textContent="/";1<b.maxQuantity&&(c.appendChild(h),c.appendChild(e),c.appendChild(g));f.appendChild(c);b.maxQuantityElm=g;b.quantityElm=h;b.nameElm=m;a.appendChild(f);f=document.createElement("DIV");f.style.width="64px";f.style.height="64px";f.style.position="relative";f.style.margin="0 auto";m=document.createElement("DIV");m.classList.add(Utils.cssifyName(b.name));f.appendChild(m);a.appendChild(f);f=document.createElement("div");
f.classList.add("store-item-footer");m=document.createElement("div");m.classList.add("item-text");c=document.createElement("div");c.textContent=Utils.formatNumber(b.price);c.style.display="inline-block";c.style.verticalAlign="top";b.priceElm=c;g=document.createElement("div");g.classList.add("Quarter-Coins");g.style.display="inline-block";m.appendChild(g);m.appendChild(c);var c=document.createElement("div"),g=Utils.createButton("Buy",""),k=b.id;if(5!=b.category)g.addEventListener("click",function(){Connection.purchaseItem(k)});
else{var l=document.createElement("INPUT");l.type="TEXT";l.style.width="40px";l.style.height="15px";c.appendChild(l);g.addEventListener("click",function(){Utils.isNumber(l.value)&&Connection.purchaseItem(k,+l.value)})}c.appendChild(g);f.appendChild(c);f.appendChild(m);a.appendChild(f);return a}var e,q=[],n=[];(function(b){b[b.MINING=1]="MINING";b[b.MACHINES=2]="MACHINES";b[b.GATHERING=3]="GATHERING";b[b.PROCESSING=4]="PROCESSING";b[b.ITEMS=5]="ITEMS";b[b.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category=
{}));var l=a.Category,h=function(){return function(){}}();a.tempFix=function(){p()};a.addItem=function(b,a,f,m,c,g,u){e||p();if(!q[b]){Objects.register(b,c);var r=new h;r.id=b;r.category=a;r.price=f;r.factor=m;r.name=c;r.tooltip=u;r.maxQuantity=g?g:0;Objects.register(r.id,r.name);Objects.setTooltip(r.id,r.tooltip);2==r.category&&Equipment.registerGatherer(r.id);a=n[l[a]];null==a&&(a=n.MINING);6!=r.category&&a.appendChild(k(r));q[b]=r}};a.changeQuantity=function(b,a,f,m){var c=q[b];Utils.ifNotDefault(f,
function(){if(0!=f)try{Equipment.changeMaxQuantity(b,f),c.maxQuantity=f,c.maxQuantityElm.textContent=f.toString()}catch(a){}});Utils.ifNotDefault(a,function(){Objects.setQuantity(b,a);c.quantity=a;Crafting.update();Equipment.changeQuantity(b,a);0!=f&&6!=c.category&&(c.container.style.display=-1>=c.quantity||c.quantity>=c.maxQuantity&&0<c.maxQuantity?"none":"inline-block",c.maxQuantity&&1<c.maxQuantity&&(c.quantityElm.textContent=a.toString()))});Utils.ifNotDefault(m,function(){c.priceElm&&(c.price=
m,c.priceElm.textContent=Utils.formatNumber(m))})}})(Store||(Store={}));var Rock;
(function(a){function p(){if(c){var b=Date.now(),a=b-t,a=a/1E3;t=b;x=s?x+8*a:x-8*a;if(4<x||-4>x)s=!s;n(g,u,64+x,64+x);w&&setTimeout(p,10)}else setTimeout(p,10)}function k(b,a){var f=b.getBoundingClientRect();return{x:a.clientX-f.left,y:a.clientY-f.top}}function e(b,f){if(b>g&&b<g+64&&f>u&&f<u+64){if(y){n(g+2,u+2,60,60);if(z)for(var c=Utils.getRandomInt(1,3),m=0;m<c;m++){var d=Utils.getRandomInt(-5,5),v=Utils.getRandomInt(-2,2);a.particles.push(new A(b+d,f+v))}z=!1}else n(g-2,u-2,68,68),z=!0;w=!1;
r=!0}else r&&(n(g,u,64,64),r=!1,z=!0)}function q(b,a){b!=g&&a!=u&&(g=b,u=a,c?n(b,a,64,64):setTimeout(function(){q(b,a)},10))}function n(a,c,d,v){b.clearRect(0,0,250,250);b.drawImage(f,0,0);b.drawImage(m,a,c,d,v)}var l=document.getElementById("rock"),h=document.getElementById("particles"),b=l.getContext("2d"),d=h.getContext("2d"),f=new Image,m=new Image(16,16),c=!1,g=0,u=0,r=!1,y=!1,w=!0,s=!0,x=0,t=Date.now();a.particles=[];var A=function(){function b(a,f){this.height=this.width=5;this.dispose=!1;
this.x=a;this.y=f;this.verticalVelocity=Utils.getRandomInt(-100,-155);this.horizonalVelocity=Utils.getRandomInt(-50,50);this.width=Utils.getRandomInt(3,6);this.height=Utils.getRandomInt(3,6);this.rotation=Utils.getRandomInt(0,180);this.rotationalVelocity=Utils.getRandomInt(-75,75);this.lastTick=Date.now()}b.prototype.update=function(){var b=Date.now()-this.lastTick;this.lastTick=Date.now();b/=1E3;this.rotation+=this.rotationalVelocity*b;this.y+=this.verticalVelocity*b;this.x+=this.horizonalVelocity*
b;this.verticalVelocity+=200*b;270<this.y&&(this.dispose=!0)};return b}();a.Particle=A;p();var z=!0;a.moveRock=q;var v=document.createElement("canvas"),B=v.getContext("2d");setInterval(function(){d.clearRect(0,0,250,250);for(var b=0;b<a.particles.length;b++){var f=a.particles[b];f.update();var c=f;v.width=c.width;v.height=c.height;B.rect(0,0,c.width,c.height);B.fillStyle="gray";B.fill();B.stroke();d.beginPath();var m=d,h=v,g=c.x,e=c.y,l=c.width,k=c.height,c=c.rotation*Math.PI/180;m.translate(g+l/
2,e+k/2);m.rotate(c);m.drawImage(h,l/2*-1,k/2*-1,l,k);m.rotate(-1*c);m.translate(-1*(g+l/2),-1*(e+k/2));f.dispose&&a.particles.splice(b,1)}},10);(function(){f.onload=function(){b.drawImage(f,0,0);console.log("rock loaded")};f.src="/Content/Rock.png";m.onload=function(){c=!0};m.src="/Content/Stone.png";l.addEventListener("mousemove",function(b){b=k(l,b);e(b.x,b.y)},!1);l.addEventListener("mousedown",function(b){b=k(l,b);y=!0;e(b.x,b.y);Connection.mine(b.x,b.y)},!1);l.addEventListener("mouseup",function(b){b=
k(l,b);y=!1;e(b.x,b.y)},!1);l.addEventListener("mouseleave",function(b){b=k(l,b);y=!1;e(b.x,b.y)},!1)})()})(Rock||(Rock={}));var Equipment;
(function(a){function p(){n=document.createElement("div");n.classList.add("store-category");var a=document.createElement("div");a.classList.add("store-category-header");a.textContent="Gatherers";n.appendChild(a);q.appendChild(n)}function k(a){n||p();var b=e[a];b.container=document.createElement("div");b.container.classList.add("equipment-gatherer-container");var d=document.createElement("div");d.classList.add("store-item-header");var f=document.createElement("div");f.classList.add("store-item-header-text");
f.textContent=Objects.lookupName(a);d.appendChild(f);f=Utils.createButton("Disable","");f.addEventListener("click",function(){Connection.toggleGatherer(a,!b.enabled)});var m=document.createElement("div");m.classList.add("store-item-header-quantity-container");b.quantityElm=document.createElement("span");var c=document.createElement("span");c.textContent="/";b.maxQuantityElm=document.createElement("span");m.appendChild(b.quantityElm);m.appendChild(c);m.appendChild(b.maxQuantityElm);d.appendChild(m);
b.container.appendChild(d);b.efficiencyElm=document.createElement("div");b.container.appendChild(b.efficiencyElm);b.fuelConsumptionElm=document.createElement("div");b.container.appendChild(b.fuelConsumptionElm);b.rarityBonusElm=document.createElement("div");b.container.appendChild(b.rarityBonusElm);b.container.appendChild(f);b.toggleElm=f.firstChild;n.appendChild(b.container)}var e=[],q,n,l=function(){return function(){}}();a.draw=function(){q||(q=document.createElement("div"),document.getElementById("paneContainer").appendChild(q),
Tabs.registerGameTab(q,"Equipment"))};a.registerGatherer=function(a){if(!e[a]){var b=new l;e[a]=b;k(a)}};a.toggleGatherer=function(a,b){var d=e[a];d&&(d.enabled=b,d.toggleElm.textContent=b?"Disable":"Enable")};a.changeQuantity=function(a,b){Utils.ifNotDefault(b,function(){var d=e[a];d&&(d.quantity=b,d.container.style.display=-1<b?"inline-block":"none",d.quantityElm.textContent=Utils.formatNumber(b))})};a.changeMaxQuantity=function(a,b){Utils.ifNotDefault(b,function(){var d=e[a];d&&(d.maxQuantity=
b,d.maxQuantityElm.textContent=Utils.formatNumber(b))})};a.changeFuelConsumption=function(a,b){Utils.ifNotDefault(b,function(){var d=e[a];d&&(d.fuelConsumption=b,d.fuelConsumptionElm.textContent="Fuel consumed: "+Utils.formatNumber(b))})};a.changeEfficiency=function(a,b){Utils.ifNotDefault(b,function(){var d=e[a];d&&(d.efficiency=b,d.efficiencyElm.textContent="Resources/s: "+Utils.formatNumber(b))})};a.changeRarityBonus=function(a,b){Utils.ifNotDefault(b,function(){var d=e[a];d&&(d.rarityBonus=b,
d.rarityBonusElm.textContent="Rarity multi: x"+Utils.formatNumber(b))})}})(Equipment||(Equipment={}));var Crafting;
(function(a){function p(){l=document.createElement("DIV");document.getElementById("paneContainer").appendChild(l);Tabs.registerGameTab(l,"Crafting");h=document.createElement("DIV");l.appendChild(h);b=document.createElement("DIV");l.appendChild(b);d=document.createElement("TABLE");d.classList.add("block-table");var a=d.createTHead(),g=a.insertRow(0);g.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=f.length;a.textContent="Crafting Table";
for(a=0;a<f.length;a++){var e=g.insertCell(0);e.style.width=m[a];e.textContent=f[a];"0"!=c[a]&&(e.style.minWidth=c[a])}g=d.insertRow(2);g.classList.add("table-subheader");g=g.insertCell(0);g.colSpan=f.length;g.textContent="Items";g=d.insertRow(3);g.classList.add("table-subheader");g=g.insertCell(0);g.colSpan=f.length;g.textContent="Upgrades";b.appendChild(d)}function k(b,f){var c=a.processors[b];if(c){var m=c._recipes[f];for(c.selectedRecipe=f;c.recipeList.lastChild;)c.recipeList.removeChild(c.recipeList.lastChild);
for(var d=0;d<m.ingredients.length;d++){var g=document.createElement("DIV");g.classList.add("item-text");g.style.height="30px";var e=document.createElement("DIV");e.style.display="inline-block";var h=document.createElement("DIV");m.ingredients[d].quantityDiv=h;h.style.display="inline-block";h.style.verticalAlign="super";h.style.color=m.ingredients[d].quantity<=Objects.getQuantity(m.ingredients[d].id)?"darkgreen":"darkred";h.textContent=Utils.formatNumber(m.ingredients[d].quantity);e.classList.add("Half-"+
Utils.cssifyName(Objects.lookupName(m.ingredients[d].id)));g.appendChild(e);g.appendChild(h);c.recipeList.appendChild(g)}}}function e(b){var a=document.createElement("TABLE");a.classList.add("block-table");b.container=a;var c=a.createTHead(),d=c.insertRow(0);d.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=f.length;c.textContent=b.name;for(c=0;c<f.length;c++){var e=d.insertCell(0);e.style.width=u[c];e.textContent=g[c];"0"!=u[c]&&(e.style.minWidth=
r[c])}c=a.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=g.length;e=document.createElement("DIV");e.classList.add("progress-bar-container");d=document.createElement("DIV");d.classList.add("progress-bar");var l=document.createElement("DIV");l.classList.add("progress-bar-text-container");var n=document.createElement("DIV");n.classList.add("progress-bar-text");l.appendChild(n);e.appendChild(l);b.progressBar=d;b.progressText=n;e.appendChild(d);c.appendChild(e);d=a.insertRow(3);
d.classList.add("table-row");for(c=0;c<g.length;c++){e=d.insertCell(0);e.style.width=m[c];e.style.height="75px";"0"!=r[c]&&(e.style.minWidth=r[c]);"Image"==g[c]&&(l=document.createElement("DIV"),l.classList.add(Utils.cssifyName(b.name)),l.style.margin="0 auto",e.appendChild(l));"Capacity"==g[c]&&(e.textContent="0",b.capacityElm=e);"Input"==g[c]&&(b.recipeList=e);if("Output"==g[c]){l=Utils.createButton("Max","");e.appendChild(l);l=document.createElement("INPUT");l.type="TEXT";l.style.width="35px";
b.quantityTextbox=l;e.appendChild(l);var s=b.id,p=document.createElement("SELECT");p.addEventListener("change",function(b){k(s,p.selectedIndex)});b.recipeSelector=p;e.appendChild(p)}"Action"==g[c]&&(l=Utils.createButton("Activate",""),l.addEventListener("click",function(){Utils.isNumber(b.quantityTextbox.value)&&Connection.processRecipe(b.id,b.recipeSelector.selectedIndex,+b.quantityTextbox.value)},!1),e.appendChild(l))}q(b);h.appendChild(a)}function q(b){x||(x=document.createElement("div"),s.appendChild(x));
var a=document.createElement("div");a.classList.add("processor-sidebar");b.sidebarContainer=a;var c=document.createElement("div");c.classList.add("buff-header");c.textContent=b.name;a.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");var f=document.createElement("div");f.classList.add("processor-sidebar-progress-bar");b.sidebarProgressBar=f;var d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");b.sidebarProgressText=
d;c.appendChild(d);c.appendChild(f);a.appendChild(c);c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar-container");f=document.createElement("div");f.classList.add("processor-sidebar-progress-bar");b.sidebarJobBar=f;d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");b.sidebarJobText=d;c.appendChild(d);c.appendChild(f);a.appendChild(c);a.style.display="none";x.appendChild(a)}function n(b,a){var g=d.rows.length;a&&(g=y,y++);g=d.insertRow(g);
g.classList.add("table-row");b.row=g;for(var e=0;e<f.length;e++){var l=g.insertCell(0);l.style.width=m[e];"0"!=c[e]&&(l.style.minWidth=c[e]);"Name"==f[e]&&(l.textContent=Objects.lookupName(b.id));if("Input"==f[e])for(var h=0;h<b.ingredients.length;h++){var k=document.createElement("DIV");k.classList.add("item-text");k.style.height="auto";var r=document.createElement("DIV");r.style.display="inline-block";var n=document.createElement("DIV");b.ingredients[h].quantityDiv=n;n.style.display="inline-block";
n.style.verticalAlign="super";n.textContent=Utils.formatNumber(b.ingredients[h].quantity);r.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(b.ingredients[h].id)));k.appendChild(r);k.appendChild(n);l.appendChild(k)}"Description"==f[e]&&(l.textContent=Objects.getTooltip(b.resultants[0].id));if("Output"==f[e])for(h=0;h<b.resultants.length;h++)k=document.createElement("DIV"),k.classList.add("item-text"),k.style.height="auto",r=document.createElement("DIV"),r.style.display="inline-block",n=
document.createElement("DIV"),n.style.display="inline-block",n.style.verticalAlign="super",n.textContent=Utils.formatNumber(b.resultants[h].quantity),r.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(b.resultants[h].id))),k.appendChild(r),b.isItem&&k.appendChild(n),l.appendChild(k);if("Action"==f[e]&&(h=Utils.createButton("Craft",""),h.addEventListener("click",function(){Connection.craftRecipe(b.id,1)},!1),l.appendChild(h),b.isItem)){var s=document.createElement("INPUT");s.type="TEXT";
s.style.width="30px";h=Utils.createButton("Craft-x","");h.addEventListener("click",function(){Connection.craftRecipe(b.id,+s.value)},!1);l.appendChild(h);l.appendChild(s)}}}var l,h,b,d,f=["Action","Description","Input","Output","Name"],m=["10%","50%","15%","15%","10%"],c=["170px","0","0","0","0"],g=["Action","Output","Input","Capacity","Image"],u=["10%","30%","20%","20%","20%"],r=["170px","0","0","0","0"],y=3,w=[];a.processors=[];var s=document.getElementById("sidebarInformation"),x,t=function(){function b(){this._recipes=
[]}b.prototype.addRecipe=function(b){this._recipes.push(b);this.selectedRecipe||(this.selectedRecipe=0)};return b}();a.Processor=t;var A=function(){function b(){this.ingredients=[];this.resultants=[]}b.prototype.addIngredient=function(b){this.ingredients.push(b)};b.prototype.addResultant=function(b){this.resultants.push(b)};return b}();a.Recipe=A;var z=function(){return function(b,a){this.id=b;this.quantity=a}}();a.Ingredient=z;a.addRecipe=function(b,a,c,f){l||p();if(!w[b]){var d=new A;d.id=b;d.isItem=
f;w[b]=d;for(b=0;b<a.length;b++)d.addIngredient(new z(a[b].Id,a[b].Quantity));for(b=0;b<c.length;b++)d.addResultant(new z(c[b].Id,c[b].Quantity));n(d,f)}};a.addProcessor=function(b,c,f){l||p();if(!a.processors[b]){var d=new t;d.id=b;d.name=c;d.requiredId=f;a.processors[b]=d;e(d)}};a.addProcessorRecipe=function(b,c,f){if(a.processors[b]){var d=a.processors[b],m;a:if(a.processors[b]){m=a.processors[b];for(var e=0;e<m._recipes.length;e++)if(f[0].Id==m._recipes[e].resultants[0].id){m=!0;break a}m=!1}else m=
void 0;if(!m){m=new A;for(e=0;e<c.length;e++)m.addIngredient(new z(c[e].Id,c[e].Quantity));for(e=0;e<f.length;e++)m.addResultant(new z(f[e].Id,f[e].Quantity));d.addRecipe(m);c=document.createElement("OPTION");c.textContent=Objects.lookupName(f[0].Id);d.recipeSelector.appendChild(c);1==d._recipes.length&&k(b,0)}}};a.updateProcessor=function(b,c,f,d,e,m){var g=a.processors[b];if(g){var h=!1;Utils.ifNotDefault(c,function(){g.selectedRecipe=c});Utils.ifNotDefault(e,function(){g.totalOperations=e;h=!0});
Utils.ifNotDefault(f,function(){g.operationDuration=f});Utils.ifNotDefault(m,function(){g.capacityElm.textContent=m.toString()});Utils.ifNotDefault(d,function(){g.completedOperations=d;h=!0});if(h){if(0>=g.totalOperations||g.completedOperations==g.totalOperations){g.progressBar.style.width="0%";g.progressText.textContent="";g.sidebarProgressText.textContent="";g.sidebarContainer.style.display="none";g.totalOperationCompletionTime=0;return}g.sidebarContainer.style.display="inline-block";g.operationStartTime=
Date.now();g.operationCompletionTime=g.operationStartTime+1E3*g.operationDuration;0==g.totalOperationCompletionTime&&(g.totalOperationCompletionTime=g.operationStartTime+1E3*g.operationDuration*(g.totalOperations-g.completedOperations))}if(-1<g.selectedRecipe)try{g.progressText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+" ("+g.completedOperations+"/"+g.totalOperations+")",g.sidebarJobText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+
" ("+g.completedOperations+"/"+g.totalOperations+")"}catch(l){console.log("invalid processor recipe "+g.selectedRecipe)}else g.progressText.textContent="",g.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(b){if(0>=b.operationDuration)b.progressBar.style.width="0%";else if(b.completedOperations!=b.totalOperations&&0<b.totalOperations){var a=b.operationCompletionTime-Date.now(),a=a/1E3,c=b.totalOperationCompletionTime-Date.now(),f=c/(b.operationDuration*b.totalOperations),
a=a/b.operationDuration,a=100-100*a;b.progressBar.style.width=a+"%";b.sidebarJobBar.style.width=a+"%";b.sidebarProgressBar.style.width=100-f/10+"%";b.sidebarProgressText.textContent=Utils.formatTime(c/1E3)}0!=b.requiredId&&(b.container.style.display=0<Objects.getQuantity(b.requiredId)?"block":"none")})},10);a.update=function(){l&&(w.forEach(function(b){var a=Objects.getQuantity(b.id);b.row.style.display=-1==a||!b.isItem&&0<a?"none":"";b.ingredients.forEach(function(b){var a=Objects.getQuantity(b.id);
b.quantityDiv.style.color=a>=b.quantity?"darkgreen":"darkred"})}),a.processors.forEach(function(b){k(b.id,b.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));var Buffs;
(function(a){var p=[],k=document.getElementById("sidebarInformation"),e,q=function(){return function(){}}();a.register=function(a,l,h,b){if(!p[a]){var d=new q;d.name=l;d.description=h;d.duration=b;p[a]=d;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,d.description);l=document.createElement("div");l.textContent=d.name;l.classList.add("buff-header");a.appendChild(l);l=document.createElement("div");l.classList.add("buff-image-container");a.appendChild(l);h=document.createElement("div");
h.classList.add(Utils.cssifyName(d.name));l.appendChild(h);l=document.createElement("div");l.classList.add("buff-header");a.appendChild(l);e.appendChild(a);d.container=a;d.durationElm=l}};a.update=function(a,e){var h=p[a];h.timeActive=e;h.durationElm.textContent="("+Utils.formatTime(h.duration-e)+")";h.container.style.display=0==e?"none":"inline-block"};e=document.createElement("div");k.appendChild(e)})(Buffs||(Buffs={}));var Account;
(function(a){function p(){b.classList.contains("closed")||b.classList.add("closed")}function k(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var f=document.createElement("DIV");f.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="TEXT";g.maxLength=16;g.placeholder="Username";f.appendChild(g);var d=document.createElement("DIV");d.style.marginBottom="5px";var e=document.createElement("INPUT");e.type="PASSWORD";e.pattern=".{6,}";e.placeholder="Password";
d.appendChild(e);var m=document.createElement("DIV");m.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="CHECKBOX";h.placeholder="Stay logged in on this computer?";m.appendChild(h);a.appendChild(f);a.appendChild(d);a.appendChild(m);c=document.createElement("div");b.addElement(c);b.title="Log in";b.addElement(a);b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(n(g.value,
e.value,h.checked);c.firstChild;)c.removeChild(c.firstChild)},!1);b.show()}function e(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var c=document.createElement("DIV");c.style.marginBottom="5px";var f=document.createElement("INPUT");f.type="TEXT";f.maxLength=16;f.placeholder="Username";c.appendChild(f);var g=document.createElement("DIV");g.style.marginBottom="5px";var d=document.createElement("INPUT");d.type="EMAIL";d.placeholder="Email";g.appendChild(d);var e=document.createElement("DIV");
e.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="PASSWORD";h.pattern=".{6,}";h.placeholder="Password";e.appendChild(h);var l=document.createElement("DIV");l.style.marginBottom="5px";var k=document.createElement("INPUT");k.type="PASSWORD";k.pattern=".{6,}";k.placeholder="Confirm password";l.appendChild(k);k.onblur=function(){h.value!=k.value&&k.setCustomValidity("Passwords are not the same.")};k.onfocus=function(){k.setCustomValidity("")};a.appendChild(c);a.appendChild(g);a.appendChild(e);
a.appendChild(l);b.addElement(a);m=document.createElement("div");b.addElement(m);b.title="Register";b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(q(d.value,f.value,h.value,k.value);m.firstChild;)m.removeChild(m.firstChild)},!1);b.show()}function q(b,a,c,f){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:b,UserName:a,Password:c,ConfirmPassword:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),h(),modal.close();else{for(;m.firstChild;)m.removeChild(m.firstChild);for(var a=0;a<b.Errors.length;a++){var c=document.createElement("div");c.textContent=b.Errors[a];m.appendChild(c)}}}})}function n(b,a,f){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:b,Password:a,RememberMe:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),
h(),modal.close();else{for(;c.firstChild;)c.removeChild(c.firstChild);for(var a=0;a<b.Errors.length;a++){var f=document.createElement("div");f.textContent=b.Errors[a];c.appendChild(f)}}}})}function l(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){console.log(b);Connection.restart();h();location.reload()}})}function h(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);var c=a.Anonymous;f.textContent=c?"Guest":a.UserName;Utils.cssSwap(b,c?"registered":"anonymous",c?"anonymous":"registered")}})}var b,d,f,m,c,g,u=function(){function b(){}b.prototype.failed=function(b){this.resultsElement.textContent="Loading failed..."};b.prototype.succeeded=function(b){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var a=document.createElement("table"),c=a.createTHead().insertRow(0);c.classList.add("table-subheader");
var f=c.insertCell(0);f.textContent="Score";f.style.width="65%";f=c.insertCell(0);f.textContent="Name";f.style.width="25%";c=c.insertCell(0);c.textContent="Rank";c.style.width="10%";for(var c=a.createTBody(),g=0;g<b.length;g++){var d=b[g];console.log(d);var e=c.insertRow(c.rows.length);e.classList.add("table-row");var m=e.insertCell(0);m.textContent=Utils.formatNumber(d.Score);m.style.width="65%";m.addEventListener("click",function(b){var a=b.target;b=a.dataset?a.dataset.tooltip:a.getAttribute("data-tooltip");
0<a.textContent.indexOf(",")?a.textContent=Utils.formatNumber(b):a.textContent=Utils.formatNumber(b,!0)});m.dataset?m.dataset.tooltip=d.Score:m.setAttribute("data-tooltip",d.Score.toString());e.insertCell(0).textContent=d.UserId;f.style.width="25%";e=e.insertCell(0);e.textContent=Utils.formatNumber(d.Rank);e.style.width="10%"}this.resultsElement.appendChild(a)};b.prototype.sendRequest=function(b,a){var c=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:b,Upper:a}),
headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){b=JSON.parse(b);c.succeeded(b)},failure:function(b){c.failed(b)}})};return b}();(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(g)};b.onmouseleave=function(){g=setTimeout(p,250)};var a=document.createElement("DIV");a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",
function(){k()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){e()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");
a.addEventListener("click",function(){l()});b.appendChild(a);d=document.createElement("DIV");d.classList.add("account-user");f=document.createElement("SPAN");d.appendChild(f);b.appendChild(d);document.body.appendChild(b);d.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});a=document.createElement("SPAN");a.textContent="Leaderboards";a.addEventListener("click",function(){var b=new modal.Window;b.title="Leaderboards";var a=document.createElement("DIV");
a.style.width="400px";a.appendChild(Ajax.createLoader());b.addElement(a);var c=new u;c.resultsElement=a;c.sendRequest(0,20);b.show()});a.style.cursor="pointer";document.getElementsByClassName("header-links")[0].appendChild(a);h()})();a.info=h})(Account||(Account={}));var modal;
(function(a){function p(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function k(){if(a.activeWindow){var e=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(e.right-e.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(e.bottom-e.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var e=0,q;a.activeWindow;a.intervalIdentifier;a.hide=p;a.close=function(){if(a.activeWindow){var e=a.activeWindow;p();e.container.parentNode.removeChild(e.container)}};
var n=function(){function l(){this.container=document.createElement("div");this.container.addEventListener("click",function(b){b.stopPropagation()},!1);this.container.classList.add("modal-window");if(!q){var h=document.createElement("div");q=h;h.classList.add("modal-wrapper");h.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-e&&a.close()},!1);document.body.appendChild(h)}q.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(l.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});l.prototype.addElement=function(a){this.bodyEl.appendChild(a)};l.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var d=document.createElement("span");d.textContent=a;b.appendChild(d);this.options.appendChild(b);return b};l.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};l.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};l.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");q.classList.contains("opened")||
q.classList.add("opened");a.activeWindow=this;k();a.intervalIdentifier=setInterval(k,100);e=Date.now()};l.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");q.classList.contains("opened")&&q.classList.remove("opened")};return l}();a.Window=n})(modal||(modal={}));var Ajax;
(function(a){function p(){for(var a=0;a<k.length;a++){var e=k[a];e.dead?k.splice(a,1):e.update()}setTimeout(p,10)}var k=[],e=function(){function a(){this.notDisplayed=20;this.notches=40;this.space=.02;this.spawned=!1;this.spinPos=0;this.spinSpeed=30;this.squareSize=50;this.timeSinceLastTick=Date.now();this.thickness=3;this.dead=!1;this.container=document.createElement("div");this.container.classList.add("loader");this.canvasElement=document.createElement("canvas");this.canvasElement.width=this.squareSize;
this.canvasElement.height=this.squareSize;this.container.appendChild(this.canvasElement);this.context=this.canvasElement.getContext("2d")}a.prototype.update=function(){var a=Date.now();this.canvasElement.parentElement&&(this.spawned=!0);var e=a-this.timeSinceLastTick;this.spinPos+=e/1E3*this.spinSpeed;this.timeSinceLastTick=a;this.spawned&&!this.canvasElement.parentElement&&(this.dead=!0);this.draw()};a.prototype.draw=function(){var a=this.squareSize/2,e=this.squareSize/2-5,h=(2-this.space*this.notches)/
this.notches,b=this.spinPos%this.notches,d=b-this.notDisplayed;this.context.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);for(var f=0;f<this.notches;f++){var m=0+f*h+this.space*f,c=m+h,g=f-this.notches;f<=b&&f>=d?(this.context.beginPath(),this.context.arc(a,a,e,m*Math.PI,c*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(b-f)/(this.notches-this.notDisplayed))+")",this.context.stroke()):g<=b&&g>=d&&(this.context.beginPath(),this.context.arc(a,
a,e,m*Math.PI,c*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(b-g)/(this.notches-this.notDisplayed))+")",this.context.stroke())}};return a}();a.createLoader=function(){var a=new e;k.push(a);return a.container};p()})(Ajax||(Ajax={}));var Connection;
(function(a){function p(){console.log("Connection opened");var b=d.encode64();k(b);d=new Komodo.ClientActions;q=setInterval(function(){var b=d.encode64();k(b);d=new Komodo.ClientActions},1E3)}function k(b){if(b.encode64){var a=b.encode64();Chat.log("Sent "+e(a)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(b));Chat.log("Encoded: ");Chat.log(b.encode64());Komodo.send(b.encode64())}else Chat.log("Sent "+e(b)+" bytes to komodo."),Komodo.send(b)}function e(b){var a=[];b=[b];for(var c=
0;b.length;){var e=b.pop();if("boolean"===typeof e)c+=4;else if("string"===typeof e)c+=2*e.length;else if("number"===typeof e)c+=8;else if("object"===typeof e&&-1===a.indexOf(e)){a.push(e);for(var d in e)b.push(e[d])}}return c}var q,n,l,h,b;(function(){var a=document.getElementsByClassName("header-links")[0],e=document.createElement("div");e.style.display="inline-block";e.textContent="Version History";e.addEventListener("click",function(){window.open("/version")});e.style.cursor="pointer";a.appendChild(e);
b=document.createElement("div");b.style.display="inline-block";b.textContent="There are 0 players mining.";a.appendChild(b);n=document.createElement("div");n.classList.add("error-notification-tray");l=document.createElement("div");l.classList.add("network-error");a=document.createElement("div");a.classList.add("network-error-text");a.textContent="No connection";l.appendChild(a);h=document.createElement("div");h.classList.add("rate-limited");a=document.createElement("div");a.classList.add("network-error-text");
h.style.display="none";a.textContent="You have exceeded your allotted requests";h.appendChild(a);a=document.getElementById("game");n.appendChild(l);n.appendChild(h);a.insertBefore(n,a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+e(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));Chat.log(e(JSON.stringify(Komodo.decode(a)))-e(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var d=
a.Messages,c=0;c<d.length;c++){var g=d[c];Chat.receiveGlobalMessage(g.Sender,g.Text,g.Time,g.Permissions)}if(null!=a.GameSchema){d=a.GameSchema;if(d.Items)for(c=0;c<d.Items.length;c++)Inventory.addItem(d.Items[c].Id,d.Items[c].Name,d.Items[c].Worth,d.Items[c].Category),Statistics.addItem(d.Items[c].Id,d.Items[c].Name);if(d.StoreItems)for(c=0;c<d.StoreItems.length;c++)g=d.StoreItems[c],Store.addItem(g.Id,g.Category,g.Price,g.Factor,g.Name,g.MaxQuantity,g.Tooltip);if(d.Processors)for(c=0;c<d.Processors.length;c++){g=
d.Processors[c];Crafting.addProcessor(g.Id,g.Name,g.RequiredId);for(var k=0;k<g.Recipes.length;k++)Crafting.addProcessorRecipe(g.Id,g.Recipes[k].Ingredients,g.Recipes[k].Resultants)}if(d.CraftingItems)for(c=0;c<d.CraftingItems.length;c++)g=d.CraftingItems[c],Crafting.addRecipe(g.Id,g.Ingredients,g.Resultants,g.IsItem);if(d.Buffs)for(c=0;c<d.Buffs.length;c++)g=d.Buffs[c],Buffs.register(g.Id,g.Name,g.Description,g.Duration)}if(null!=a.Items)for(d=a.Items,c=0;c<d.length;c++)Inventory.changeQuantity(d[c].Id,
d[c].Quantity),Inventory.changePrice(d[c].Id,d[c].Worth);if(null!=a.StoreItemsUpdate)for(d=a.StoreItemsUpdate,c=0;c<d.length;c++)Store.changeQuantity(d[c].Id,d[c].Quantity,d[c].MaxQuantity,d[c].Price);if(null!=a.StatItemsUpdate)for(d=a.StatItemsUpdate,c=0;c<d.length;c++)Statistics.changeStats(d[c].Id,d[c].PrestigeQuantity,d[c].LifeTimeQuantity);if(null!=a.ConfigItems)for(d=a.ConfigItems,c=0;c<d.length;c++)Inventory.modifyConfig(d[c].Id,d[c].Enabled);if(null!=a.Processors)for(d=a.Processors,c=0;c<
d.length;c++)g=d[c],Crafting.updateProcessor(g.Id,g.SelectedRecipe,g.OperationDuration,g.CompletedOperations,g.TotalOperations,g.Capacity);null!=a.AntiCheatCoordinates&&(d=a.AntiCheatCoordinates,Rock.moveRock(d.X,d.Y));if(null!=a.Buffs)for(d=a.Buffs,c=0;c<d.length;c++)g=d[c],Buffs.update(g.Id,g.TimeActive);null!=a.IsRateLimited&&(h.style.display=a.IsRateLimited?"block":"none");if(null!=a.Gatherers)for(d=a.Gatherers,c=0;c<d.length;c++)g=d[c],Equipment.toggleGatherer(g.Id,g.Enabled),Equipment.changeEfficiency(g.Id,
g.Efficiency),Equipment.changeFuelConsumption(g.Id,g.FuelConsumed),Equipment.changeRarityBonus(g.Id,g.RarityBonus);a.ConnectedUsers&&(b.textContent="There are "+a.ConnectedUsers+" players mining.")});a.restart=function(){Komodo.restart()};var d=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(p(),l.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(q),l.style.display="block");a.newState===
$.signalR.connectionState.reconnecting&&(l.style.display="block")});a.toggleGatherer=function(a,b){var c=new Komodo.ClientActions.GathererAction;c.Id=a;c.Enabled=b;d.GathererActions.push(c)};a.drink=function(a){var b=new Komodo.ClientActions.PotionAction;b.Id=a;d.PotionActions.push(b)};a.mine=function(a,b){var c=new Komodo.ClientActions.MiningAction;c.X=a;c.Y=b;d.MiningActions.push(c)};a.sellItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,e=new Komodo.ClientActions.InventoryAction.SellAction;
e.Id=a;e.Quantity=b;c.Sell=e;d.InventoryActions.push(c)};a.configureItem=function(a,b){var c=new Komodo.ClientActions.InventoryAction,e=new Komodo.ClientActions.InventoryAction.ConfigAction;e.Id=a;e.Enabled=b;c.Config=e;d.InventoryActions.push(c)};a.purchaseItem=function(a,b){var c=new Komodo.ClientActions.StoreAction,e=new Komodo.ClientActions.StoreAction.PurchaseAction;e.Id=a;e.Quantity=b?b:1;c.Purchase=e;d.StoreActions.push(c)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;
a.SellAll=!0;d.InventoryActions.push(a)};a.craftRecipe=function(a,b){var c=new Komodo.ClientActions.CraftingAction;c.Id=a;c.Quantity=b;d.CraftingActions.push(c)};a.processRecipe=function(a,b,c){var e=new Komodo.ClientActions.ProcessingAction;e.Id=a;e.RecipeIndex=b;e.Iterations=c;d.ProcessingActions.push(e)};a.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,c=new Komodo.ClientActions.SocialAction.ChatAction;c.GlobalMessage=a;b.Chat=c;d.SocialActions.push(b)};a.send=k})(Connection||
(Connection={}));
