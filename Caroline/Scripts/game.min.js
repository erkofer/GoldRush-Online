var Utils;
(function(a){a.addEvent=function(a,m,e){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(m,e,!1):a.attachEvent?a.attachEvent("on"+m,e):a["on"+m]=e)};a.cssSwap=function(a,m,e){a.classList.contains(m)&&a.classList.remove(m);a.classList.add(e)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,m){-100!=a&&m()};a.createButton=function(a,m){var e,p;e=document.createElement("div");p=document.createElement("div");p.textContent=a;m&&(p.id=m);e.classList.add("button");
e.appendChild(p);return e};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a,m){"undefined"===typeof m&&(m=!1);return a?m?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.getRandomInt=function(a,m){return Math.floor(Math.random()*(m-a+1))+a};a.formatTime=function(a){var m=
Math.floor(a/3600),e=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>m?1>m?"":"0"+m+":":m+":")+(10>e?"0"+e+":":e+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=function(a){var m=new Date,e=m.toISOString().split("-")[0],p=m.toISOString().split("-")[1],l=m.toISOString().split("-")[2].split("T")[0],m=+a.split(":")[0],n=+a.split(":")[1].split(" ")[0];a=a.split(":")[1].split(" ")[1];p=p+"/"+l+"/"+e+" "+((10>m?"0":"")+m)+":"+((10>n?"0":"")+n)+":00 "+a+" UTC";e=new Date(p);console.log(p);console.log(e);
m=e.getHours();n=e.getMinutes();return(10>m?"0":"")+m+":"+(10>n?"0":"")+n}})(Utils||(Utils={}));var Ajax;
(function(a){function q(){for(var a=0;a<m.length;a++){var n=m[a];n.dead?m.splice(a,1):n.update()}setTimeout(q,10)}var m=[],e=function(){function a(){}a.prototype.failed=function(a){this.resultsElement.textContent="Loading failed..."};a.prototype.succeeded=function(a){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var g=document.createElement("table"),b=g.createTHead().insertRow(0);b.classList.add("table-subheader");var c=b.insertCell(0);c.textContent=
"Score";c.style.width="65%";c=b.insertCell(0);c.textContent="Name";c.style.width="25%";b=b.insertCell(0);b.textContent="Rank";b.style.width="10%";for(var b=g.createTBody(),f=0;f<a.length;f++){var k=a[f],d=b.insertRow(b.rows.length);d.classList.add("table-row");var h=d.insertCell(0);h.textContent=Utils.formatNumber(k.Score);h.style.width="65%";h.addEventListener("click",function(b){var a=b.target;b=a.dataset?a.dataset.tooltip:a.getAttribute("data-tooltip");0<a.textContent.indexOf(",")?a.textContent=
Utils.formatNumber(b):a.textContent=Utils.formatNumber(b,!0)});h.dataset?h.dataset.tooltip=k.Score:h.setAttribute("data-tooltip",k.Score.toString());d.insertCell(0).textContent=k.UserId;c.style.width="25%";d=d.insertCell(0);d.textContent=Utils.formatNumber(k.Rank);d.style.width="10%"}this.resultsElement.appendChild(g)};a.prototype.sendRequest=function(a,g){var b=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:a,Upper:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);b.succeeded(a)},failure:function(a){b.failed(a)}})};return a}();a.LeaderboardAjaxService=e;var p=function(){function a(){this.notDisplayed=20;this.notches=40;this.space=.02;this.spawned=!1;this.spinPos=0;this.spinSpeed=30;this.squareSize=50;this.timeSinceLastTick=Date.now();this.thickness=3;this.dead=!1;this.container=document.createElement("div");this.container.classList.add("loader");this.canvasElement=document.createElement("canvas");this.canvasElement.width=
this.squareSize;this.canvasElement.height=this.squareSize;this.container.appendChild(this.canvasElement);this.context=this.canvasElement.getContext("2d")}a.prototype.update=function(){var a=Date.now();this.canvasElement.parentElement&&(this.spawned=!0);var g=a-this.timeSinceLastTick;this.spinPos+=g/1E3*this.spinSpeed;this.timeSinceLastTick=a;this.spawned&&!this.canvasElement.parentElement&&(this.dead=!0);this.draw()};a.prototype.draw=function(){var a=this.squareSize/2,g=this.squareSize/2-5,b=(2-this.space*
this.notches)/this.notches,c=this.spinPos%this.notches,f=c-this.notDisplayed;this.context.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);for(var k=0;k<this.notches;k++){var d=0+k*b+this.space*k,h=d+b,e=k-this.notches;k<=c&&k>=f?(this.context.beginPath(),this.context.arc(a,a,g,d*Math.PI,h*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(c-k)/(this.notches-this.notDisplayed))+")",this.context.stroke()):e<=c&&e>=f&&(this.context.beginPath(),
this.context.arc(a,a,g,d*Math.PI,h*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(c-e)/(this.notches-this.notDisplayed))+")",this.context.stroke())}};return a}();a.createLoader=function(){var a=new p;m.push(a);return a.container};q()})(Ajax||(Ajax={}));var modal;
(function(a){function q(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function m(){if(a.activeWindow){var e=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(e.right-e.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(e.bottom-e.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var e=0,p;a.activeWindow;a.intervalIdentifier;a.hide=q;a.close=function(){if(a.activeWindow){var e=a.activeWindow;q();e.container.parentNode.removeChild(e.container)}};
var l=function(){function n(){this.container=document.createElement("div");this.container.addEventListener("click",function(a){a.stopPropagation()},!1);this.container.classList.add("modal-window");if(!p){var g=document.createElement("div");p=g;g.classList.add("modal-wrapper");g.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-e&&a.close()},!1);document.body.appendChild(g)}p.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(n.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});n.prototype.addElement=function(a){this.bodyEl.appendChild(a)};n.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var c=document.createElement("span");c.textContent=a;b.appendChild(c);this.options.appendChild(b);return b};n.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};n.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};n.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");p.classList.contains("opened")||
p.classList.add("opened");a.activeWindow=this;m();a.intervalIdentifier=setInterval(m,100);e=Date.now()};n.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");p.classList.contains("opened")&&p.classList.remove("opened")};return n}();a.Window=l})(modal||(modal={}));var Objects;
(function(a){var q=[],m=function(){return function(){this.quantity=0}}();a.register=function(a,p){if(!q[a]){var l=new m;l.name=p;q[a]=l}};a.lookupName=function(a){return q[a].name};a.setQuantity=function(a,m){q[a].quantity=m};a.getQuantity=function(a){return(a=q[a])?a.quantity:0};a.setMaxQuantity=function(a,m){q[a].maxQuantity=m};a.getMaxQuantity=function(a){return q[a].maxQuantity};a.setLifeTimeTotal=function(a,m){q[a].lifeTimeTotal=m};a.getLifeTimeTotal=function(a){return q[a].lifeTimeTotal};a.setTooltip=
function(a,m){q[a].tooltip=m};a.getTooltip=function(a){return q[a].tooltip}})(Objects||(Objects={}));var Account;
(function(a){function q(){b.classList.contains("closed")||b.classList.add("closed")}function m(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var f=document.createElement("DIV");f.style.marginBottom="5px";var c=document.createElement("INPUT");c.type="TEXT";c.maxLength=16;c.placeholder="Username";f.appendChild(c);var k=document.createElement("DIV");k.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="PASSWORD";g.pattern=".{6,}";g.placeholder="Password";
k.appendChild(g);var h=document.createElement("DIV");h.style.marginBottom="5px";var n=document.createElement("INPUT");n.type="CHECKBOX";n.placeholder="Stay logged in on this computer?";h.appendChild(n);b.appendChild(f);b.appendChild(k);b.appendChild(h);d=document.createElement("div");a.addElement(d);a.title="Log in";a.addElement(b);a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(l(c.value,
g.value,n.checked);d.firstChild;)d.removeChild(d.firstChild)},!1);a.show()}function e(){var a=new modal.Window,b=document.createElement("DIV");b.style.width="400px";var f=document.createElement("DIV");f.style.marginBottom="5px";var c=document.createElement("INPUT");c.type="TEXT";c.maxLength=16;c.placeholder="Username";f.appendChild(c);var d=document.createElement("DIV");d.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="EMAIL";g.placeholder="Email";d.appendChild(g);var h=document.createElement("DIV");
h.style.marginBottom="5px";var n=document.createElement("INPUT");n.type="PASSWORD";n.pattern=".{6,}";n.placeholder="Password";h.appendChild(n);var e=document.createElement("DIV");e.style.marginBottom="5px";var u=document.createElement("INPUT");u.type="PASSWORD";u.pattern=".{6,}";u.placeholder="Confirm password";e.appendChild(u);u.onblur=function(){n.value!=u.value&&u.setCustomValidity("Passwords are not the same.")};u.onfocus=function(){u.setCustomValidity("")};b.appendChild(f);b.appendChild(d);b.appendChild(h);
b.appendChild(e);a.addElement(b);k=document.createElement("div");a.addElement(k);a.title="Register";a.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);a.addAffirmativeOption("Submit").addEventListener("click",function(){for(p(g.value,c.value,n.value,u.value);k.firstChild;)k.removeChild(k.firstChild)},!1);a.show()}function p(a,b,f,c){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:a,UserName:b,Password:f,ConfirmPassword:c}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),g(),modal.close();else{for(;k.firstChild;)k.removeChild(k.firstChild);for(var b=0;b<a.Errors.length;b++){var f=document.createElement("div");f.textContent=a.Errors[b];k.appendChild(f)}}}})}function l(a,b,f){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:a,Password:b,RememberMe:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){a=JSON.parse(a);if(a.Succeeded)Connection.restart(),
g(),modal.close();else{for(;d.firstChild;)d.removeChild(d.firstChild);for(var b=0;b<a.Errors.length;b++){var f=document.createElement("div");f.textContent=a.Errors[b];d.appendChild(f)}}}})}function n(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(a){console.log(a);Connection.restart();g();location.reload()}})}function g(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(c){c=JSON.parse(c);var d=c.Anonymous;f.textContent=d?"Guest":c.UserName;a.signedIn=!d;Utils.cssSwap(b,d?"registered":"anonymous",d?"anonymous":"registered")}})}var b,c,f;a.signedIn=!1;var k,d,h,r;(function(b){function f(a,c,d){b.currentlyInspecting=a;var k=new Ajax.LeaderboardAjaxService;k.resultsElement=d;k.sendRequest(a,c)}b.currentlyInspecting=0;b.open=function(){var c=new modal.Window;c.title="Leaderboards";if(!a.signedIn){var d=document.createElement("div");d.style.fontSize=
"18px";d.style.background="darkred";d.style.color="white";d.style.fontWeight="bold";d.style.textAlign="center";d.style.border="1px solid white";d.textContent="Sign in to see where you rank.";c.addElement(d)}var k=document.createElement("DIV");k.style.width="400px";k.appendChild(Ajax.createLoader());c.addElement(k);d=document.createElement("div");d.style.textAlign="center";d.style.marginTop="5px";var g=Utils.createButton("<<",""),h=document.createElement("input");h.type="TEXT";var n=Utils.createButton(">>",
"");g.addEventListener("click",function(){b.currentlyInspecting-=20;0>b.currentlyInspecting&&(b.currentlyInspecting=0);b.currentlyInspecting-=b.currentlyInspecting%20;f(b.currentlyInspecting,b.currentlyInspecting+20,k)});h.addEventListener("keyup",function(a){13==a.keyCode&&(a=a.currentTarget.value,Utils.isNumber(a)&&(b.currentlyInspecting=+a,b.currentlyInspecting-=b.currentlyInspecting%20,f(b.currentlyInspecting,b.currentlyInspecting+20,k)))});n.addEventListener("click",function(){b.currentlyInspecting+=
20;b.currentlyInspecting-=b.currentlyInspecting%20;f(b.currentlyInspecting,b.currentlyInspecting+20,k)});d.appendChild(g);d.appendChild(h);d.appendChild(n);c.addElement(d);c.addOption("Close").addEventListener("click",function(){modal.close()});c.show();f(0,20,k)}})(r||(r={}));(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(h)};b.onmouseleave=function(){h=setTimeout(q,250)};var a=document.createElement("DIV");
a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){m()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){e()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);
a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");a.addEventListener("click",function(){n()});b.appendChild(a);c=document.createElement("DIV");c.classList.add("account-user");f=document.createElement("SPAN");c.appendChild(f);b.appendChild(c);document.body.appendChild(b);c.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});a=document.createElement("SPAN");
a.textContent="Leaderboards";a.addEventListener("click",function(){r.open()});a.style.cursor="pointer";document.getElementsByClassName("header-links")[0].appendChild(a);g()})();a.info=g})(Account||(Account={}));var Rock;
(function(a){function q(){if(d){var a=Date.now(),b=a-t,b=b/1E3;t=a;z=v?z+8*b:z-8*b;if(4<z||-4>z)v=!v;l(h,r,64+z,64+z);x&&setTimeout(q,10)}else setTimeout(q,10)}function m(a,b){var f=a.getBoundingClientRect();return{x:b.clientX-f.left,y:b.clientY-f.top}}function e(b,f){if(b>h&&b<h+64&&f>r&&f<r+64){if(w){l(h+2,r+2,60,60);if(A)for(var d=Utils.getRandomInt(1,3),c=0;c<d;c++){var k=Utils.getRandomInt(-5,5),g=Utils.getRandomInt(-2,2);a.particles.push(new B(b+k,f+g))}A=!1}else l(h-2,r-2,68,68),A=!0;x=!1;
s=!0}else s&&(l(h,r,64,64),s=!1,A=!0)}function p(a,b){a!=h&&b!=r&&(h=a,r=b,d?l(a,b,64,64):setTimeout(function(){p(a,b)},10))}function l(a,c,d,g){b.clearRect(0,0,250,250);b.drawImage(f,0,0);b.drawImage(k,a,c,d,g)}var n=document.getElementById("rock"),g=document.getElementById("particles"),b=n.getContext("2d"),c=g.getContext("2d"),f=new Image,k=new Image(16,16),d=!1,h=0,r=0,s=!1,w=!1,x=!0,v=!0,z=0,t=Date.now();a.particles=[];var B=function(){function a(b,f){this.height=this.width=5;this.dispose=!1;
this.x=b;this.y=f;this.verticalVelocity=Utils.getRandomInt(-100,-155);this.horizonalVelocity=Utils.getRandomInt(-50,50);this.width=Utils.getRandomInt(3,6);this.height=Utils.getRandomInt(3,6);this.rotation=Utils.getRandomInt(0,180);this.rotationalVelocity=Utils.getRandomInt(-75,75);this.lastTick=Date.now()}a.prototype.update=function(){var a=Date.now()-this.lastTick;this.lastTick=Date.now();a/=1E3;this.rotation+=this.rotationalVelocity*a;this.y+=this.verticalVelocity*a;this.x+=this.horizonalVelocity*
a;this.verticalVelocity+=200*a;270<this.y&&(this.dispose=!0)};return a}();a.Particle=B;q();var A=!0;a.moveRock=p;var y=document.createElement("canvas"),u=y.getContext("2d");setInterval(function(){c.clearRect(0,0,250,250);for(var b=0;b<a.particles.length;b++){var f=a.particles[b];f.update();var d=f;y.width=d.width;y.height=d.height;u.rect(0,0,d.width,d.height);u.fillStyle="gray";u.fill();u.stroke();c.beginPath();var k=c,g=y,h=d.x,n=d.y,v=d.width,e=d.height,d=d.rotation*Math.PI/180;k.translate(h+v/
2,n+e/2);k.rotate(d);k.drawImage(g,v/2*-1,e/2*-1,v,e);k.rotate(-1*d);k.translate(-1*(h+v/2),-1*(n+e/2));f.dispose&&a.particles.splice(b,1)}},10);(function(){f.onload=function(){b.drawImage(f,0,0);console.log("rock loaded")};f.src="/Content/Rock.png";k.onload=function(){d=!0};k.src="/Content/Stone.png";n.addEventListener("mousemove",function(a){a=m(n,a);e(a.x,a.y)},!1);n.addEventListener("mousedown",function(a){a=m(n,a);w=!0;e(a.x,a.y);Connection.mine(a.x,a.y)},!1);n.addEventListener("mouseup",function(a){a=
m(n,a);w=!1;e(a.x,a.y)},!1);n.addEventListener("mouseleave",function(a){a=m(n,a);w=!1;e(a.x,a.y)},!1)})()})(Rock||(Rock={}));var Tabs;
(function(a){function q(){if(n){var b=n.scrollHeight,f=a.bottomPadding+e.clientHeight;b>window.innerHeight-f&&(b=window.innerHeight-f);p.style.minHeight=b+"px";p.style.maxHeight=b+"px";p.style.overflowY=b>=window.innerHeight-f?"scroll":"hidden"}}var m=0,e=document.getElementById("tabContainer"),p=document.getElementById("paneContainer");a.bottomPadding=170;var l=[],n,g=new (function(){function c(a){this.container=a;this.tabs=[];this.lowestId=0;this.id=m++;l.push(this)}c.prototype.newTab=function(f){var c=
new b;c.pane=f;f=document.createElement("DIV");f.classList.add("tab-button");this.container.appendChild(f);c.button=f;0==this.lowestId?c.activate():c.deactivate();var d=this.lowestId++,g=this.id;f.addEventListener("click",function(){a.activateTab(g,d)});this.tabs.push(c);this.container.appendChild(f);return this.lowestId-1};c.prototype.activate=function(a){for(var b=0;b<this.tabs.length;b++)this.tabs[b].deactivate();this.tabs[a].activate()};c.prototype.css=function(a,b){this.tabs[a].button.classList.add(b)};
return c}())(document.getElementById("tabContainer"));a.registerGameTab=function(a,b){var k=g.newTab(a);b&&g.css(k,b)};a.updateGameTabs=q;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(q,20);a.activateTab=function(a,b){l[a].activate(b);q()};var b=function(){function a(){}a.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};a.prototype.activate=function(){Utils.cssSwap(this.button,"inactive",
"active");this.pane.style.display="block";this.pane.style.overflow="visible";n=this.pane};return a}()})(Tabs||(Tabs={}));var Chat;
(function(a){function q(){if(!e){e=document.createElement("DIV");e.classList.add("chat-window");e.classList.add("social");e.id="chatWindow";e.style.backgroundColor="#ebebeb";e.style.border="1px solid #adadad";var a=document.createElement("DIV");a.classList.add("chat-header");a.style.backgroundColor="rgb(160, 160, 160)";e.appendChild(a);var g=document.createElement("DIV");g.textContent="_";g.style.position="absolute";g.style.top="0";g.style.right="0";g.addEventListener("click",function(){e.classList.contains("closed")?
(e.classList.remove("closed"),g.textContent="_"):(e.classList.add("closed"),g.textContent="+")});a.appendChild(g);var b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent="General";b.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});a.appendChild(b);b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent=">Dev";b.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});b.style.display="none";a.appendChild(b);l=document.createElement("DIV");l.id="debugpane";l.classList.add("chat-room");l.style.display="none";e.appendChild(l);p=document.createElement("DIV");p.id="chatpane";p.classList.add("chat-room");e.appendChild(p);a=document.createElement("DIV");a.id="debuglog";a.classList.add("chat-room-content");l.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.classList.add("chat-room-content");
p.appendChild(a);a=document.createElement("DIV");b=document.createElement("DIV");b.classList.add("chat-textbox-container");var c=document.createElement("INPUT");c.setAttribute("TYPE","TEXT");c.classList.add("chat-textbox");c.style.borderTop="1px solid #adadad";c.setAttribute("maxlength","220");c.addEventListener("keydown",function(a){13==a.keyCode&&m();68==a.keyCode&&a.altKey&&(document.getElementById("debugtab").style.display="inline-block")});c.id="chattext";b.appendChild(c);a.appendChild(b);b=
document.createElement("DIV");b.classList.add("chat-submit-container");c=document.createElement("INPUT");c.setAttribute("TYPE","BUTTON");c.setAttribute("VALUE","SEND");c.classList.add("chat-submit");c.style.borderTop="1px solid #adadad";c.style.borderLeft="1px solid #adadad";c.addEventListener("click",function(){m()});b.appendChild(c);a.appendChild(b);e.appendChild(a);document.body.appendChild(e)}}function m(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var e,p,l;a.initialize=q;q();a.log=function(a){var g=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;g.appendChild(b)};a.receiveGlobalMessage=function(a,g,b,c){var f=document.getElementById("chatlog"),k=5>Math.abs(f.scrollTop-(f.scrollHeight-f.offsetHeight)),d=document.createElement("DIV");d.classList.add("chat-msg");c&&""!=c&&d.classList.add("chat-"+c);c=document.createElement("SPAN");c.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");
b.textContent=a;b.classList.add("chat-sender");a=document.createElement("SPAN");a.textContent=g;a.classList.add("chat-text");g=document.createElement("SPAN");g.textContent=": ";d.appendChild(c);d.appendChild(b);d.appendChild(g);d.appendChild(a);f.appendChild(d);k&&(f.scrollTop=f.scrollHeight)}})(Chat||(Chat={}));var tooltip;
(function(a){function q(a,d){var f=b.getBoundingClientRect(),c=f.right-f.left,f=f.bottom-f.top;b.style.left=c+(a+15)>window.innerWidth?a-c-15+"px":a+15+"px";b.style.top=0<d-f?d-f+"px":d+5+"px"}function m(){b&&b.parentElement.removeChild(b);g=b=null}function e(a,b,d){var f=new r;p(a);d&&(f.header=d);f.content=b;n.push(f);a.dataset?a.dataset.tooltip=l:a.setAttribute("data-tooltip",l.toString());l++}function p(a){a.onmouseenter=function(a){var e=+a.target.getAttribute("data-tooltip");h!==a.target&&(c=
setInterval(function(){f+=.01;if(.25<=f){var a=k,h=d,l=n[e];g!==e&&m();g=e;b=l.html;document.body.appendChild(b);q(a,h);f=0;clearInterval(c);c=null}},10));h=a.target};a.onmousemove=function(a){a=a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:a.clientX||a.clientY?{x:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;c||q(a.x,a.y);k=a.x;d=a.y};a.onmouseleave=function(a){h=null;clearInterval(c);f=0;m()}}var l=
0,n=[],g,b,c,f=0,k,d,h,r=function(){function a(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(a.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(a){a.classList.add("tooltip-header");this.html.appendChild(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(a){a.classList.add("tooltip-content");
this.html.appendChild(a)},enumerable:!0,configurable:!0});return a}();a.complexModify=function(a,b,d){a=n[a];d&&(a.header.parentElement.removeChild(a.header),a.header=d);a.content.parentElement.removeChild(a.content);a.content=b};a.modify=function(a,b,d){a=n[a];d&&(a.header.textContent=d);a.content.textContent=b};a.retrieveContent=function(a){return n[a].content};a.complexCreate=e;a.create=function(a,b,d){var f=document.createElement("div");f.textContent=b;d?(b=document.createElement("div"),b.textContent=
d,e(a,f,b)):e(a,f)}})(tooltip||(tooltip={}));var Inventory;
(function(a){function q(a){Connection.sellItem(f.id,a?a:1)}function m(){var b=document.getElementById("selecteditemquantity"),d=+b.value;Utils.isNumber(d)&&d>a.getSelectedItemQuantity()&&(b.value=a.getSelectedItemQuantity().toString())}function e(){n=document.createElement("DIV");document.getElementById("paneContainer").appendChild(n);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var e=document.createElement("SPAN");e.textContent="x";e.style.top="0px";e.style.right=
"3px";e.style.position="absolute";e.addEventListener("click",function(){a.selectItem()});b.appendChild(e);c=document.createElement("DIV");c.classList.add("selected-item-image");e=document.createElement("INPUT");e.id="selecteditemquantity";e.type="text";e.style.height="18px";e.classList.add("selected-item-quantity");e.addEventListener("input",function(){m()});h=Utils.createButton("Drink","");h.classList.add("selected-item-quantity");h.addEventListener("click",function(){Connection.drink(f.id);m()});
var l=Utils.createButton("Sell","");l.classList.add("selected-item-quantity");l.addEventListener("click",function(){var b=+document.getElementById("selecteditemquantity").value;Utils.isNumber(b)&&a.sellSelectedItem(b);m()});var t=Utils.createButton("Sell all","");t.classList.add("selected-item-quantity");t.addEventListener("click",function(){a.sellAllSelectedItem();m()});b.appendChild(c);b.appendChild(t);b.appendChild(l);b.appendChild(h);b.appendChild(e);n.appendChild(b);e=document.createElement("DIV");
e.style.textAlign="center";l=document.createElement("DIV");l.style.display="inline-block";t=Utils.createButton("Sell (...)","");t.addEventListener("click",function(){Connection.sellAllItems()});var p=Utils.createButton("...","");p.addEventListener("click",function(){a.toggleConfig()});l.appendChild(t);l.appendChild(p);e.appendChild(l);n.appendChild(e);d=document.createElement("DIV");d.classList.add("config-container");d.classList.add("closed");e=document.createElement("TABLE");e.classList.add("config-table");
d.appendChild(e);t=e.createTHead();l=t.insertRow(0);t=t.insertRow(0);t.classList.add("table-header");t=t.insertCell(0);t.textContent="Inventory Configuration";t.setAttribute("colspan","10");l.classList.add("table-subheader");for(var q in x)0<=parseInt(q,10)&&"NFS"!=x[q]&&(l.insertCell(l.cells.length).classList.add("config-cell-check"),t=l.insertCell(l.cells.length),t.classList.add("config-cell-name"),t.textContent=x[q]);k=e.createTBody();g=document.createElement("DIV");g.style.position="relative";
g.appendChild(d);n.appendChild(g);Tabs.registerGameTab(n,"Inventory");Equipment.draw()}function p(a){var b=document.createElement("DIV");a.container=b;b.classList.add("header-item");var d=document.createElement("DIV");d.style.width="32px";d.style.height="32px";d.style.display="inline-block";d.style.position="relative";d.style.margin="0 auto";var f=document.createElement("DIV");f.classList.add("Half-"+a.name.replace(" ","_"));d.appendChild(f);b.appendChild(d);d=document.createElement("DIV");a.quantityElm=
d;d.classList.add("item-text");d.textContent=Utils.formatNumber(0);d.style.verticalAlign="top";d.style.marginTop="8px";d.style.display="inline-block";b.appendChild(d);d=document.createElement("DIV");d.style.display="none";a.worthElm=d;b.appendChild(d);return b}function l(b){if(0==b.category||null==b.category)return p(b);var d=document.createElement("DIV");b.container=d;d.classList.add("item");d.addEventListener("click",function(){a.selectItem(b.id)});tooltip.create(d,b.name);var f=document.createElement("DIV");
f.classList.add("item-text");var c=document.createElement("DIV");c.style.verticalAlign="top";c.style.display="inline-block";c.textContent=Utils.formatNumber(b.worth);b.worthElm=c;var g=document.createElement("DIV");g.classList.add("Quarter-Coins");g.style.display="inline-block";f.appendChild(g);f.appendChild(c);d.appendChild(f);c=document.createElement("DIV");c.style.width="64px";c.style.height="64px";c.style.position="relative";c.style.margin="0 auto";f=document.createElement("DIV");f.classList.add(b.name.replace(" ",
"_"));c.appendChild(f);d.appendChild(c);f=document.createElement("DIV");b.quantityElm=f;f.classList.add("item-text");f.textContent=Utils.formatNumber(0);d.appendChild(f);if(null!=b.category){var h,e,c=k.rows.length,f=b.category,f=2*f;f--;for(g=0;g<c;g++){var n=k.rows[g].cells[f];if(n&&0==n.childElementCount){h=k.rows[g].cells[f];e=k.rows[g].cells[f-1];break}}if(!h){e=k.insertRow(k.rows.length);e.classList.add("table-row");for(var l in x)0<=parseInt(l,10)&&"NFS"!=x[l]&&(e.insertCell(e.cells.length).classList.add("config-cell-check"),
e.insertCell(e.cells.length).classList.add("config-cell-name"));h=e.cells[f];e=e.cells[f-1]}l=document.createElement("DIV");l.classList.add("item-text");l.style.height="auto";c=document.createElement("SPAN");c.style.verticalAlign="top";f=document.createElement("DIV");f.classList.add("Third-"+Utils.cssifyName(b.name));f.style.display="inline-block";s[b.id]=f;c.textContent=b.name;r[b.id]=c;l.appendChild(f);l.appendChild(c);h.appendChild(l);h=document.createElement("INPUT");h.type="CHECKBOX";var m=b.id;
a.configClickers[m]=h;h.addEventListener("change",function(b){Connection.configureItem(m,a.configClickers[m].checked)});e.appendChild(h)}return d}a.items=[];a.configClickers=[];var n,g,b,c,f,k,d,h,r=[],s=[],w=function(){return function(a,b,d,f){this.id=a;this.name=b;this.worth=d;this.category=f}}();a.Item=w;(function(a){a[a.NFS=0]="NFS";a[a.ORE=1]="ORE";a[a.GEM=2]="GEM";a[a.INGREDIENT=3]="INGREDIENT";a[a.CRAFTING=4]="CRAFTING";a[a.POTION=5]="POTION"})(a.Category||(a.Category={}));var x=a.Category;
a.getSelectedItemQuantity=function(){return f?f.quantity:0};a.selectItem=function(d){d?(null!=f&&c.classList.remove(Utils.cssifyName(f.name)),f=a.items[d],c.classList.add(Utils.cssifyName(f.name)),h.style.display=5==f.category?"inline-block":"none",m()):(c.classList.remove(Utils.cssifyName(f.name)),f=null);b.style.display=null==f?"none":"block"};a.sellSelectedItem=q;a.sellAllSelectedItem=function(){q(f.quantity)};a.modifyConfig=function(b,d){a.configClickers[b].checked=d};a.toggleConfig=function(){d.classList.contains("closed")?
d.classList.remove("closed"):d.classList.add("closed")};a.addItem=function(b,d,f,c){a.items[b]||(b=new w(b,d,f,c),a.items[b.id]=b,Objects.register(b.id,b.name),n||e(),0!=b.category&&null!=b.category?g.appendChild(l(b)):document.getElementById("headerInventory").appendChild(l(b)))};a.changePrice=function(b,d){Utils.ifNotDefault(d,function(){var f=a.items[b];f.worth=d;f.worthElm.textContent=Utils.formatNumber(d)})};a.changeQuantity=function(b,d){Utils.ifNotDefault(d,function(){Objects.setQuantity(b,
d);Crafting.update();a.items[b].quantityElm.textContent=Utils.formatNumber(d);a.items[b].quantity=d;a.items[b].container.style.display=0!=a.items[b].category&&null!=a.items[b].category?0==d?"none":"inline-block":0==Objects.getLifeTimeTotal(b)?"none":"inline-block";m()})};setInterval(function(){0>=r.length||a.items.forEach(function(a){var b=Objects.getLifeTimeTotal(a.id);r[a.id]&&(r[a.id].textContent=0<b?a.name:"???");s[a.id]&&(s[a.id].style.display=0<b?"inline-block":"none")})},1E3)})(Inventory||
(Inventory={}));var Statistics;
(function(a){function q(){var a=document.createElement("TABLE"),g=a.createTHead(),b=g.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");g=g.insertRow(1);g.classList.add("table-subheader");b=g.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=g.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";g=g.insertCell(0);g.textContent="Item";g.style.width="20%";e=a.createTBody();return a}var m,e,
p=[],l=function(){return function(){}}();a.changeStats=function(a,g,b){var c=p[a];Utils.ifNotDefault(g,function(){c.prestigeQuantity=g;c.prestigeRow.textContent=Utils.formatNumber(g)});Utils.ifNotDefault(b,function(){c.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);c.alltimeRow.textContent=Utils.formatNumber(b);c.row.style.display=0<b?"table-row":"none"})};a.addItem=function(a,g){m||(m=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(m),Tabs.registerGameTab(m,"Statistics"),
m.appendChild(q()));if(!p[a]){var b=new l;p[a]=b;var c=e.insertRow(e.rows.length);c.classList.add("table-row");b.row=c;b.alltimeRow=c.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=c.insertCell(0);b.prestigeRow.style.width="40%";b=c.insertCell(0);b.style.width="20%";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(g));c.style.display="inline-block";b.appendChild(c)}}})(Statistics||(Statistics={}));var Store;
(function(a){function q(){e=document.createElement("div");document.getElementById("paneContainer").appendChild(e);Tabs.registerGameTab(e,"Store");for(var a in n)if(0<=parseInt(a,10)){var c=n[a];if("CRAFTING"!=c){var f=document.createElement("div");f.classList.add("store-category");l[c]=f;var k=document.createElement("div");k.textContent=c;k.classList.add("store-category-header");f.appendChild(k);e.appendChild(f)}}}function m(a){var c=document.createElement("div");"undefined"!=a.tooltip&&tooltip.create(c,
a.tooltip);c.classList.add("store-item");a.container=c;var f=document.createElement("div");f.classList.add("store-item-header");var k=document.createElement("div");k.classList.add("store-item-header-text");k.textContent=a.name;f.appendChild(k);var d=document.createElement("div");d.classList.add("store-item-header-quantity-container");var g=document.createElement("span");g.classList.add("store-item-header-quantity");var e=document.createElement("span");e.classList.add("store-item-header-quantity");
var l=document.createElement("span");l.classList.add("store-item-header-quantity");l.textContent="/";1<a.maxQuantity&&(d.appendChild(e),d.appendChild(l),d.appendChild(g));f.appendChild(d);a.maxQuantityElm=g;a.quantityElm=e;a.nameElm=k;c.appendChild(f);f=document.createElement("DIV");f.style.width="64px";f.style.height="64px";f.style.position="relative";f.style.margin="0 auto";k=document.createElement("DIV");k.classList.add(Utils.cssifyName(a.name));f.appendChild(k);c.appendChild(f);f=document.createElement("div");
f.classList.add("store-item-footer");k=document.createElement("div");k.classList.add("item-text");d=document.createElement("div");d.textContent=Utils.formatNumber(a.price);d.style.display="inline-block";d.style.verticalAlign="top";a.priceElm=d;g=document.createElement("div");g.classList.add("Quarter-Coins");g.style.display="inline-block";k.appendChild(g);k.appendChild(d);var d=document.createElement("div"),g=Utils.createButton("Buy",""),n=a.id;if(5!=a.category)g.addEventListener("click",function(){Connection.purchaseItem(n)});
else{var m=document.createElement("INPUT");m.type="TEXT";m.style.width="40px";m.style.height="15px";d.appendChild(m);g.addEventListener("click",function(){Utils.isNumber(m.value)&&Connection.purchaseItem(n,+m.value)})}d.appendChild(g);f.appendChild(d);f.appendChild(k);c.appendChild(f);return c}var e,p=[],l=[];(function(a){a[a.MINING=1]="MINING";a[a.MACHINES=2]="MACHINES";a[a.GATHERING=3]="GATHERING";a[a.PROCESSING=4]="PROCESSING";a[a.ITEMS=5]="ITEMS";a[a.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category=
{}));var n=a.Category,g=function(){return function(){}}();a.tempFix=function(){q()};a.addItem=function(a,c,f,k,d,h,r){e||q();if(!p[a]){Objects.register(a,d);var s=new g;s.id=a;s.category=c;s.price=f;s.factor=k;s.name=d;s.tooltip=r;s.maxQuantity=h?h:0;Objects.register(s.id,s.name);Objects.setTooltip(s.id,s.tooltip);2==s.category&&Equipment.registerGatherer(s.id);c=l[n[c]];null==c&&(c=l.MINING);6!=s.category&&c.appendChild(m(s));p[a]=s}};a.changeQuantity=function(a,c,f,k){var d=p[a];Utils.ifNotDefault(f,
function(){if(0!=f)try{Equipment.changeMaxQuantity(a,f),d.maxQuantity=f,d.maxQuantityElm.textContent=f.toString()}catch(c){}});Utils.ifNotDefault(c,function(){Objects.setQuantity(a,c);d.quantity=c;Crafting.update();Equipment.changeQuantity(a,c);0!=f&&6!=d.category&&(d.container.style.display=-1>=d.quantity||d.quantity>=d.maxQuantity&&0<d.maxQuantity?"none":"inline-block",d.maxQuantity&&1<d.maxQuantity&&(d.quantityElm.textContent=c.toString()))});Utils.ifNotDefault(k,function(){d.priceElm&&(d.price=
k,d.priceElm.textContent=Utils.formatNumber(k))})}})(Store||(Store={}));var Equipment;
(function(a){function q(){l=document.createElement("div");l.classList.add("store-category");var a=document.createElement("div");a.classList.add("store-category-header");a.textContent="Gatherers";l.appendChild(a);p.appendChild(l)}function m(a){l||q();var b=e[a];b.container=document.createElement("div");b.container.classList.add("equipment-gatherer-container");var c=document.createElement("div");c.classList.add("store-item-header");var f=document.createElement("div");f.classList.add("store-item-header-text");
f.textContent=Objects.lookupName(a);c.appendChild(f);f=Utils.createButton("Disable","");f.addEventListener("click",function(){Connection.toggleGatherer(a,!b.enabled)});var k=document.createElement("div");k.classList.add("store-item-header-quantity-container");b.quantityElm=document.createElement("span");var d=document.createElement("span");d.textContent="/";b.maxQuantityElm=document.createElement("span");k.appendChild(b.quantityElm);k.appendChild(d);k.appendChild(b.maxQuantityElm);c.appendChild(k);
b.container.appendChild(c);b.efficiencyElm=document.createElement("div");b.container.appendChild(b.efficiencyElm);b.fuelConsumptionElm=document.createElement("div");b.container.appendChild(b.fuelConsumptionElm);b.rarityBonusElm=document.createElement("div");b.container.appendChild(b.rarityBonusElm);b.container.appendChild(f);b.toggleElm=f.firstChild;l.appendChild(b.container)}var e=[],p,l,n=function(){return function(){}}();a.draw=function(){p||(p=document.createElement("div"),document.getElementById("paneContainer").appendChild(p),
Tabs.registerGameTab(p,"Equipment"))};a.registerGatherer=function(a){if(!e[a]){var b=new n;e[a]=b;m(a)}};a.toggleGatherer=function(a,b){var c=e[a];c&&(c.enabled=b,c.toggleElm.textContent=b?"Disable":"Enable")};a.changeQuantity=function(a,b){Utils.ifNotDefault(b,function(){var c=e[a];c&&(c.quantity=b,c.container.style.display=-1<b?"inline-block":"none",c.quantityElm.textContent=Utils.formatNumber(b))})};a.changeMaxQuantity=function(a,b){Utils.ifNotDefault(b,function(){var c=e[a];c&&(c.maxQuantity=
b,c.maxQuantityElm.textContent=Utils.formatNumber(b))})};a.changeFuelConsumption=function(a,b){Utils.ifNotDefault(b,function(){var c=e[a];c&&(c.fuelConsumption=b,c.fuelConsumptionElm.textContent="Fuel consumed: "+Utils.formatNumber(b))})};a.changeEfficiency=function(a,b){Utils.ifNotDefault(b,function(){var c=e[a];c&&(c.efficiency=b,c.efficiencyElm.textContent="Resources/s: "+Utils.formatNumber(b))})};a.changeRarityBonus=function(a,b){Utils.ifNotDefault(b,function(){var c=e[a];c&&(c.rarityBonus=b,
c.rarityBonusElm.textContent="Rarity multi: x"+Utils.formatNumber(b))})}})(Equipment||(Equipment={}));var Crafting;
(function(a){function q(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);Tabs.registerGameTab(g,"Crafting");b=document.createElement("DIV");g.appendChild(b);c=document.createElement("DIV");g.appendChild(c);f=document.createElement("TABLE");f.classList.add("block-table");var a=f.createTHead(),e=a.insertRow(0);e.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=k.length;a.textContent="Crafting Table";
for(a=0;a<k.length;a++){var l=e.insertCell(0);l.style.width=d[a];l.textContent=k[a];"0"!=h[a]&&(l.style.minWidth=h[a])}e=f.insertRow(2);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=k.length;e.textContent="Items";e=f.insertRow(3);e.classList.add("table-subheader");e=e.insertCell(0);e.colSpan=k.length;e.textContent="Upgrades";c.appendChild(f)}function m(b,d){var f=a.processors[b];if(f){var c=f._recipes[d];for(f.selectedRecipe=d;f.recipeList.lastChild;)f.recipeList.removeChild(f.recipeList.lastChild);
for(var k=0;k<c.ingredients.length;k++){var g=document.createElement("DIV");g.classList.add("item-text");g.style.height="30px";var e=document.createElement("DIV");e.style.display="inline-block";var h=document.createElement("DIV");c.ingredients[k].quantityDiv=h;h.style.display="inline-block";h.style.verticalAlign="super";var l=n.fromNumber(c.ingredients[k].quantity).lessThanOrEqual(n.fromNumber(Objects.getQuantity(c.ingredients[k].id)));h.style.color=l?"darkgreen":"darkred";h.textContent=Utils.formatNumber(c.ingredients[k].quantity);
e.classList.add("Half-"+Utils.cssifyName(Objects.lookupName(c.ingredients[k].id)));g.appendChild(e);g.appendChild(h);f.recipeList.appendChild(g)}}}function e(a){var f=document.createElement("TABLE");f.classList.add("block-table");a.container=f;var c=f.createTHead(),g=c.insertRow(0);g.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=k.length;c.textContent=a.name;for(c=0;c<k.length;c++){var e=g.insertCell(0);e.style.width=s[c];e.textContent=
r[c];"0"!=s[c]&&(e.style.minWidth=w[c])}c=f.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=r.length;e=document.createElement("DIV");e.classList.add("progress-bar-container");g=document.createElement("DIV");g.classList.add("progress-bar");var h=document.createElement("DIV");h.classList.add("progress-bar-text-container");var l=document.createElement("DIV");l.classList.add("progress-bar-text");h.appendChild(l);e.appendChild(h);a.progressBar=g;a.progressText=l;e.appendChild(g);
c.appendChild(e);g=f.insertRow(3);g.classList.add("table-row");for(c=0;c<r.length;c++){e=g.insertCell(0);e.style.width=d[c];e.style.height="75px";"0"!=w[c]&&(e.style.minWidth=w[c]);"Image"==r[c]&&(h=document.createElement("DIV"),h.classList.add(Utils.cssifyName(a.name)),h.style.margin="0 auto",e.appendChild(h));"Capacity"==r[c]&&(e.textContent="0",a.capacityElm=e);"Input"==r[c]&&(a.recipeList=e);if("Output"==r[c]){h=Utils.createButton("Max","");e.appendChild(h);h=document.createElement("INPUT");h.type=
"TEXT";h.style.width="35px";a.quantityTextbox=h;e.appendChild(h);var n=a.id,q=document.createElement("SELECT");q.addEventListener("change",function(a){m(n,q.selectedIndex)});a.recipeSelector=q;e.appendChild(q)}"Action"==r[c]&&(h=Utils.createButton("Activate",""),h.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),e.appendChild(h))}p(a);b.appendChild(f)}function p(a){t||(t=document.createElement("div"),
z.appendChild(t));var b=document.createElement("div");b.classList.add("processor-sidebar");a.sidebarContainer=b;var d=document.createElement("div");d.classList.add("buff-header");d.textContent=a.name;b.appendChild(d);d=document.createElement("div");d.classList.add("processor-sidebar-progress-bar-container");var f=document.createElement("div");f.classList.add("processor-sidebar-progress-bar");a.sidebarProgressBar=f;var c=document.createElement("div");c.classList.add("processor-sidebar-progress-text");
a.sidebarProgressText=c;d.appendChild(c);d.appendChild(f);b.appendChild(d);d=document.createElement("div");d.classList.add("processor-sidebar-progress-bar-container");f=document.createElement("div");f.classList.add("processor-sidebar-progress-bar");a.sidebarJobBar=f;c=document.createElement("div");c.classList.add("processor-sidebar-progress-text");a.sidebarJobText=c;d.appendChild(c);d.appendChild(f);b.appendChild(d);b.style.display="none";t.appendChild(b)}function l(a,b){var c=f.rows.length;b&&(c=
x,x++);c=f.insertRow(c);c.classList.add("table-row");a.row=c;for(var e=0;e<k.length;e++){var g=c.insertCell(0);g.style.width=d[e];"0"!=h[e]&&(g.style.minWidth=h[e]);"Name"==k[e]&&(g.textContent=Objects.lookupName(a.id));if("Input"==k[e])for(var l=0;l<a.ingredients.length;l++){var n=document.createElement("DIV");n.classList.add("item-text");n.style.height="auto";var m=document.createElement("DIV");m.style.display="inline-block";var p=document.createElement("DIV");a.ingredients[l].quantityDiv=p;p.style.display=
"inline-block";p.style.verticalAlign="super";p.textContent=Utils.formatNumber(a.ingredients[l].quantity);m.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.ingredients[l].id)));n.appendChild(m);n.appendChild(p);g.appendChild(n)}"Description"==k[e]&&(g.textContent=Objects.getTooltip(a.resultants[0].id));if("Output"==k[e])for(l=0;l<a.resultants.length;l++)n=document.createElement("DIV"),n.classList.add("item-text"),n.style.height="auto",m=document.createElement("DIV"),m.style.display="inline-block",
p=document.createElement("DIV"),p.style.display="inline-block",p.style.verticalAlign="super",p.textContent=Utils.formatNumber(a.resultants[l].quantity),m.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(a.resultants[l].id))),n.appendChild(m),a.isItem&&n.appendChild(p),g.appendChild(n);if("Action"==k[e]&&(l=Utils.createButton("Craft",""),l.addEventListener("click",function(){Connection.craftRecipe(a.id,1)},!1),g.appendChild(l),a.isItem)){var q=document.createElement("INPUT");q.type="TEXT";
q.style.width="30px";l=Utils.createButton("Craft-x","");l.addEventListener("click",function(){Connection.craftRecipe(a.id,+q.value)},!1);g.appendChild(l);g.appendChild(q)}}}var n=dcodeIO.Long,g,b,c,f,k=["Action","Description","Input","Output","Name"],d=["10%","50%","15%","15%","10%"],h=["170px","0","0","0","0"],r=["Action","Output","Input","Capacity","Image"],s=["10%","30%","20%","20%","20%"],w=["170px","0","0","0","0"],x=3,v=[];a.processors=[];var z=document.getElementById("sidebarInformation"),
t,B=function(){function a(){this._recipes=[]}a.prototype.addRecipe=function(a){this._recipes.push(a);this.selectedRecipe||(this.selectedRecipe=0)};return a}();a.Processor=B;var A=function(){function a(){this.ingredients=[];this.resultants=[]}a.prototype.addIngredient=function(a){this.ingredients.push(a)};a.prototype.addResultant=function(a){this.resultants.push(a)};return a}();a.Recipe=A;var y=function(){return function(a,b){this.id=a;this.quantity=b}}();a.Ingredient=y;a.addRecipe=function(a,b,d,
f){g||q();if(!v[a]){var c=new A;c.id=a;c.isItem=f;v[a]=c;for(a=0;a<b.length;a++)c.addIngredient(new y(b[a].Id,b[a].Quantity));for(a=0;a<d.length;a++)c.addResultant(new y(d[a].Id,d[a].Quantity));l(c,f)}};a.addProcessor=function(b,d,f){g||q();if(!a.processors[b]){var c=new B;c.id=b;c.name=d;c.requiredId=f;a.processors[b]=c;e(c)}};a.addProcessorRecipe=function(b,d,f){if(a.processors[b]){var c=a.processors[b],e;a:if(a.processors[b]){e=a.processors[b];for(var k=0;k<e._recipes.length;k++)if(f[0].Id==e._recipes[k].resultants[0].id){e=
!0;break a}e=!1}else e=void 0;if(!e){e=new A;for(k=0;k<d.length;k++)e.addIngredient(new y(d[k].Id,d[k].Quantity));for(k=0;k<f.length;k++)e.addResultant(new y(f[k].Id,f[k].Quantity));c.addRecipe(e);d=document.createElement("OPTION");d.textContent=Objects.lookupName(f[0].Id);c.recipeSelector.appendChild(d);1==c._recipes.length&&m(b,0)}}};a.updateProcessor=function(b,d,f,c,k,e){var g=a.processors[b];if(g){var h=!1;Utils.ifNotDefault(d,function(){g.selectedRecipe=d});Utils.ifNotDefault(k,function(){g.totalOperations=
k;h=!0});Utils.ifNotDefault(f,function(){g.operationDuration=f});Utils.ifNotDefault(e,function(){g.capacityElm.textContent=e.toString()});Utils.ifNotDefault(c,function(){g.completedOperations=c;h=!0});if(h){if(0>=g.totalOperations||g.completedOperations==g.totalOperations){g.progressBar.style.width="0%";g.progressText.textContent="";g.sidebarProgressText.textContent="";g.sidebarContainer.style.display="none";g.totalOperationCompletionTime=0;return}g.sidebarContainer.style.display="inline-block";g.operationStartTime=
Date.now();g.operationCompletionTime=g.operationStartTime+1E3*g.operationDuration;0==g.totalOperationCompletionTime&&(g.totalOperationCompletionTime=g.operationStartTime+1E3*g.operationDuration*(g.totalOperations-g.completedOperations))}if(-1<g.selectedRecipe)try{g.progressText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+" ("+g.completedOperations+"/"+g.totalOperations+")",g.sidebarJobText.textContent=Objects.lookupName(g._recipes[g.selectedRecipe].resultants[0].id)+
" ("+g.completedOperations+"/"+g.totalOperations+")"}catch(l){console.log("invalid processor recipe "+g.selectedRecipe)}else g.progressText.textContent="",g.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(a){if(0>=a.operationDuration)a.progressBar.style.width="0%";else if(a.completedOperations!=a.totalOperations&&0<a.totalOperations){var b=a.operationCompletionTime-Date.now(),b=b/1E3,d=a.totalOperationCompletionTime-Date.now(),f=d/(a.operationDuration*a.totalOperations),
b=b/a.operationDuration,b=100-100*b;a.progressBar.style.width=b+"%";a.sidebarJobBar.style.width=b+"%";a.sidebarProgressBar.style.width=100-f/10+"%";a.sidebarProgressText.textContent=Utils.formatTime(d/1E3)}0!=a.requiredId&&(a.container.style.display=0<Objects.getQuantity(a.requiredId)?"block":"none")})},10);a.update=function(){g&&(v.forEach(function(a){var b=Objects.getQuantity(a.id);a.row.style.display=-1==b||!a.isItem&&0<b?"none":"";a.ingredients.forEach(function(a){var b=Objects.getQuantity(a.id),
b=n.fromNumber(a.quantity).lessThanOrEqual(n.fromNumber(b));a.quantityDiv.style.color=b?"darkgreen":"darkred"})}),a.processors.forEach(function(a){m(a.id,a.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));var Buffs;
(function(a){var q=[],m=document.getElementById("sidebarInformation"),e,p=function(){return function(){}}();a.register=function(a,n,g,b){if(!q[a]){var c=new p;c.name=n;c.description=g;c.duration=b;q[a]=c;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,c.description);n=document.createElement("div");n.textContent=c.name;n.classList.add("buff-header");a.appendChild(n);n=document.createElement("div");n.classList.add("buff-image-container");a.appendChild(n);g=document.createElement("div");
g.classList.add(Utils.cssifyName(c.name));n.appendChild(g);n=document.createElement("div");n.classList.add("buff-header");a.appendChild(n);e.appendChild(a);c.container=a;c.durationElm=n}};a.update=function(a,e){var g=q[a];g.timeActive=e;g.durationElm.textContent="("+Utils.formatTime(g.duration-e)+")";g.container.style.display=0==e?"none":"inline-block"};e=document.createElement("div");m.appendChild(e)})(Buffs||(Buffs={}));var Achievements;
(function(a){function q(){e.forEach(function(a){null!=a.requires&&(a.requires.requiredBy=a)})}function m(a){a/=60;if(60>a)return Math.max(Math.ceil(a),1)+" minutes";a/=60;if(24>a)return Math.max(Math.ceil(a),1)+(1>=a?" hour":" hours");a/=24;if(30>a)return Math.max(Math.ceil(a),1)+(1>=a?" day":" days");a/=30;if(12>a)return Math.max(Math.ceil(a),1)+(1>=a?" month":" months")}var e=[],p,l=!1;(function(a){a[a.Undefined=0]="Undefined";a[a.Money=1]="Money";a[a.TimePlayed=2]="TimePlayed";a[a.RockClicks=3]=
"RockClicks";a[a.Oil=4]="Oil"})(a.Category||(a.Category={}));var n=function(){function a(){}a.prototype.getTooltip=function(){if(1==this.category)return"Have a total of "+Utils.formatNumber(this.goal)+" accumulated coins.";if(2==this.category)return"Play for "+m(this.goal)+".";if(3==this.category)return"Click the rock "+Utils.formatNumber(this.goal)+" times.";if(4==this.category)return 1==this.goal?"Get some oil!":"Have a total of "+Utils.formatNumber(this.goal)+" accumulated oil."};a.prototype.trickleDown=
function(a){a||(a=this.progress);this.progress=a;this.progressBar.style.width=a/this.goal*100+"%";this.progressText.textContent=Utils.formatNumber(Math.min(a,this.goal))+"/"+Utils.formatNumber(this.goal);null!=this.requiredBy&&this.requiredBy.trickleDown(a)};return a}();a.register=function(a,b,c,f,k){if(!e[a]){var d=new n;d.name=b;0!=c&&(d.requires=e[c]);d.goal=f;d.category=k;p||(p=document.createElement("div"),document.getElementById("paneContainer").appendChild(p),Tabs.registerGameTab(p,"Achievements"));
b=document.createElement("div");b.classList.add("achievement");d.container=b;c=document.createElement("div");c.classList.add("achievement-image");b.appendChild(c);c=document.createElement("div");c.classList.add("achievement-body");b.appendChild(c);f=document.createElement("div");f.classList.add("achievement-title");f.textContent=d.name;c.appendChild(f);f=document.createElement("div");f.classList.add("achievement-description");f.textContent=d.getTooltip();c.appendChild(f);f=document.createElement("div");
f.classList.add("achievement-progress-container");c.appendChild(f);c=document.createElement("div");c.classList.add("achievement-progress-text");d.progressText=c;f.appendChild(c);c=document.createElement("div");c.classList.add("achievement-progress");c.style.width="0%";f.appendChild(c);d.progressBar=c;p.appendChild(b);e[a]=d}};a.updateAchievement=function(a,b){l||(q(),l=!0);var c=e[a];c&&(b||(b=0),c.progress=b,c.trickleDown(b))}})(Achievements||(Achievements={}));var Market;
(function(a){var q,m=function(){return function(){}}();a.Order=m;a.drawTradePane=function(a){q||(q=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(q),Tabs.registerGameTab(q,"Market"));var m=document.createElement("div");m.classList.add("market-order");m.classList.add("closed");var l=document.createElement("div");l.textContent="Empty";l.classList.add("market-order-header");a.header=l;m.appendChild(l);a=document.createElement("div");a.classList.add("market-order-controls");
l=document.createElement("div");l.classList.add("market-control");l.classList.add("buy");l.textContent="Buy";a.appendChild(l);l=document.createElement("div");l.classList.add("market-control");l.classList.add("sell");l.textContent="Sell";a.appendChild(l);m.appendChild(a);a=document.createElement("div");a.classList.add("market-order-display");m.appendChild(a);q.appendChild(m)}})(Market||(Market={}));var Connection;
(function(a){function q(){console.log("Connection opened");var a=c.encode64();m(a);c=new Komodo.ClientActions;p=setInterval(function(){var a=c.encode64();m(a);c=new Komodo.ClientActions},1E3)}function m(a){if(a.encode64){var b=a.encode64();Chat.log("Sent "+e(b)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+e(a)+" bytes to komodo."),Komodo.send(a)}function e(a){var b=[];a=[a];for(var d=
0;a.length;){var c=a.pop();if("boolean"===typeof c)d+=4;else if("string"===typeof c)d+=2*c.length;else if("number"===typeof c)d+=8;else if("object"===typeof c&&-1===b.indexOf(c)){b.push(c);for(var e in c)a.push(c[e])}}return d}var p,l,n,g,b;(function(){var a=document.getElementsByClassName("header-links")[0],c=document.createElement("div");c.style.display="inline-block";c.textContent="Version History";c.addEventListener("click",function(){window.open("/version")});c.style.cursor="pointer";a.appendChild(c);
b=document.createElement("div");b.style.display="inline-block";b.textContent="There are 0 players mining.";a.appendChild(b);l=document.createElement("div");l.classList.add("error-notification-tray");n=document.createElement("div");n.classList.add("network-error");a=document.createElement("div");a.classList.add("network-error-text");a.textContent="No connection";n.appendChild(a);g=document.createElement("div");g.classList.add("rate-limited");a=document.createElement("div");a.classList.add("network-error-text");
g.style.display="none";a.textContent="You have exceeded your allotted requests";g.appendChild(a);a=document.getElementById("game");l.appendChild(n);l.appendChild(g);a.insertBefore(l,a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+e(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));Chat.log(e(JSON.stringify(Komodo.decode(a)))-e(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var c=
a.Messages,d=0;d<c.length;d++){var h=c[d];Chat.receiveGlobalMessage(h.Sender,h.Text,h.Time,h.Permissions)}if(null!=a.GameSchema){c=a.GameSchema;if(c.Items)for(d=0;d<c.Items.length;d++)Inventory.addItem(c.Items[d].Id,c.Items[d].Name,c.Items[d].Worth,c.Items[d].Category),Statistics.addItem(c.Items[d].Id,c.Items[d].Name);if(c.StoreItems)for(d=0;d<c.StoreItems.length;d++)h=c.StoreItems[d],Store.addItem(h.Id,h.Category,h.Price,h.Factor,h.Name,h.MaxQuantity,h.Tooltip);if(c.Processors)for(d=0;d<c.Processors.length;d++){h=
c.Processors[d];Crafting.addProcessor(h.Id,h.Name,h.RequiredId);for(var l=0;l<h.Recipes.length;l++)Crafting.addProcessorRecipe(h.Id,h.Recipes[l].Ingredients,h.Recipes[l].Resultants)}if(c.CraftingItems)for(d=0;d<c.CraftingItems.length;d++)h=c.CraftingItems[d],Crafting.addRecipe(h.Id,h.Ingredients,h.Resultants,h.IsItem);if(c.Buffs)for(d=0;d<c.Buffs.length;d++)h=c.Buffs[d],Buffs.register(h.Id,h.Name,h.Description,h.Duration);if(c.Achievements)for(d=0;d<c.Achievements.length;d++)h=c.Achievements[d],console.log(h),
Achievements.register(h.Id,h.Name,h.RequiredId,h.Goal,h.Category)}if(null!=a.Items)for(c=a.Items,d=0;d<c.length;d++)Inventory.changeQuantity(c[d].Id,c[d].Quantity),Inventory.changePrice(c[d].Id,c[d].Worth);if(null!=a.StoreItemsUpdate)for(c=a.StoreItemsUpdate,d=0;d<c.length;d++)Store.changeQuantity(c[d].Id,c[d].Quantity,c[d].MaxQuantity,c[d].Price);if(null!=a.StatItemsUpdate)for(c=a.StatItemsUpdate,d=0;d<c.length;d++)Statistics.changeStats(c[d].Id,c[d].PrestigeQuantity,c[d].LifeTimeQuantity);if(null!=
a.ConfigItems)for(c=a.ConfigItems,d=0;d<c.length;d++)Inventory.modifyConfig(c[d].Id,c[d].Enabled);if(null!=a.Processors)for(c=a.Processors,d=0;d<c.length;d++)h=c[d],Crafting.updateProcessor(h.Id,h.SelectedRecipe,h.OperationDuration,h.CompletedOperations,h.TotalOperations,h.Capacity);null!=a.AntiCheatCoordinates&&(c=a.AntiCheatCoordinates,Rock.moveRock(c.X,c.Y));if(null!=a.Buffs)for(c=a.Buffs,d=0;d<c.length;d++)h=c[d],Buffs.update(h.Id,h.TimeActive);null!=a.IsRateLimited&&(g.style.display=a.IsRateLimited?
"block":"none");if(null!=a.Gatherers)for(c=a.Gatherers,d=0;d<c.length;d++)h=c[d],Equipment.toggleGatherer(h.Id,h.Enabled),Equipment.changeEfficiency(h.Id,h.Efficiency),Equipment.changeFuelConsumption(h.Id,h.FuelConsumed),Equipment.changeRarityBonus(h.Id,h.RarityBonus);a.ConnectedUsers&&(b.textContent="There are "+a.ConnectedUsers+" players mining.");if(a.Achievements)for(a=a.Achievements,c=0;c<a.length;c++)d=a[c],Achievements.updateAchievement(d.Id,d.Progress)});a.restart=function(){Komodo.restart()};
var c=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(q(),n.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(p),n.style.display="block");a.newState===$.signalR.connectionState.reconnecting&&(n.style.display="block")});a.toggleGatherer=function(a,b){var d=new Komodo.ClientActions.GathererAction;d.Id=a;d.Enabled=b;c.GathererActions.push(d)};a.drink=function(a){var b=new Komodo.ClientActions.PotionAction;
b.Id=a;c.PotionActions.push(b)};a.mine=function(a,b){var d=new Komodo.ClientActions.MiningAction;d.X=a;d.Y=b;c.MiningActions.push(d)};a.sellItem=function(a,b){var d=new Komodo.ClientActions.InventoryAction,e=new Komodo.ClientActions.InventoryAction.SellAction;e.Id=a;e.Quantity=b;console.log(b);d.Sell=e;c.InventoryActions.push(d)};a.configureItem=function(a,b){var d=new Komodo.ClientActions.InventoryAction,e=new Komodo.ClientActions.InventoryAction.ConfigAction;e.Id=a;e.Enabled=b;d.Config=e;c.InventoryActions.push(d)};
a.purchaseItem=function(a,b){var d=new Komodo.ClientActions.StoreAction,e=new Komodo.ClientActions.StoreAction.PurchaseAction;e.Id=a;e.Quantity=b?b:1;d.Purchase=e;c.StoreActions.push(d)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;a.SellAll=!0;c.InventoryActions.push(a)};a.craftRecipe=function(a,b){var d=new Komodo.ClientActions.CraftingAction;d.Id=a;d.Quantity=b;c.CraftingActions.push(d)};a.processRecipe=function(a,b,d){var e=new Komodo.ClientActions.ProcessingAction;
e.Id=a;e.RecipeIndex=b;e.Iterations=d;c.ProcessingActions.push(e)};a.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,d=new Komodo.ClientActions.SocialAction.ChatAction;d.GlobalMessage=a;b.Chat=d;c.SocialActions.push(b)};a.send=m})(Connection||(Connection={}));
