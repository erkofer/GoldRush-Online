var Utils;
(function(a){a.addEvent=function(a,k,h){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(k,h,!1):a.attachEvent?a.attachEvent("on"+k,h):a["on"+k]=h)};a.cssSwap=function(a,k,h){a.classList.contains(k)&&a.classList.remove(k);a.classList.add(h)};a.cssifyName=function(a){return a.split(" ").join("_")};a.ifNotDefault=function(a,k){-100!=a&&k()};a.createButton=function(a,k){var h,q;h=document.createElement("div");q=document.createElement("div");q.textContent=a;k&&(q.id=k);h.classList.add("button");
h.appendChild(q);return h};a.isNumber=function(a){return!isNaN(parseFloat(a))};a.formatNumber=function(a,k){"undefined"===typeof k&&(k=!1);return a?k?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):999999999999999<a?(a/1E15).toFixed(3)+"Qa":999999999999<a?(a/1E12).toFixed(3)+"T":999999999<a?(a/1E9).toFixed(3)+"B":999999<a?(a/1E6).toFixed(3)+"M":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"};a.getRandomInt=function(a,k){return Math.floor(Math.random()*(k-a+1))+a};a.formatTime=function(a){var k=
Math.floor(a/3600),h=Math.floor(a%3600/60);a=Math.floor(a%60);return(10>k?1>k?"":"0"+k+":":k+":")+(10>h?"0"+h+":":h+":")+(10>a?"0"+a:a+"")};a.convertServerTimeToLocal=function(a){var k=new Date,h=k.toISOString().split("-")[0],q=k.toISOString().split("-")[1],p=k.toISOString().split("-")[2].split("T")[0],k=+a.split(":")[0],m=+a.split(":")[1].split(" ")[0];a=a.split(":")[1].split(" ")[1];q=q+"/"+p+"/"+h+" "+((10>k?"0":"")+k)+":"+((10>m?"0":"")+m)+":00 "+a+" UTC";h=new Date(q);console.log(q);console.log(h);
k=h.getHours();m=h.getMinutes();return(10>k?"0":"")+k+":"+(10>m?"0":"")+m}})(Utils||(Utils={}));var tooltip;
(function(a){function r(e,a){var c=b.getBoundingClientRect(),d=c.right-c.left,c=c.bottom-c.top;b.style.left=d+(e+15)>window.innerWidth?e-d-15+"px":e+15+"px";b.style.top=0<a-c?a-c+"px":a+5+"px"}function k(){b&&b.parentElement.removeChild(b);g=b=null}function h(b,e,a){var c=new t;q(b);a&&(c.header=a);c.content=e;m.push(c);b.dataset?b.dataset.tooltip=p:b.setAttribute("data-tooltip",p.toString());p++}function q(a){a.onmouseenter=function(a){var n=+a.target.getAttribute("data-tooltip");f!==a.target&&(c=
setInterval(function(){e+=.01;if(.25<=e){var a=l,f=d,h=m[n];g!==n&&k();g=n;b=h.html;document.body.appendChild(b);r(a,f);e=0;clearInterval(c);c=null}},10));f=a.target};a.onmousemove=function(b){b=b.pageX||b.pageY?{x:b.pageX,y:b.pageY}:b.clientX||b.clientY?{x:b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:b.clientY+document.body.scrollTop+document.documentElement.scrollTop}:void 0;c||r(b.x,b.y);l=b.x;d=b.y};a.onmouseleave=function(b){f=null;clearInterval(c);e=0;k()}}var p=
0,m=[],g,b,c,e=0,l,d,f,t=function(){function b(){this.html=document.createElement("div");this.html.classList.add("tooltip-wrapper")}Object.defineProperty(b.prototype,"header",{get:function(){return this.html.getElementsByClassName("tooltip-header")[0]},set:function(b){b.classList.add("tooltip-header");this.html.appendChild(b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"content",{get:function(){return this.html.getElementsByClassName("tooltip-content")[0]},set:function(b){b.classList.add("tooltip-content");
this.html.appendChild(b)},enumerable:!0,configurable:!0});return b}();a.complexModify=function(b,a,e){b=m[b];e&&(b.header.parentElement.removeChild(b.header),b.header=e);b.content.parentElement.removeChild(b.content);b.content=a};a.modify=function(b,a,e){b=m[b];e&&(b.header.textContent=e);b.content.textContent=a};a.retrieveContent=function(b){return m[b].content};a.complexCreate=h;a.create=function(b,a,e){var c=document.createElement("div");c.textContent=a;e?(a=document.createElement("div"),a.textContent=
e,h(b,c,a)):h(b,c)}})(tooltip||(tooltip={}));var Chat;
(function(a){function r(){if(!h){h=document.createElement("DIV");h.classList.add("chat-window");h.classList.add("social");h.id="chatWindow";h.style.backgroundColor="#ebebeb";h.style.border="1px solid #adadad";var a=document.createElement("DIV");a.classList.add("chat-header");a.style.backgroundColor="rgb(160, 160, 160)";h.appendChild(a);var g=document.createElement("DIV");g.textContent="_";g.style.position="absolute";g.style.top="0";g.style.right="0";g.addEventListener("click",function(){h.classList.contains("closed")?
(h.classList.remove("closed"),g.textContent="_"):(h.classList.add("closed"),g.textContent="+")});a.appendChild(g);var b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent="General";b.addEventListener("click",function(){document.getElementById("debugpane").style.display="none";document.getElementById("chatpane").style.display="block"});a.appendChild(b);b=document.createElement("DIV");b.classList.add("chat-room-tab");b.textContent=">Dev";b.addEventListener("click",function(){document.getElementById("debugpane").style.display=
"block";document.getElementById("chatpane").style.display="none"});b.style.display="none";a.appendChild(b);p=document.createElement("DIV");p.id="debugpane";p.classList.add("chat-room");p.style.display="none";h.appendChild(p);q=document.createElement("DIV");q.id="chatpane";q.classList.add("chat-room");h.appendChild(q);a=document.createElement("DIV");a.id="debuglog";a.classList.add("chat-room-content");p.appendChild(a);a=document.createElement("DIV");a.id="chatlog";a.classList.add("chat-room-content");
q.appendChild(a);a=document.createElement("DIV");b=document.createElement("DIV");b.classList.add("chat-textbox-container");var c=document.createElement("INPUT");c.setAttribute("TYPE","TEXT");c.classList.add("chat-textbox");c.style.borderTop="1px solid #adadad";c.setAttribute("maxlength","220");c.addEventListener("keydown",function(b){13==b.keyCode&&k();68==b.keyCode&&b.altKey&&(document.getElementById("debugtab").style.display="inline-block")});c.id="chattext";b.appendChild(c);a.appendChild(b);b=
document.createElement("DIV");b.classList.add("chat-submit-container");c=document.createElement("INPUT");c.setAttribute("TYPE","BUTTON");c.setAttribute("VALUE","SEND");c.classList.add("chat-submit");c.style.borderTop="1px solid #adadad";c.style.borderLeft="1px solid #adadad";c.addEventListener("click",function(){k()});b.appendChild(c);a.appendChild(b);h.appendChild(a);document.body.appendChild(h)}}function k(){Connection.sendGlobalMessage(document.getElementById("chattext").value);document.getElementById("chattext").value=
""}var h,q,p;a.initialize=r;r();a.log=function(a){var g=document.getElementById("debuglog"),b=document.createElement("DIV");b.textContent=a;g.appendChild(b)};a.receiveGlobalMessage=function(a,g,b,c){var e=document.getElementById("chatlog"),l=5>Math.abs(e.scrollTop-(e.scrollHeight-e.offsetHeight)),d=document.createElement("DIV");d.classList.add("chat-msg");c&&""!=c&&d.classList.add("chat-"+c);c=document.createElement("SPAN");c.textContent="["+Utils.convertServerTimeToLocal(b)+"] ";b=document.createElement("SPAN");
b.textContent=a;b.classList.add("chat-sender");a=document.createElement("SPAN");a.textContent=g;a.classList.add("chat-text");g=document.createElement("SPAN");g.textContent=": ";d.appendChild(c);d.appendChild(b);d.appendChild(g);d.appendChild(a);e.appendChild(d);l&&(e.scrollTop=e.scrollHeight)}})(Chat||(Chat={}));var Tabs;
(function(a){function r(){if(m){var b=m.scrollHeight,e=a.bottomPadding+h.clientHeight;b>window.innerHeight-e&&(b=window.innerHeight-e);q.style.minHeight=b+"px";q.style.maxHeight=b+"px";q.style.overflowY=b>=window.innerHeight-e?"scroll":"hidden"}}var k=0,h=document.getElementById("tabContainer"),q=document.getElementById("paneContainer");a.bottomPadding=170;var p=[],m,g=new (function(){function c(b){this.container=b;this.tabs=[];this.lowestId=0;this.id=k++;p.push(this)}c.prototype.newTab=function(e){var c=
new b;c.pane=e;e=document.createElement("DIV");e.classList.add("tab-button");this.container.appendChild(e);c.button=e;0==this.lowestId?c.activate():c.deactivate();var d=this.lowestId++,g=this.id;e.addEventListener("click",function(){a.activateTab(g,d)});this.tabs.push(c);this.container.appendChild(e);return this.lowestId-1};c.prototype.activate=function(b){for(var a=0;a<this.tabs.length;a++)this.tabs[a].deactivate();this.tabs[b].activate()};c.prototype.css=function(b,a){this.tabs[b].button.classList.add(a)};
return c}())(document.getElementById("tabContainer"));a.registerGameTab=function(b,a){var l=g.newTab(b);a&&g.css(l,a)};a.updateGameTabs=r;Utils.addEvent(window,"resize",a.updateGameTabs);setInterval(r,20);a.activateTab=function(b,a){p[b].activate(a);r()};var b=function(){function b(){}b.prototype.deactivate=function(){Utils.cssSwap(this.button,"active","inactive");this.pane.style.display="none";this.pane.style.overflow="hidden"};b.prototype.activate=function(){Utils.cssSwap(this.button,"inactive",
"active");this.pane.style.display="block";this.pane.style.overflow="visible";m=this.pane};return b}()})(Tabs||(Tabs={}));var Objects;
(function(a){var r=[],k=function(){return function(){this.quantity=0}}();a.register=function(a,q){if(!r[a]){var p=new k;p.name=q;r[a]=p}};a.lookupName=function(a){return r[a].name};a.setQuantity=function(a,k){r[a].quantity=k};a.getQuantity=function(a){return(a=r[a])?a.quantity:0};a.setMaxQuantity=function(a,k){r[a].maxQuantity=k};a.getMaxQuantity=function(a){return r[a].maxQuantity};a.setLifeTimeTotal=function(a,k){r[a].lifeTimeTotal=k};a.getLifeTimeTotal=function(a){return r[a].lifeTimeTotal};a.setTooltip=
function(a,k){r[a].tooltip=k};a.getTooltip=function(a){return r[a].tooltip}})(Objects||(Objects={}));var Inventory;
(function(a){function r(b){Connection.sellItem(e.id,b?b:1)}function k(){var b=document.getElementById("selecteditemquantity"),e=+b.value;Utils.isNumber(e)&&e>a.getSelectedItemQuantity()&&(b.value=a.getSelectedItemQuantity().toString())}function h(){m=document.createElement("DIV");document.getElementById("paneContainer").appendChild(m);b=document.createElement("DIV");b.classList.add("selected-item");b.style.display="none";var s=document.createElement("SPAN");s.textContent="x";s.style.top="0px";s.style.right=
"3px";s.style.position="absolute";s.addEventListener("click",function(){a.selectItem()});b.appendChild(s);c=document.createElement("DIV");c.classList.add("selected-item-image");s=document.createElement("INPUT");s.id="selecteditemquantity";s.type="text";s.style.height="18px";s.classList.add("selected-item-quantity");s.addEventListener("input",function(){k()});f=Utils.createButton("Drink","");f.classList.add("selected-item-quantity");f.addEventListener("click",function(){Connection.drink(e.id);k()});
var n=Utils.createButton("Sell","");n.classList.add("selected-item-quantity");n.addEventListener("click",function(){var b=+document.getElementById("selecteditemquantity").value;Utils.isNumber(b)&&a.sellSelectedItem(b);k()});var h=Utils.createButton("Sell all","");h.classList.add("selected-item-quantity");h.addEventListener("click",function(){a.sellAllSelectedItem();k()});b.appendChild(c);b.appendChild(h);b.appendChild(n);b.appendChild(f);b.appendChild(s);m.appendChild(b);s=document.createElement("DIV");
s.style.textAlign="center";n=document.createElement("DIV");n.style.display="inline-block";h=Utils.createButton("Sell (...)","");h.addEventListener("click",function(){Connection.sellAllItems()});var p=Utils.createButton("...","");p.addEventListener("click",function(){a.toggleConfig()});n.appendChild(h);n.appendChild(p);s.appendChild(n);m.appendChild(s);d=document.createElement("DIV");d.classList.add("config-container");d.classList.add("closed");s=document.createElement("TABLE");s.classList.add("config-table");
d.appendChild(s);h=s.createTHead();n=h.insertRow(0);h=h.insertRow(0);h.classList.add("table-header");h=h.insertCell(0);h.textContent="Inventory Configuration";h.setAttribute("colspan","10");n.classList.add("table-subheader");for(var q in w)0<=parseInt(q,10)&&"NFS"!=w[q]&&(n.insertCell(n.cells.length).classList.add("config-cell-check"),h=n.insertCell(n.cells.length),h.classList.add("config-cell-name"),h.textContent=w[q]);l=s.createTBody();g=document.createElement("DIV");g.style.position="relative";
g.appendChild(d);m.appendChild(g);Tabs.registerGameTab(m,"Inventory");Equipment.draw()}function q(b){var a=document.createElement("DIV");b.container=a;a.classList.add("header-item");var e=document.createElement("DIV");e.style.width="32px";e.style.height="32px";e.style.display="inline-block";e.style.position="relative";e.style.margin="0 auto";var c=document.createElement("DIV");c.classList.add("Half-"+b.name.replace(" ","_"));e.appendChild(c);a.appendChild(e);e=document.createElement("DIV");b.quantityElm=
e;e.classList.add("item-text");e.textContent=Utils.formatNumber(0);e.style.verticalAlign="top";e.style.marginTop="8px";e.style.display="inline-block";a.appendChild(e);e=document.createElement("DIV");e.style.display="none";b.worthElm=e;a.appendChild(e);return a}function p(b){if(0==b.category||null==b.category)return q(b);var e=document.createElement("DIV");b.container=e;e.classList.add("item");e.addEventListener("click",function(){a.selectItem(b.id)});tooltip.create(e,b.name);var c=document.createElement("DIV");
c.classList.add("item-text");var d=document.createElement("DIV");d.style.verticalAlign="top";d.style.display="inline-block";d.textContent=Utils.formatNumber(b.worth);b.worthElm=d;var g=document.createElement("DIV");g.classList.add("Quarter-Coins");g.style.display="inline-block";c.appendChild(g);c.appendChild(d);e.appendChild(c);d=document.createElement("DIV");d.style.width="64px";d.style.height="64px";d.style.position="relative";d.style.margin="0 auto";c=document.createElement("DIV");c.classList.add(b.name.replace(" ",
"_"));d.appendChild(c);e.appendChild(d);c=document.createElement("DIV");b.quantityElm=c;c.classList.add("item-text");c.textContent=Utils.formatNumber(0);e.appendChild(c);if(null!=b.category){var f,u,d=l.rows.length,c=b.category,c=2*c;c--;for(g=0;g<d;g++){var h=l.rows[g].cells[c];if(h&&0==h.childElementCount){f=l.rows[g].cells[c];u=l.rows[g].cells[c-1];break}}if(!f){u=l.insertRow(l.rows.length);u.classList.add("table-row");for(var A in w)0<=parseInt(A,10)&&"NFS"!=w[A]&&(u.insertCell(u.cells.length).classList.add("config-cell-check"),
u.insertCell(u.cells.length).classList.add("config-cell-name"));f=u.cells[c];u=u.cells[c-1]}A=document.createElement("DIV");A.classList.add("item-text");A.style.height="auto";d=document.createElement("SPAN");d.style.verticalAlign="top";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(b.name));c.style.display="inline-block";n[b.id]=c;d.textContent=b.name;t[b.id]=d;A.appendChild(c);A.appendChild(d);f.appendChild(A);f=document.createElement("INPUT");f.type="CHECKBOX";var m=b.id;
a.configClickers[m]=f;f.addEventListener("change",function(b){Connection.configureItem(m,a.configClickers[m].checked)});u.appendChild(f)}return e}a.items=[];a.configClickers=[];var m,g,b,c,e,l,d,f,t=[],n=[],v=function(){return function(b,a,e,c){this.id=b;this.name=a;this.worth=e;this.category=c}}();a.Item=v;(function(b){b[b.NFS=0]="NFS";b[b.ORE=1]="ORE";b[b.GEM=2]="GEM";b[b.INGREDIENT=3]="INGREDIENT";b[b.CRAFTING=4]="CRAFTING";b[b.POTION=5]="POTION"})(a.Category||(a.Category={}));var w=a.Category;
a.getSelectedItemQuantity=function(){return e?e.quantity:0};a.selectItem=function(d){d?(null!=e&&c.classList.remove(Utils.cssifyName(e.name)),e=a.items[d],c.classList.add(Utils.cssifyName(e.name)),f.style.display=5==e.category?"inline-block":"none",k()):(c.classList.remove(Utils.cssifyName(e.name)),e=null);b.style.display=null==e?"none":"block"};a.sellSelectedItem=r;a.sellAllSelectedItem=function(){r(e.quantity)};a.modifyConfig=function(b,e){a.configClickers[b].checked=e};a.toggleConfig=function(){d.classList.contains("closed")?
d.classList.remove("closed"):d.classList.add("closed")};a.addItem=function(b,e,c,d){a.items[b]||(b=new v(b,e,c,d),a.items[b.id]=b,Objects.register(b.id,b.name),m||h(),0!=b.category&&null!=b.category?g.appendChild(p(b)):document.getElementById("headerInventory").appendChild(p(b)))};a.changePrice=function(b,e){Utils.ifNotDefault(e,function(){var c=a.items[b];c.worth=e;c.worthElm.textContent=Utils.formatNumber(e)})};a.changeQuantity=function(b,e){Utils.ifNotDefault(e,function(){Objects.setQuantity(b,
e);Crafting.update();a.items[b].quantityElm.textContent=Utils.formatNumber(e);a.items[b].quantity=e;a.items[b].container.style.display=0!=a.items[b].category&&null!=a.items[b].category?0==e?"none":"inline-block":0==Objects.getLifeTimeTotal(b)?"none":"inline-block";k()})};setInterval(function(){0>=t.length||a.items.forEach(function(b){var a=Objects.getLifeTimeTotal(b.id);t[b.id]&&(t[b.id].textContent=0<a?b.name:"???");n[b.id]&&(n[b.id].style.display=0<a?"inline-block":"none")})},1E3)})(Inventory||
(Inventory={}));var Statistics;
(function(a){function r(){var a=document.createElement("TABLE"),g=a.createTHead(),b=g.insertRow(0);b.classList.add("table-header");b=b.insertCell(0);b.textContent="Item Statistics";b.setAttribute("colspan","3");g=g.insertRow(1);g.classList.add("table-subheader");b=g.insertCell(0);b.textContent="Lifetime Quantity";b.style.width="40%";b=g.insertCell(0);b.textContent="Prestige Quantity";b.style.width="40%";g=g.insertCell(0);g.textContent="Item";g.style.width="20%";h=a.createTBody();return a}var k,h,
q=[],p=function(){return function(){}}();a.changeStats=function(a,g,b){var c=q[a];Utils.ifNotDefault(g,function(){c.prestigeQuantity=g;c.prestigeRow.textContent=Utils.formatNumber(g)});Utils.ifNotDefault(b,function(){c.lifetimeQuantity=b;Objects.setLifeTimeTotal(a,b);c.alltimeRow.textContent=Utils.formatNumber(b);c.row.style.display=0<b?"table-row":"none"})};a.addItem=function(a,g){k||(k=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(k),Tabs.registerGameTab(k,"Statistics"),
k.appendChild(r()));if(!q[a]){var b=new p;q[a]=b;var c=h.insertRow(h.rows.length);c.classList.add("table-row");b.row=c;b.alltimeRow=c.insertCell(0);b.alltimeRow.style.width="40%";b.prestigeRow=c.insertCell(0);b.prestigeRow.style.width="40%";b=c.insertCell(0);b.style.width="20%";c=document.createElement("DIV");c.classList.add("Third-"+Utils.cssifyName(g));c.style.display="inline-block";b.appendChild(c)}}})(Statistics||(Statistics={}));var Store;
(function(a){function r(){h=document.createElement("div");document.getElementById("paneContainer").appendChild(h);Tabs.registerGameTab(h,"Store");for(var b in m)if(0<=parseInt(b,10)){var a=m[b];if("CRAFTING"!=a){var e=document.createElement("div");e.classList.add("store-category");p[a]=e;var g=document.createElement("div");g.textContent=a;g.classList.add("store-category-header");e.appendChild(g);h.appendChild(e)}}}function k(b){var a=document.createElement("div");"undefined"!=b.tooltip&&tooltip.create(a,
b.tooltip);a.classList.add("store-item");b.container=a;var e=document.createElement("div");e.classList.add("store-item-header");var g=document.createElement("div");g.classList.add("store-item-header-text");g.textContent=b.name;e.appendChild(g);var d=document.createElement("div");d.classList.add("store-item-header-quantity-container");var f=document.createElement("span");f.classList.add("store-item-header-quantity");var h=document.createElement("span");h.classList.add("store-item-header-quantity");
var n=document.createElement("span");n.classList.add("store-item-header-quantity");n.textContent="/";1<b.maxQuantity&&(d.appendChild(h),d.appendChild(n),d.appendChild(f));e.appendChild(d);b.maxQuantityElm=f;b.quantityElm=h;b.nameElm=g;a.appendChild(e);e=document.createElement("DIV");e.style.width="64px";e.style.height="64px";e.style.position="relative";e.style.margin="0 auto";g=document.createElement("DIV");g.classList.add(Utils.cssifyName(b.name));e.appendChild(g);a.appendChild(e);e=document.createElement("div");
e.classList.add("store-item-footer");g=document.createElement("div");g.classList.add("item-text");d=document.createElement("div");d.textContent=Utils.formatNumber(b.price);d.style.display="inline-block";d.style.verticalAlign="top";b.priceElm=d;f=document.createElement("div");f.classList.add("Quarter-Coins");f.style.display="inline-block";g.appendChild(f);g.appendChild(d);var d=document.createElement("div"),f=Utils.createButton("Buy",""),m=b.id;if(5!=b.category)f.addEventListener("click",function(){Connection.purchaseItem(m)});
else{var p=document.createElement("INPUT");p.type="TEXT";p.style.width="40px";p.style.height="15px";d.appendChild(p);f.addEventListener("click",function(){Utils.isNumber(p.value)&&Connection.purchaseItem(m,+p.value)})}d.appendChild(f);e.appendChild(d);e.appendChild(g);a.appendChild(e);return a}var h,q=[],p=[];(function(b){b[b.MINING=1]="MINING";b[b.MACHINES=2]="MACHINES";b[b.GATHERING=3]="GATHERING";b[b.PROCESSING=4]="PROCESSING";b[b.ITEMS=5]="ITEMS";b[b.CRAFTING=6]="CRAFTING"})(a.Category||(a.Category=
{}));var m=a.Category,g=function(){return function(){}}();a.tempFix=function(){r()};a.addItem=function(b,a,e,l,d,f,t){h||r();if(!q[b]){Objects.register(b,d);var n=new g;n.id=b;n.category=a;n.price=e;n.factor=l;n.name=d;n.tooltip=t;n.maxQuantity=f?f:0;Objects.register(n.id,n.name);Objects.setTooltip(n.id,n.tooltip);2==n.category&&Equipment.registerGatherer(n.id);a=p[m[a]];null==a&&(a=p.MINING);6!=n.category&&a.appendChild(k(n));q[b]=n}};a.changeQuantity=function(b,a,e,g){var d=q[b];Utils.ifNotDefault(e,
function(){if(0!=e)try{Equipment.changeMaxQuantity(b,e),d.maxQuantity=e,d.maxQuantityElm.textContent=e.toString()}catch(a){}});Utils.ifNotDefault(a,function(){Objects.setQuantity(b,a);d.quantity=a;Crafting.update();Equipment.changeQuantity(b,a);0!=e&&6!=d.category&&(d.container.style.display=-1>=d.quantity||d.quantity>=d.maxQuantity&&0<d.maxQuantity?"none":"inline-block",d.maxQuantity&&1<d.maxQuantity&&(d.quantityElm.textContent=a.toString()))});Utils.ifNotDefault(g,function(){d.priceElm&&(d.price=
g,d.priceElm.textContent=Utils.formatNumber(g))})}})(Store||(Store={}));var Rock;
(function(a){function r(){if(d){var b=Date.now(),a=b-B,a=a/1E3;B=b;y=s?y+8*a:y-8*a;if(4<y||-4>y)s=!s;p(f,t,64+y,64+y);w&&setTimeout(r,10)}else setTimeout(r,10)}function k(b,a){var e=b.getBoundingClientRect();return{x:a.clientX-e.left,y:a.clientY-e.top}}function h(b,e){if(b>f&&b<f+64&&e>t&&e<t+64){if(v){p(f+2,t+2,60,60);if(z)for(var d=Utils.getRandomInt(1,3),c=0;c<d;c++){var g=Utils.getRandomInt(-5,5),l=Utils.getRandomInt(-2,2);a.particles.push(new C(b+g,e+l))}z=!1}else p(f-2,t-2,68,68),z=!0;w=!1;
n=!0}else n&&(p(f,t,64,64),n=!1,z=!0)}function q(b,a){b!=f&&a!=t&&(f=b,t=a,d?p(b,a,64,64):setTimeout(function(){q(b,a)},10))}function p(a,d,c,g){b.clearRect(0,0,250,250);b.drawImage(e,0,0);b.drawImage(l,a,d,c,g)}var m=document.getElementById("rock"),g=document.getElementById("particles"),b=m.getContext("2d"),c=g.getContext("2d"),e=new Image,l=new Image(16,16),d=!1,f=0,t=0,n=!1,v=!1,w=!0,s=!0,y=0,B=Date.now();a.particles=[];var C=function(){function b(a,e){this.height=this.width=5;this.dispose=!1;
this.x=a;this.y=e;this.verticalVelocity=Utils.getRandomInt(-100,-155);this.horizonalVelocity=Utils.getRandomInt(-50,50);this.width=Utils.getRandomInt(3,6);this.height=Utils.getRandomInt(3,6);this.rotation=Utils.getRandomInt(0,180);this.rotationalVelocity=Utils.getRandomInt(-75,75);this.lastTick=Date.now()}b.prototype.update=function(){var b=Date.now()-this.lastTick;this.lastTick=Date.now();b/=1E3;this.rotation+=this.rotationalVelocity*b;this.y+=this.verticalVelocity*b;this.x+=this.horizonalVelocity*
b;this.verticalVelocity+=200*b;270<this.y&&(this.dispose=!0)};return b}();a.Particle=C;r();var z=!0;a.moveRock=q;var x=document.createElement("canvas"),u=x.getContext("2d");setInterval(function(){c.clearRect(0,0,250,250);for(var b=0;b<a.particles.length;b++){var e=a.particles[b];e.update();var d=e;x.width=d.width;x.height=d.height;u.rect(0,0,d.width,d.height);u.fillStyle="gray";u.fill();u.stroke();c.beginPath();var g=c,l=x,f=d.x,n=d.y,h=d.width,m=d.height,d=d.rotation*Math.PI/180;g.translate(f+h/
2,n+m/2);g.rotate(d);g.drawImage(l,h/2*-1,m/2*-1,h,m);g.rotate(-1*d);g.translate(-1*(f+h/2),-1*(n+m/2));e.dispose&&a.particles.splice(b,1)}},10);(function(){e.onload=function(){b.drawImage(e,0,0);console.log("rock loaded")};e.src="/Content/Rock.png";l.onload=function(){d=!0};l.src="/Content/Stone.png";m.addEventListener("mousemove",function(b){b=k(m,b);h(b.x,b.y)},!1);m.addEventListener("mousedown",function(b){b=k(m,b);v=!0;h(b.x,b.y);Connection.mine(b.x,b.y)},!1);m.addEventListener("mouseup",function(b){b=
k(m,b);v=!1;h(b.x,b.y)},!1);m.addEventListener("mouseleave",function(b){b=k(m,b);v=!1;h(b.x,b.y)},!1)})()})(Rock||(Rock={}));var Equipment;
(function(a){function r(){p=document.createElement("div");p.classList.add("store-category");var a=document.createElement("div");a.classList.add("store-category-header");a.textContent="Gatherers";p.appendChild(a);q.appendChild(p)}function k(a){p||r();var b=h[a];b.container=document.createElement("div");b.container.classList.add("equipment-gatherer-container");var c=document.createElement("div");c.classList.add("store-item-header");var e=document.createElement("div");e.classList.add("store-item-header-text");
e.textContent=Objects.lookupName(a);c.appendChild(e);e=Utils.createButton("Disable","");e.addEventListener("click",function(){Connection.toggleGatherer(a,!b.enabled)});var l=document.createElement("div");l.classList.add("store-item-header-quantity-container");b.quantityElm=document.createElement("span");var d=document.createElement("span");d.textContent="/";b.maxQuantityElm=document.createElement("span");l.appendChild(b.quantityElm);l.appendChild(d);l.appendChild(b.maxQuantityElm);c.appendChild(l);
b.container.appendChild(c);b.efficiencyElm=document.createElement("div");b.container.appendChild(b.efficiencyElm);b.fuelConsumptionElm=document.createElement("div");b.container.appendChild(b.fuelConsumptionElm);b.rarityBonusElm=document.createElement("div");b.container.appendChild(b.rarityBonusElm);b.container.appendChild(e);b.toggleElm=e.firstChild;p.appendChild(b.container)}var h=[],q,p,m=function(){return function(){}}();a.draw=function(){q||(q=document.createElement("div"),document.getElementById("paneContainer").appendChild(q),
Tabs.registerGameTab(q,"Equipment"))};a.registerGatherer=function(a){if(!h[a]){var b=new m;h[a]=b;k(a)}};a.toggleGatherer=function(a,b){var c=h[a];c&&(c.enabled=b,c.toggleElm.textContent=b?"Disable":"Enable")};a.changeQuantity=function(a,b){Utils.ifNotDefault(b,function(){var c=h[a];c&&(c.quantity=b,c.container.style.display=-1<b?"inline-block":"none",c.quantityElm.textContent=Utils.formatNumber(b))})};a.changeMaxQuantity=function(a,b){Utils.ifNotDefault(b,function(){var c=h[a];c&&(c.maxQuantity=
b,c.maxQuantityElm.textContent=Utils.formatNumber(b))})};a.changeFuelConsumption=function(a,b){Utils.ifNotDefault(b,function(){var c=h[a];c&&(c.fuelConsumption=b,c.fuelConsumptionElm.textContent="Fuel consumed: "+Utils.formatNumber(b))})};a.changeEfficiency=function(a,b){Utils.ifNotDefault(b,function(){var c=h[a];c&&(c.efficiency=b,c.efficiencyElm.textContent="Resources/s: "+Utils.formatNumber(b))})};a.changeRarityBonus=function(a,b){Utils.ifNotDefault(b,function(){var c=h[a];c&&(c.rarityBonus=b,
c.rarityBonusElm.textContent="Rarity multi: x"+Utils.formatNumber(b))})}})(Equipment||(Equipment={}));var Crafting;
(function(a){function r(){g=document.createElement("DIV");document.getElementById("paneContainer").appendChild(g);Tabs.registerGameTab(g,"Crafting");b=document.createElement("DIV");g.appendChild(b);c=document.createElement("DIV");g.appendChild(c);e=document.createElement("TABLE");e.classList.add("block-table");var a=e.createTHead(),n=a.insertRow(0);n.classList.add("table-subheader");a=a.insertRow(0);a.classList.add("table-header");a=a.insertCell(0);a.colSpan=l.length;a.textContent="Crafting Table";
for(a=0;a<l.length;a++){var h=n.insertCell(0);h.style.width=d[a];h.textContent=l[a];"0"!=f[a]&&(h.style.minWidth=f[a])}n=e.insertRow(2);n.classList.add("table-subheader");n=n.insertCell(0);n.colSpan=l.length;n.textContent="Items";n=e.insertRow(3);n.classList.add("table-subheader");n=n.insertCell(0);n.colSpan=l.length;n.textContent="Upgrades";c.appendChild(e)}function k(b,e){var d=a.processors[b];if(d){var c=d._recipes[e];for(d.selectedRecipe=e;d.recipeList.lastChild;)d.recipeList.removeChild(d.recipeList.lastChild);
for(var g=0;g<c.ingredients.length;g++){var l=document.createElement("DIV");l.classList.add("item-text");l.style.height="30px";var n=document.createElement("DIV");n.style.display="inline-block";var f=document.createElement("DIV");c.ingredients[g].quantityDiv=f;f.style.display="inline-block";f.style.verticalAlign="super";var h=m.fromNumber(c.ingredients[g].quantity).lessThanOrEqual(m.fromNumber(Objects.getQuantity(c.ingredients[g].id)));f.style.color=h?"darkgreen":"darkred";f.textContent=Utils.formatNumber(c.ingredients[g].quantity);
n.classList.add("Half-"+Utils.cssifyName(Objects.lookupName(c.ingredients[g].id)));l.appendChild(n);l.appendChild(f);d.recipeList.appendChild(l)}}}function h(a){var e=document.createElement("TABLE");e.classList.add("block-table");a.container=e;var c=e.createTHead(),g=c.insertRow(0);g.classList.add("table-subheader");c=c.insertRow(0);c.classList.add("table-header");c=c.insertCell(0);c.colSpan=l.length;c.textContent=a.name;for(c=0;c<l.length;c++){var f=g.insertCell(0);f.style.width=n[c];f.textContent=
t[c];"0"!=n[c]&&(f.style.minWidth=v[c])}c=e.insertRow(2);c.classList.add("table-row");c=c.insertCell(0);c.colSpan=t.length;f=document.createElement("DIV");f.classList.add("progress-bar-container");g=document.createElement("DIV");g.classList.add("progress-bar");var h=document.createElement("DIV");h.classList.add("progress-bar-text-container");var m=document.createElement("DIV");m.classList.add("progress-bar-text");h.appendChild(m);f.appendChild(h);a.progressBar=g;a.progressText=m;f.appendChild(g);
c.appendChild(f);g=e.insertRow(3);g.classList.add("table-row");for(c=0;c<t.length;c++){f=g.insertCell(0);f.style.width=d[c];f.style.height="75px";"0"!=v[c]&&(f.style.minWidth=v[c]);"Image"==t[c]&&(h=document.createElement("DIV"),h.classList.add(Utils.cssifyName(a.name)),h.style.margin="0 auto",f.appendChild(h));"Capacity"==t[c]&&(f.textContent="0",a.capacityElm=f);"Input"==t[c]&&(a.recipeList=f);if("Output"==t[c]){h=Utils.createButton("Max","");f.appendChild(h);h=document.createElement("INPUT");h.type=
"TEXT";h.style.width="35px";a.quantityTextbox=h;f.appendChild(h);var p=a.id,s=document.createElement("SELECT");s.addEventListener("change",function(b){k(p,s.selectedIndex)});a.recipeSelector=s;f.appendChild(s)}"Action"==t[c]&&(h=Utils.createButton("Activate",""),h.addEventListener("click",function(){Utils.isNumber(a.quantityTextbox.value)&&Connection.processRecipe(a.id,a.recipeSelector.selectedIndex,+a.quantityTextbox.value)},!1),f.appendChild(h))}q(a);b.appendChild(e)}function q(b){B||(B=document.createElement("div"),
y.appendChild(B));var a=document.createElement("div");a.classList.add("processor-sidebar");b.sidebarContainer=a;var e=document.createElement("div");e.classList.add("buff-header");e.textContent=b.name;a.appendChild(e);e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar-container");var c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar");b.sidebarProgressBar=c;var d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");
b.sidebarProgressText=d;e.appendChild(d);e.appendChild(c);a.appendChild(e);e=document.createElement("div");e.classList.add("processor-sidebar-progress-bar-container");c=document.createElement("div");c.classList.add("processor-sidebar-progress-bar");b.sidebarJobBar=c;d=document.createElement("div");d.classList.add("processor-sidebar-progress-text");b.sidebarJobText=d;e.appendChild(d);e.appendChild(c);a.appendChild(e);a.style.display="none";B.appendChild(a)}function p(b,a){var c=e.rows.length;a&&(c=
w,w++);c=e.insertRow(c);c.classList.add("table-row");b.row=c;for(var g=0;g<l.length;g++){var h=c.insertCell(0);h.style.width=d[g];"0"!=f[g]&&(h.style.minWidth=f[g]);"Name"==l[g]&&(h.textContent=Objects.lookupName(b.id));if("Input"==l[g])for(var n=0;n<b.ingredients.length;n++){var m=document.createElement("DIV");m.classList.add("item-text");m.style.height="auto";var p=document.createElement("DIV");p.style.display="inline-block";var k=document.createElement("DIV");b.ingredients[n].quantityDiv=k;k.style.display=
"inline-block";k.style.verticalAlign="super";k.textContent=Utils.formatNumber(b.ingredients[n].quantity);p.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(b.ingredients[n].id)));m.appendChild(p);m.appendChild(k);h.appendChild(m)}"Description"==l[g]&&(h.textContent=Objects.getTooltip(b.resultants[0].id));if("Output"==l[g])for(n=0;n<b.resultants.length;n++)m=document.createElement("DIV"),m.classList.add("item-text"),m.style.height="auto",p=document.createElement("DIV"),p.style.display="inline-block",
k=document.createElement("DIV"),k.style.display="inline-block",k.style.verticalAlign="super",k.textContent=Utils.formatNumber(b.resultants[n].quantity),p.classList.add("Third-"+Utils.cssifyName(Objects.lookupName(b.resultants[n].id))),m.appendChild(p),b.isItem&&m.appendChild(k),h.appendChild(m);if("Action"==l[g]&&(n=Utils.createButton("Craft",""),n.addEventListener("click",function(){Connection.craftRecipe(b.id,1)},!1),h.appendChild(n),b.isItem)){var q=document.createElement("INPUT");q.type="TEXT";
q.style.width="30px";n=Utils.createButton("Craft-x","");n.addEventListener("click",function(){Connection.craftRecipe(b.id,+q.value)},!1);h.appendChild(n);h.appendChild(q)}}}var m=dcodeIO.Long,g,b,c,e,l=["Action","Description","Input","Output","Name"],d=["10%","50%","15%","15%","10%"],f=["170px","0","0","0","0"],t=["Action","Output","Input","Capacity","Image"],n=["10%","30%","20%","20%","20%"],v=["170px","0","0","0","0"],w=3,s=[];a.processors=[];var y=document.getElementById("sidebarInformation"),
B,C=function(){function b(){this._recipes=[]}b.prototype.addRecipe=function(b){this._recipes.push(b);this.selectedRecipe||(this.selectedRecipe=0)};return b}();a.Processor=C;var z=function(){function b(){this.ingredients=[];this.resultants=[]}b.prototype.addIngredient=function(b){this.ingredients.push(b)};b.prototype.addResultant=function(b){this.resultants.push(b)};return b}();a.Recipe=z;var x=function(){return function(b,a){this.id=b;this.quantity=a}}();a.Ingredient=x;a.addRecipe=function(b,a,e,
c){g||r();if(!s[b]){var d=new z;d.id=b;d.isItem=c;s[b]=d;for(b=0;b<a.length;b++)d.addIngredient(new x(a[b].Id,a[b].Quantity));for(b=0;b<e.length;b++)d.addResultant(new x(e[b].Id,e[b].Quantity));p(d,c)}};a.addProcessor=function(b,e,c){g||r();if(!a.processors[b]){var d=new C;d.id=b;d.name=e;d.requiredId=c;a.processors[b]=d;h(d)}};a.addProcessorRecipe=function(b,e,c){if(a.processors[b]){var d=a.processors[b],g;a:if(a.processors[b]){g=a.processors[b];for(var f=0;f<g._recipes.length;f++)if(c[0].Id==g._recipes[f].resultants[0].id){g=
!0;break a}g=!1}else g=void 0;if(!g){g=new z;for(f=0;f<e.length;f++)g.addIngredient(new x(e[f].Id,e[f].Quantity));for(f=0;f<c.length;f++)g.addResultant(new x(c[f].Id,c[f].Quantity));d.addRecipe(g);e=document.createElement("OPTION");e.textContent=Objects.lookupName(c[0].Id);d.recipeSelector.appendChild(e);1==d._recipes.length&&k(b,0)}}};a.updateProcessor=function(b,e,c,d,g,f){var l=a.processors[b];if(l){var n=!1;Utils.ifNotDefault(e,function(){l.selectedRecipe=e});Utils.ifNotDefault(g,function(){l.totalOperations=
g;n=!0});Utils.ifNotDefault(c,function(){l.operationDuration=c});Utils.ifNotDefault(f,function(){l.capacityElm.textContent=f.toString()});Utils.ifNotDefault(d,function(){l.completedOperations=d;n=!0});if(n){if(0>=l.totalOperations||l.completedOperations==l.totalOperations){l.progressBar.style.width="0%";l.progressText.textContent="";l.sidebarProgressText.textContent="";l.sidebarContainer.style.display="none";l.totalOperationCompletionTime=0;return}l.sidebarContainer.style.display="inline-block";l.operationStartTime=
Date.now();l.operationCompletionTime=l.operationStartTime+1E3*l.operationDuration;0==l.totalOperationCompletionTime&&(l.totalOperationCompletionTime=l.operationStartTime+1E3*l.operationDuration*(l.totalOperations-l.completedOperations))}if(-1<l.selectedRecipe)try{l.progressText.textContent=Objects.lookupName(l._recipes[l.selectedRecipe].resultants[0].id)+" ("+l.completedOperations+"/"+l.totalOperations+")",l.sidebarJobText.textContent=Objects.lookupName(l._recipes[l.selectedRecipe].resultants[0].id)+
" ("+l.completedOperations+"/"+l.totalOperations+")"}catch(h){console.log("invalid processor recipe "+l.selectedRecipe)}else l.progressText.textContent="",l.sidebarProgressText.textContent=""}};setInterval(function(){a.processors.forEach(function(b){if(0>=b.operationDuration)b.progressBar.style.width="0%";else if(b.completedOperations!=b.totalOperations&&0<b.totalOperations){var a=b.operationCompletionTime-Date.now(),a=a/1E3,e=b.totalOperationCompletionTime-Date.now(),c=e/(b.operationDuration*b.totalOperations),
a=a/b.operationDuration,a=100-100*a;b.progressBar.style.width=a+"%";b.sidebarJobBar.style.width=a+"%";b.sidebarProgressBar.style.width=100-c/10+"%";b.sidebarProgressText.textContent=Utils.formatTime(e/1E3)}0!=b.requiredId&&(b.container.style.display=0<Objects.getQuantity(b.requiredId)?"block":"none")})},10);a.update=function(){g&&(s.forEach(function(b){var a=Objects.getQuantity(b.id);b.row.style.display=-1==a||!b.isItem&&0<a?"none":"";b.ingredients.forEach(function(b){var a=Objects.getQuantity(b.id),
a=m.fromNumber(b.quantity).lessThanOrEqual(m.fromNumber(a));b.quantityDiv.style.color=a?"darkgreen":"darkred"})}),a.processors.forEach(function(b){k(b.id,b.recipeSelector.selectedIndex)}))}})(Crafting||(Crafting={}));var Buffs;
(function(a){var r=[],k=document.getElementById("sidebarInformation"),h,q=function(){return function(){}}();a.register=function(a,m,g,b){if(!r[a]){var c=new q;c.name=m;c.description=g;c.duration=b;r[a]=c;a=document.createElement("div");a.classList.add("buff-container");tooltip.create(a,c.description);m=document.createElement("div");m.textContent=c.name;m.classList.add("buff-header");a.appendChild(m);m=document.createElement("div");m.classList.add("buff-image-container");a.appendChild(m);g=document.createElement("div");
g.classList.add(Utils.cssifyName(c.name));m.appendChild(g);m=document.createElement("div");m.classList.add("buff-header");a.appendChild(m);h.appendChild(a);c.container=a;c.durationElm=m}};a.update=function(a,h){var g=r[a];g.timeActive=h;g.durationElm.textContent="("+Utils.formatTime(g.duration-h)+")";g.container.style.display=0==h?"none":"inline-block"};h=document.createElement("div");k.appendChild(h)})(Buffs||(Buffs={}));var Account;
(function(a){function r(){b.classList.contains("closed")||b.classList.add("closed")}function k(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var e=document.createElement("DIV");e.style.marginBottom="5px";var c=document.createElement("INPUT");c.type="TEXT";c.maxLength=16;c.placeholder="Username";e.appendChild(c);var g=document.createElement("DIV");g.style.marginBottom="5px";var l=document.createElement("INPUT");l.type="PASSWORD";l.pattern=".{6,}";l.placeholder="Password";
g.appendChild(l);var f=document.createElement("DIV");f.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="CHECKBOX";h.placeholder="Stay logged in on this computer?";f.appendChild(h);a.appendChild(e);a.appendChild(g);a.appendChild(f);d=document.createElement("div");b.addElement(d);b.title="Log in";b.addElement(a);b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(p(c.value,
l.value,h.checked);d.firstChild;)d.removeChild(d.firstChild)},!1);b.show()}function h(){var b=new modal.Window,a=document.createElement("DIV");a.style.width="400px";var e=document.createElement("DIV");e.style.marginBottom="5px";var c=document.createElement("INPUT");c.type="TEXT";c.maxLength=16;c.placeholder="Username";e.appendChild(c);var d=document.createElement("DIV");d.style.marginBottom="5px";var g=document.createElement("INPUT");g.type="EMAIL";g.placeholder="Email";d.appendChild(g);var f=document.createElement("DIV");
f.style.marginBottom="5px";var h=document.createElement("INPUT");h.type="PASSWORD";h.pattern=".{6,}";h.placeholder="Password";f.appendChild(h);var m=document.createElement("DIV");m.style.marginBottom="5px";var k=document.createElement("INPUT");k.type="PASSWORD";k.pattern=".{6,}";k.placeholder="Confirm password";m.appendChild(k);k.onblur=function(){h.value!=k.value&&k.setCustomValidity("Passwords are not the same.")};k.onfocus=function(){k.setCustomValidity("")};a.appendChild(e);a.appendChild(d);a.appendChild(f);
a.appendChild(m);b.addElement(a);l=document.createElement("div");b.addElement(l);b.title="Register";b.addNegativeOption("Cancel").addEventListener("click",function(){modal.close()},!1);b.addAffirmativeOption("Submit").addEventListener("click",function(){for(q(g.value,c.value,h.value,k.value);l.firstChild;)l.removeChild(l.firstChild)},!1);b.show()}function q(b,a,e,c){$.ajax({type:"POST",url:"/Api/Account/Register",data:$.param({Email:b,UserName:a,Password:e,ConfirmPassword:c}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),g(),modal.close();else{for(;l.firstChild;)l.removeChild(l.firstChild);for(var a=0;a<b.Errors.length;a++){var e=document.createElement("div");e.textContent=b.Errors[a];l.appendChild(e)}}}})}function p(b,a,e){$.ajax({type:"POST",url:"/Api/Account/Login",data:$.param({UserName:b,Password:a,RememberMe:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){b=JSON.parse(b);if(b.Succeeded)Connection.restart(),
g(),modal.close();else{for(;d.firstChild;)d.removeChild(d.firstChild);for(var a=0;a<b.Errors.length;a++){var e=document.createElement("div");e.textContent=b.Errors[a];d.appendChild(e)}}}})}function m(){$.ajax({type:"POST",url:"/Api/Account/LogOff",headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){console.log(b);Connection.restart();g();location.reload()}})}function g(){$.ajax({type:"POST",url:"/Api/Account/Info",headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(c){c=JSON.parse(c);var d=c.Anonymous;e.textContent=d?"Guest":c.UserName;a.signedIn=!d;Utils.cssSwap(b,d?"registered":"anonymous",d?"anonymous":"registered")}})}var b,c,e;a.signedIn=!1;var l,d,f,t;(function(b){function e(a,c,d){b.currentlyInspecting=a;var g=new Ajax.LeaderboardAjaxService;g.resultsElement=d;g.sendRequest(a,c)}b.currentlyInspecting=0;b.open=function(){var c=new modal.Window;c.title="Leaderboards";if(!a.signedIn){var d=document.createElement("div");d.style.fontSize=
"18px";d.style.background="darkred";d.style.color="white";d.style.fontWeight="bold";d.style.textAlign="center";d.style.border="1px solid white";d.textContent="Sign in to see where you rank.";c.addElement(d)}var g=document.createElement("DIV");g.style.width="400px";g.appendChild(Ajax.createLoader());c.addElement(g);d=document.createElement("div");d.style.textAlign="center";d.style.marginTop="5px";var l=Utils.createButton("<<",""),f=document.createElement("input");f.type="TEXT";var h=Utils.createButton(">>",
"");l.addEventListener("click",function(){b.currentlyInspecting-=20;0>b.currentlyInspecting&&(b.currentlyInspecting=0);b.currentlyInspecting-=b.currentlyInspecting%20;e(b.currentlyInspecting,b.currentlyInspecting+20,g)});f.addEventListener("keyup",function(a){13==a.keyCode&&(a=a.currentTarget.value,Utils.isNumber(a)&&(b.currentlyInspecting=+a,b.currentlyInspecting-=b.currentlyInspecting%20,e(b.currentlyInspecting,b.currentlyInspecting+20,g)))});h.addEventListener("click",function(){b.currentlyInspecting+=
20;b.currentlyInspecting-=b.currentlyInspecting%20;e(b.currentlyInspecting,b.currentlyInspecting+20,g)});d.appendChild(l);d.appendChild(f);d.appendChild(h);c.addElement(d);c.addOption("Close").addEventListener("click",function(){modal.close()});c.show();e(0,20,g)}})(t||(t={}));(function(){b=document.createElement("DIV");b.classList.add("account-manager");b.classList.add("closed");b.onmouseenter=function(){clearTimeout(f)};b.onmouseleave=function(){f=setTimeout(r,250)};var a=document.createElement("DIV");
a.textContent="Sign in";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){k()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Register";a.classList.add("account-option");a.classList.add("anonymous-account-option");a.addEventListener("click",function(){h()});b.appendChild(a);a=document.createElement("DIV");a.textContent="Options";a.classList.add("account-option");a.classList.add("registered-account-option");b.appendChild(a);
a=document.createElement("DIV");a.textContent="Sign out";a.classList.add("account-option");a.classList.add("registered-account-option");a.addEventListener("click",function(){m()});b.appendChild(a);c=document.createElement("DIV");c.classList.add("account-user");e=document.createElement("SPAN");c.appendChild(e);b.appendChild(c);document.body.appendChild(b);c.addEventListener("click",function(){b.classList.contains("closed")?b.classList.remove("closed"):b.classList.add("closed")});a=document.createElement("SPAN");
a.textContent="Leaderboards";a.addEventListener("click",function(){t.open()});a.style.cursor="pointer";document.getElementsByClassName("header-links")[0].appendChild(a);g()})();a.info=g})(Account||(Account={}));var modal;
(function(a){function r(){a.activeWindow&&a.activeWindow.hide();a.activeWindow=null}function k(){if(a.activeWindow){var h=a.activeWindow.container.getBoundingClientRect();a.activeWindow.container.style.left=window.innerWidth/2-(h.right-h.left)/2+"px";a.activeWindow.container.style.top=window.innerHeight/2-(h.bottom-h.top)/2+"px"}else clearInterval(a.intervalIdentifier)}var h=0,q;a.activeWindow;a.intervalIdentifier;a.hide=r;a.close=function(){if(a.activeWindow){var h=a.activeWindow;r();h.container.parentNode.removeChild(h.container)}};
var p=function(){function m(){this.container=document.createElement("div");this.container.addEventListener("click",function(b){b.stopPropagation()},!1);this.container.classList.add("modal-window");if(!q){var g=document.createElement("div");q=g;g.classList.add("modal-wrapper");g.addEventListener("click",function(b){b.stopPropagation();3E3<Date.now()-h&&a.close()},!1);document.body.appendChild(g)}q.appendChild(this.container);this.titleEl=document.createElement("div");this.titleEl.classList.add("modal-header");
this.bodyEl=document.createElement("div");this.container.appendChild(this.titleEl);this.container.appendChild(this.bodyEl)}Object.defineProperty(m.prototype,"title",{get:function(){return this._title},set:function(a){this._title=a;this.titleEl.textContent=this._title},enumerable:!0,configurable:!0});m.prototype.addElement=function(a){this.bodyEl.appendChild(a)};m.prototype.addOption=function(a){this.options||(this.options=document.createElement("div"),this.options.classList.add("modal-options"),this.container.appendChild(this.options));
var b=document.createElement("span");b.classList.add("modal-option");var c=document.createElement("span");c.textContent=a;b.appendChild(c);this.options.appendChild(b);return b};m.prototype.addAffirmativeOption=function(a){a=this.addOption(a);a.classList.add("affirmative");return a};m.prototype.addNegativeOption=function(a){a=this.addOption(a);a.classList.add("negative");return a};m.prototype.show=function(){this.container.classList.contains("opened")||this.container.classList.add("opened");q.classList.contains("opened")||
q.classList.add("opened");a.activeWindow=this;k();a.intervalIdentifier=setInterval(k,100);h=Date.now()};m.prototype.hide=function(){this.container.classList.contains("opened")&&this.container.classList.remove("opened");q.classList.contains("opened")&&q.classList.remove("opened")};return m}();a.Window=p})(modal||(modal={}));var Ajax;
(function(a){function r(){for(var a=0;a<k.length;a++){var h=k[a];h.dead?k.splice(a,1):h.update()}setTimeout(r,10)}var k=[],h=function(){function a(){}a.prototype.failed=function(a){this.resultsElement.textContent="Loading failed..."};a.prototype.succeeded=function(a){for(;this.resultsElement.firstChild;)this.resultsElement.removeChild(this.resultsElement.firstChild);var g=document.createElement("table"),b=g.createTHead().insertRow(0);b.classList.add("table-subheader");var c=b.insertCell(0);c.textContent=
"Score";c.style.width="65%";c=b.insertCell(0);c.textContent="Name";c.style.width="25%";b=b.insertCell(0);b.textContent="Rank";b.style.width="10%";for(var b=g.createTBody(),e=0;e<a.length;e++){var l=a[e],d=b.insertRow(b.rows.length);d.classList.add("table-row");var f=d.insertCell(0);f.textContent=Utils.formatNumber(l.Score);f.style.width="65%";f.addEventListener("click",function(b){var a=b.target;b=a.dataset?a.dataset.tooltip:a.getAttribute("data-tooltip");0<a.textContent.indexOf(",")?a.textContent=
Utils.formatNumber(b):a.textContent=Utils.formatNumber(b,!0)});f.dataset?f.dataset.tooltip=l.Score:f.setAttribute("data-tooltip",l.Score.toString());d.insertCell(0).textContent=l.UserId;c.style.width="25%";d=d.insertCell(0);d.textContent=Utils.formatNumber(l.Rank);d.style.width="10%"}this.resultsElement.appendChild(g)};a.prototype.sendRequest=function(a,g){var b=this;$.ajax({asyn:!0,type:"POST",url:"/Api/Stats/LeaderBoard/",data:$.param({Lower:a,Upper:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"},
success:function(a){a=JSON.parse(a);b.succeeded(a)},failure:function(a){b.failed(a)}})};return a}();a.LeaderboardAjaxService=h;var q=function(){function a(){this.notDisplayed=20;this.notches=40;this.space=.02;this.spawned=!1;this.spinPos=0;this.spinSpeed=30;this.squareSize=50;this.timeSinceLastTick=Date.now();this.thickness=3;this.dead=!1;this.container=document.createElement("div");this.container.classList.add("loader");this.canvasElement=document.createElement("canvas");this.canvasElement.width=
this.squareSize;this.canvasElement.height=this.squareSize;this.container.appendChild(this.canvasElement);this.context=this.canvasElement.getContext("2d")}a.prototype.update=function(){var a=Date.now();this.canvasElement.parentElement&&(this.spawned=!0);var g=a-this.timeSinceLastTick;this.spinPos+=g/1E3*this.spinSpeed;this.timeSinceLastTick=a;this.spawned&&!this.canvasElement.parentElement&&(this.dead=!0);this.draw()};a.prototype.draw=function(){var a=this.squareSize/2,g=this.squareSize/2-5,b=(2-this.space*
this.notches)/this.notches,c=this.spinPos%this.notches,e=c-this.notDisplayed;this.context.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);for(var l=0;l<this.notches;l++){var d=0+l*b+this.space*l,f=d+b,h=l-this.notches;l<=c&&l>=e?(this.context.beginPath(),this.context.arc(a,a,g,d*Math.PI,f*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(c-l)/(this.notches-this.notDisplayed))+")",this.context.stroke()):h<=c&&h>=e&&(this.context.beginPath(),
this.context.arc(a,a,g,d*Math.PI,f*Math.PI),this.context.lineWidth=this.thickness,this.context.strokeStyle="rgba(113,142,164,"+(1-(c-h)/(this.notches-this.notDisplayed))+")",this.context.stroke())}};return a}();a.createLoader=function(){var a=new q;k.push(a);return a.container};r()})(Ajax||(Ajax={}));var Achievements;
(function(a){function r(){h.forEach(function(a){null!=a.requires&&(a.requires.requiredBy=a)})}function k(a){a/=60;if(60>a)return Math.max(Math.ceil(a),1)+" minutes";a/=60;if(24>a)return Math.max(Math.ceil(a),1)+(1>=a?" hour":" hours");a/=24;if(30>a)return Math.max(Math.ceil(a),1)+(1>=a?" day":" days");a/=30;if(12>a)return Math.max(Math.ceil(a),1)+(1>=a?" month":" months")}var h=[],q,p=!1;(function(a){a[a.Undefined=0]="Undefined";a[a.Money=1]="Money";a[a.TimePlayed=2]="TimePlayed";a[a.RockClicks=3]=
"RockClicks";a[a.Oil=4]="Oil"})(a.Category||(a.Category={}));var m=function(){function a(){}a.prototype.getTooltip=function(){if(1==this.category)return"Have a total of "+Utils.formatNumber(this.goal)+" accumulated coins.";if(2==this.category)return"Play for "+k(this.goal)+".";if(3==this.category)return"Click the rock "+Utils.formatNumber(this.goal)+" times.";if(4==this.category)return 1==this.goal?"Get some oil!":"Have a total of "+Utils.formatNumber(this.goal)+" accumulated oil."};a.prototype.trickleDown=
function(a){a||(a=this.progress);this.progress=a;this.progressBar.style.width=a/this.goal*100+"%";this.progressText.textContent=Utils.formatNumber(Math.min(a,this.goal))+"/"+Utils.formatNumber(this.goal);null!=this.requiredBy&&this.requiredBy.trickleDown(a)};return a}();a.register=function(a,b,c,e,l){if(!h[a]){var d=new m;d.name=b;0!=c&&(d.requires=h[c]);d.goal=e;d.category=l;q||(q=document.createElement("div"),document.getElementById("paneContainer").appendChild(q),Tabs.registerGameTab(q,"Achievements"));
b=document.createElement("div");b.classList.add("achievement");d.container=b;c=document.createElement("div");c.classList.add("achievement-image");b.appendChild(c);c=document.createElement("div");c.classList.add("achievement-body");b.appendChild(c);e=document.createElement("div");e.classList.add("achievement-title");e.textContent=d.name;c.appendChild(e);e=document.createElement("div");e.classList.add("achievement-description");e.textContent=d.getTooltip();c.appendChild(e);e=document.createElement("div");
e.classList.add("achievement-progress-container");c.appendChild(e);c=document.createElement("div");c.classList.add("achievement-progress-text");d.progressText=c;e.appendChild(c);c=document.createElement("div");c.classList.add("achievement-progress");c.style.width="0%";e.appendChild(c);d.progressBar=c;q.appendChild(b);h[a]=d}};a.updateAchievement=function(a,b){p||(r(),p=!0);var c=h[a];c&&(b||(b=0),c.progress=b,c.trickleDown(b))}})(Achievements||(Achievements={}));var Market;
(function(a){var r,k=function(){return function(){}}();a.Order=k;a.drawTradePane=function(a){r||(r=document.createElement("DIV"),document.getElementById("paneContainer").appendChild(r),Tabs.registerGameTab(r,"Market"));var k=document.createElement("div");k.classList.add("market-order");k.classList.add("closed");var p=document.createElement("div");p.textContent="Empty";p.classList.add("market-order-header");a.header=p;k.appendChild(p);a=document.createElement("div");a.classList.add("market-order-controls");
p=document.createElement("div");p.classList.add("market-control");p.classList.add("buy");p.textContent="Buy";a.appendChild(p);p=document.createElement("div");p.classList.add("market-control");p.classList.add("sell");p.textContent="Sell";a.appendChild(p);k.appendChild(a);a=document.createElement("div");a.classList.add("market-order-display");k.appendChild(a);r.appendChild(k)}})(Market||(Market={}));var Connection;
(function(a){function r(){console.log("Connection opened");var a=c.encode64();k(a);c=new Komodo.ClientActions;q=setInterval(function(){var a=c.encode64();k(a);c=new Komodo.ClientActions},1E3)}function k(a){if(a.encode64){var b=a.encode64();Chat.log("Sent "+h(b)+" bytes to komodo.");Chat.log("Decoded: ");Chat.log(JSON.stringify(a));Chat.log("Encoded: ");Chat.log(a.encode64());Komodo.send(a.encode64())}else Chat.log("Sent "+h(a)+" bytes to komodo."),Komodo.send(a)}function h(a){var b=[];a=[a];for(var c=
0;a.length;){var f=a.pop();if("boolean"===typeof f)c+=4;else if("string"===typeof f)c+=2*f.length;else if("number"===typeof f)c+=8;else if("object"===typeof f&&-1===b.indexOf(f)){b.push(f);for(var g in f)a.push(f[g])}}return c}var q,p,m,g,b;(function(){var a=document.getElementsByClassName("header-links")[0],c=document.createElement("div");c.style.display="inline-block";c.textContent="Version History";c.addEventListener("click",function(){window.open("/version")});c.style.cursor="pointer";a.appendChild(c);
b=document.createElement("div");b.style.display="inline-block";b.textContent="There are 0 players mining.";a.appendChild(b);p=document.createElement("div");p.classList.add("error-notification-tray");m=document.createElement("div");m.classList.add("network-error");a=document.createElement("div");a.classList.add("network-error-text");a.textContent="No connection";m.appendChild(a);g=document.createElement("div");g.classList.add("rate-limited");a=document.createElement("div");a.classList.add("network-error-text");
g.style.display="none";a.textContent="You have exceeded your allotted requests";g.appendChild(a);a=document.getElementById("game");p.appendChild(m);p.appendChild(g);a.insertBefore(p,a.childNodes[0])})();Komodo.connection.received(function(a){Chat.log("Recieved "+h(a)+" bytes from komodo.");Chat.log("Encoded: ");Chat.log(a);Chat.log("Decoded: ");Chat.log(JSON.stringify(Komodo.decode(a)));Chat.log(h(JSON.stringify(Komodo.decode(a)))-h(a)+" bytes saved.");a=Komodo.decode(a);if(null!=a.Messages)for(var c=
a.Messages,d=0;d<c.length;d++){var f=c[d];Chat.receiveGlobalMessage(f.Sender,f.Text,f.Time,f.Permissions)}if(null!=a.GameSchema){c=a.GameSchema;if(c.Items)for(d=0;d<c.Items.length;d++)Inventory.addItem(c.Items[d].Id,c.Items[d].Name,c.Items[d].Worth,c.Items[d].Category),Statistics.addItem(c.Items[d].Id,c.Items[d].Name);if(c.StoreItems)for(d=0;d<c.StoreItems.length;d++)f=c.StoreItems[d],Store.addItem(f.Id,f.Category,f.Price,f.Factor,f.Name,f.MaxQuantity,f.Tooltip);if(c.Processors)for(d=0;d<c.Processors.length;d++){f=
c.Processors[d];Crafting.addProcessor(f.Id,f.Name,f.RequiredId);for(var k=0;k<f.Recipes.length;k++)Crafting.addProcessorRecipe(f.Id,f.Recipes[k].Ingredients,f.Recipes[k].Resultants)}if(c.CraftingItems)for(d=0;d<c.CraftingItems.length;d++)f=c.CraftingItems[d],Crafting.addRecipe(f.Id,f.Ingredients,f.Resultants,f.IsItem);if(c.Buffs)for(d=0;d<c.Buffs.length;d++)f=c.Buffs[d],Buffs.register(f.Id,f.Name,f.Description,f.Duration);if(c.Achievements)for(d=0;d<c.Achievements.length;d++)f=c.Achievements[d],console.log(f),
Achievements.register(f.Id,f.Name,f.RequiredId,f.Goal,f.Category)}if(null!=a.Items)for(c=a.Items,d=0;d<c.length;d++)Inventory.changeQuantity(c[d].Id,c[d].Quantity),Inventory.changePrice(c[d].Id,c[d].Worth);if(null!=a.StoreItemsUpdate)for(c=a.StoreItemsUpdate,d=0;d<c.length;d++)Store.changeQuantity(c[d].Id,c[d].Quantity,c[d].MaxQuantity,c[d].Price);if(null!=a.StatItemsUpdate)for(c=a.StatItemsUpdate,d=0;d<c.length;d++)Statistics.changeStats(c[d].Id,c[d].PrestigeQuantity,c[d].LifeTimeQuantity);if(null!=
a.ConfigItems)for(c=a.ConfigItems,d=0;d<c.length;d++)Inventory.modifyConfig(c[d].Id,c[d].Enabled);if(null!=a.Processors)for(c=a.Processors,d=0;d<c.length;d++)f=c[d],Crafting.updateProcessor(f.Id,f.SelectedRecipe,f.OperationDuration,f.CompletedOperations,f.TotalOperations,f.Capacity);null!=a.AntiCheatCoordinates&&(c=a.AntiCheatCoordinates,Rock.moveRock(c.X,c.Y));if(null!=a.Buffs)for(c=a.Buffs,d=0;d<c.length;d++)f=c[d],Buffs.update(f.Id,f.TimeActive);null!=a.IsRateLimited&&(g.style.display=a.IsRateLimited?
"block":"none");if(null!=a.Gatherers)for(c=a.Gatherers,d=0;d<c.length;d++)f=c[d],Equipment.toggleGatherer(f.Id,f.Enabled),Equipment.changeEfficiency(f.Id,f.Efficiency),Equipment.changeFuelConsumption(f.Id,f.FuelConsumed),Equipment.changeRarityBonus(f.Id,f.RarityBonus);a.ConnectedUsers&&(b.textContent="There are "+a.ConnectedUsers+" players mining.");if(a.Achievements)for(a=a.Achievements,c=0;c<a.length;c++)d=a[c],Achievements.updateAchievement(d.Id,d.Progress)});a.restart=function(){Komodo.restart()};
var c=new Komodo.ClientActions;Komodo.connection.stateChanged(function(a){a.newState===$.signalR.connectionState.connected&&(r(),m.style.display="none");a.newState===$.signalR.connectionState.disconnected&&(clearInterval(q),m.style.display="block");a.newState===$.signalR.connectionState.reconnecting&&(m.style.display="block")});a.toggleGatherer=function(a,b){var d=new Komodo.ClientActions.GathererAction;d.Id=a;d.Enabled=b;c.GathererActions.push(d)};a.drink=function(a){var b=new Komodo.ClientActions.PotionAction;
b.Id=a;c.PotionActions.push(b)};a.mine=function(a,b){var d=new Komodo.ClientActions.MiningAction;d.X=a;d.Y=b;c.MiningActions.push(d)};a.sellItem=function(a,b){var d=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.SellAction;f.Id=a;f.Quantity=b;console.log(b);d.Sell=f;c.InventoryActions.push(d)};a.configureItem=function(a,b){var d=new Komodo.ClientActions.InventoryAction,f=new Komodo.ClientActions.InventoryAction.ConfigAction;f.Id=a;f.Enabled=b;d.Config=f;c.InventoryActions.push(d)};
a.purchaseItem=function(a,b){var d=new Komodo.ClientActions.StoreAction,f=new Komodo.ClientActions.StoreAction.PurchaseAction;f.Id=a;f.Quantity=b?b:1;d.Purchase=f;c.StoreActions.push(d)};a.sellAllItems=function(){var a=new Komodo.ClientActions.InventoryAction;a.SellAll=!0;c.InventoryActions.push(a)};a.craftRecipe=function(a,b){var d=new Komodo.ClientActions.CraftingAction;d.Id=a;d.Quantity=b;c.CraftingActions.push(d)};a.processRecipe=function(a,b,d){var f=new Komodo.ClientActions.ProcessingAction;
f.Id=a;f.RecipeIndex=b;f.Iterations=d;c.ProcessingActions.push(f)};a.sendGlobalMessage=function(a){var b=new Komodo.ClientActions.SocialAction,d=new Komodo.ClientActions.SocialAction.ChatAction;d.GlobalMessage=a;b.Chat=d;c.SocialActions.push(b)};a.send=k})(Connection||(Connection={}));
